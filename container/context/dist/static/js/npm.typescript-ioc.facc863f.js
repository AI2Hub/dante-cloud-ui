(window.webpackJsonp=window.webpackJsonp||[]).push([["npm.typescript-ioc"],{3381:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n("54e7"),a=n("c1af"),r=n("dc1d"),o=n("a74b");class c{constructor(e,t,n){this.source=e,this.instanceFactory=t,this.valueFactory=n}to(e){s.InjectorHandler.checkType(e);const t=s.InjectorHandler.getConstructorFromType(e);return this.targetSource=t,this.source===t?this.factory(t=>{const n=this.getParameters(t),s=this.decoratedConstructor||e;return n?new s(...n):new s}):this.factory(t=>this.instanceFactory(e,t)),this}factory(e){return this.iocFactory=t=>{const n=s.InjectorHandler.unblockInstantiation(),a=this.decoratedConstructor||this.targetSource||this.source;s.InjectorHandler.injectContext(a,t);const r=e(t);return s.InjectorHandler.removeContext(a),s.InjectorHandler.injectContext(r,t),s.InjectorHandler.blockInstantiation(n),r},this.iocScope&&this.iocScope.reset(this.source),this}scope(e){return this.iocScope&&this.iocScope!==e&&this.iocScope.finish(this.source),this.iocScope=e,this.iocScope&&this.iocScope.init(this.source),this}withParams(...e){return this.paramTypes=e,this}instrumentConstructor(){const e=s.InjectorHandler.instrumentConstructor(this.source);return this.decoratedConstructor=e,this.source.constructor=e,this}getInstance(e){return this.iocScope||this.scope(a.Scope.Local),this.iocScope.resolve(this.iocFactory,this.source,e)}clone(){const e=new c(this.source,this.instanceFactory,this.valueFactory);return e.iocFactory=this.iocFactory,e.iocScope=this.iocScope,e.targetSource=this.targetSource,e.paramTypes=this.paramTypes,e.decoratedConstructor=this.decoratedConstructor,e}getParameters(e){return this.paramTypes?this.paramTypes.map(t=>"string"==typeof t||t instanceof String?this.valueFactory(t):this.instanceFactory(t,e)):null}}t.IoCBindConfig=c;class i{constructor(e){this.name=e}to(e){return this.path?(this.value=this.value||{},o(this.value,this.path,e)):this.value=e,this}getValue(){return this.path?r(this.value,this.path):this.value}clone(){const e=new i(this.name);return e.path=this.path,e.value=this.value,e}}t.IoCBindValueConfig=i;class u{constructor(e,t){this.name=e,this.path=t}static parse(e){const t=e.indexOf(".");if(t<0)return new u(e);if(0===t)throw new TypeError(`Invalid value [${e}] passed to Container.bindName`);return t+1<e.length?new u(e.substring(0,t),e.substring(t+1)):new u(e.substring(0,t))}}t.PropertyPath=u},"401c":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n("54e7"),a=n("3381"),r=n("9ce0");class o{static bind(e,t=!1){s.InjectorHandler.checkType(e);const n=s.InjectorHandler.getConstructorFromType(e);let r=o.namespaces.get(n);return r?t||r.namespace===o.namespaces.selectedNamespace()||(r=r.clone(),o.namespaces.set(n,r)):(r=new a.IoCBindConfig(n,o.get,o.getValue),r.to(e),o.namespaces.set(n,r)),r}static bindName(e,t=!1){s.InjectorHandler.checkName(e);const n=a.PropertyPath.parse(e);let r=o.namespaces.getValue(n.name);return r?t||r.namespace===o.namespaces.selectedNamespace()||(r=r.clone(),o.namespaces.setValue(n.name,r)):(r=new a.IoCBindValueConfig(n.name),o.namespaces.setValue(n.name,r)),r.path=n.path,r}static get(e,t){const n=o.bind(e,!0);return n.iocFactory||n.to(n.source),n.getInstance(t)}static getValue(e){return o.bindName(e,!0).getValue()}static getType(e){s.InjectorHandler.checkType(e);const t=s.InjectorHandler.getConstructorFromType(e),n=o.namespaces.get(t);if(!n)throw new TypeError(`The type ${e.name} hasn't been registered with the IOC Container`);return n.targetSource||n.source}static namespace(e){return o.namespaces.selectNamespace(e),{remove:()=>{e&&o.namespaces.removeNamespace(e)}}}static selectedNamespace(){return o.namespaces.selectedNamespace()}static injectProperty(e,t,n){s.InjectorHandler.injectProperty(e,t,n,o.get)}static injectValueProperty(e,t,n){s.InjectorHandler.injectValueProperty(e,t,n,o.getValue)}static snapshot(){const e="_snapshot-"+o.snapshotsCount++,t=o.namespace(e);return{restore:()=>t.remove(),select:()=>o.namespace(e)}}}t.IoCContainer=o,o.namespaces=new r.ContainerNamespaces,o.snapshotsCount=0},"54e7":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class s{static instrumentConstructor(e){let t;return t=class extends e{constructor(...e){super(...e),s.assertInstantiable()}},t.__parent=e,t}static blockInstantiation(e){s.instantiationsBlocked=e}static unblockInstantiation(){const e=s.instantiationsBlocked;return s.instantiationsBlocked=!1,e}static getConstructorFromType(e){let t=e;if(this.hasNamedConstructor(t))return t;for(t=t.__parent;t;){if(this.hasNamedConstructor(t))return t;t=t.__parent}throw TypeError("Can not identify the base Type for requested target "+e.toString())}static checkType(e){if(!e)throw new TypeError("Invalid type requested to IoC container. Type is not defined.")}static checkName(e){if(!e)throw new TypeError("Invalid name requested to IoC container. Name is not defined.")}static injectContext(e,t){e.__BuildContext=t}static removeContext(e){delete e.__BuildContext}static injectProperty(e,t,n,s){const a="__"+t;Object.defineProperty(e.prototype,t,{enumerable:!0,get:function(){const t=this.__BuildContext||e.__BuildContext;return this[a]?this[a]:this[a]=s(n,t)},set:function(e){this[a]=e}})}static injectValueProperty(e,t,n,s){const a="__"+t;Object.defineProperty(e.prototype,t,{enumerable:!0,get:function(){return this[a]?this[a]:this[a]=s(n)},set:function(e){this[a]=e}})}static hasNamedConstructor(e){if(e.name)return"ioc_wrapper"!==e.name;try{const t=e.prototype.constructor.toString().match(this.constructorNameRegEx)[1];return t&&"ioc_wrapper"!==t}catch(e){}return!1}static assertInstantiable(){if(s.instantiationsBlocked)throw new TypeError("Can not instantiate it. The instantiation is blocked for this class. Ask Container for it, using Container.get")}}t.InjectorHandler=s,s.constructorNameRegEx=/function (\w*)/,s.instantiationsBlocked=!0},"9ce0":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ContainerNamespaces=class{constructor(){this.defaultNamespace=new s(null),this.namespaces=new Map}get(e){let t;return this.currentNamespace&&(t=this.currentNamespace.get(e),t)?t:this.defaultNamespace.get(e)}set(e,t){(this.currentNamespace||this.defaultNamespace).set(e,t)}getValue(e){let t;return this.currentNamespace&&(t=this.currentNamespace.getValue(e),t)?t:this.defaultNamespace.getValue(e)}setValue(e,t){(this.currentNamespace||this.defaultNamespace).setValue(e,t)}selectNamespace(e){if(e){let t=this.namespaces.get(e);t||(t=new s(e),this.namespaces.set(e,t)),this.currentNamespace=t}else this.currentNamespace=null}removeNamespace(e){const t=this.namespaces.get(e);t&&(this.currentNamespace&&t.name===this.currentNamespace.name&&(this.currentNamespace=null),t.clear(),this.namespaces.delete(e))}selectedNamespace(){return this.currentNamespace?this.currentNamespace.name:null}};class s{constructor(e){this.bindings=new Map,this.values=new Map,this.name=e}get(e){return this.bindings.get(e)}set(e,t){t.namespace=this.name,this.bindings.set(e,t)}getValue(e){return this.values.get(e)}setValue(e,t){t.namespace=this.name,this.values.set(e,t)}clear(){this.bindings.clear(),this.values.clear()}}},a34f:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n("54e7"),a=n("c1af");class r extends a.Scope{resolve(e,t,n){return e(n)}}t.LocalScope=r;class o extends a.Scope{resolve(e,t,n){let s=o.instances.get(t);return s||(s=e(n),o.instances.set(t,s)),s}reset(e){o.instances.delete(s.InjectorHandler.getConstructorFromType(e))}init(e){this.reset(e)}finish(e){this.reset(e)}}t.SingletonScope=o,o.instances=new Map;class c extends a.Scope{resolve(e,t,n){return this.ensureContext(n),n.build(t,e)}ensureContext(e){if(!e)throw new TypeError("IoC Container can not handle this request. When using @InRequestScope in any dependent type, you should be askking to Container to create the instances through Container.get and not calling the type constructor directly.")}}t.RequestScope=c},c1af:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Scope=class{reset(e){}init(e){}finish(e){}};t.BuildContext=class{}},e719:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n("3517");const s=n("c1af");t.Scope=s.Scope,t.BuildContext=s.BuildContext;const a=n("401c"),r=n("a34f");var o=n("f7b8");t.Inject=o.Inject,t.Factory=o.Factory,t.Singleton=o.Singleton,t.Scoped=o.Scoped,t.OnlyInstantiableByContainer=o.OnlyInstantiableByContainer,t.InRequestScope=o.InRequestScope,t.InjectValue=o.InjectValue,s.Scope.Local=new r.LocalScope,s.Scope.Singleton=new r.SingletonScope,s.Scope.Request=new r.RequestScope;class c{static bind(e){return a.IoCContainer.bind(e)}static get(e){return a.IoCContainer.get(e,new i)}static getType(e){return a.IoCContainer.getType(e)}static bindName(e){return a.IoCContainer.bindName(e)}static getValue(e){return a.IoCContainer.getValue(e)}static namespace(e){return a.IoCContainer.namespace(e)}static environment(e){return c.namespace(e)}static snapshot(e){return a.IoCContainer.snapshot()}static configure(...e){e.forEach(e=>{e.bind?c.configureType(e):e.bindName?c.configureConstant(e):(e.env||e.namespace)&&c.configureNamespace(e)})}static configureNamespace(e){const t=a.IoCContainer.selectedNamespace(),n=e.env||e.namespace;Object.keys(n).forEach(e=>{c.namespace(e);const t=n[e];c.configure(...t)}),c.namespace(t)}static configureConstant(e){const t=a.IoCContainer.bindName(e.bindName);t&&e.to&&t.to(e.to)}static configureType(e){const t=a.IoCContainer.bind(e.bind);t&&(e.to?t.to(e.to):e.factory&&t.factory(e.factory),e.scope&&t.scope(e.scope),e.withParams&&t.withParams(e.withParams))}}t.Container=c;class i extends s.BuildContext{constructor(){super(...arguments),this.context=new Map}build(e,t){let n=this.context.get(e);return n||(n=t(this),this.context.set(e,n)),n}resolve(e){return a.IoCContainer.get(e,this)}}},f7b8:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n("3517");const s=n("401c"),a=n("c1af");function r(e,t){let n=Reflect.getMetadata("design:type",e,t);n||(n=Reflect.getMetadata("design:type",e.constructor,t)),s.IoCContainer.injectProperty(e.constructor,t,n)}function o(e,t,n){if(!t){const t=s.IoCContainer.bind(e);t.paramTypes=t.paramTypes||[];const a=Reflect.getMetadata("design:paramtypes",e);t.paramTypes.unshift(a[n])}}function c(e,t,n){s.IoCContainer.injectValueProperty(e.constructor,t,n)}function i(e,t,n,a){if(!t){const t=s.IoCContainer.bind(e);t.paramTypes=t.paramTypes||[],t.paramTypes.unshift(a)}}t.InRequestScope=function(e){s.IoCContainer.bind(e).scope(a.Scope.Request)},t.Singleton=function(e){s.IoCContainer.bind(e).scope(a.Scope.Singleton)},t.OnlyInstantiableByContainer=function(e){return s.IoCContainer.bind(e).instrumentConstructor().decoratedConstructor},t.Scoped=function(e){return t=>{s.IoCContainer.bind(t).scope(e)}},t.Factory=function(e){return t=>{s.IoCContainer.bind(t).factory(e)}},t.Inject=function(...e){if(2===e.length||3===e.length&&void 0===e[2])return r.apply(this,e);if(3===e.length&&"number"==typeof e[2])return o.apply(this,e);throw new TypeError("Invalid @Inject Decorator declaration.")},t.InjectValue=function(e){return(...t)=>{if(2===t.length||3===t.length&&void 0===t[2]){const n=[...t,e].filter(e=>!!e);return c.apply(this,n)}if(3===t.length&&"number"==typeof t[2])return i.apply(this,[...t,e]);throw new TypeError("Invalid @InjectValue Decorator declaration.")}}}}]);