(window.webpackJsonp=window.webpackJsonp||[]).push([["npm.bpmn-js-token-simulation"],{e72f:function(t,e,n){"use strict";var i=n("63fd");function o(t,e){const n=new i.default([32,36]),o={},r={},c=[],a=new s,l=[],p=new Set;function h(t,e){if(l.push([e,t]),1!==l.length)return;let n;for(;n=l[0];){const[t,e]=n;e.destroyed||t(),l.shift()}b("tick")}function u(t){return r[t.type]||a}function m(t,e=null,i=null){g("createScope",{element:t,scope:e});const o={id:n.next(),element:t,children:[],interrupted:!1,destroyed:!1,initiator:i,parent:e,getTokens(){return this.children.filter(t=>!t.destroyed).length},getTokensByElement(t){return this.children.filter(e=>!e.destroyed&&e.element===t).length}};return e&&e.children.push(o),c.push(o),b("createScope",{scope:o}),_(t),e&&_(e.element),o}function d(t){if("function"==typeof t)return t;const{element:e,waitsOnElement:n,parent:i,destroyed:o=!1}=t;return t=>!(e&&t.element!==e||i&&t.parent!==i||n&&!(t.getTokensByElement(n)>0)||o!==!!t.destroyed)}S("tick",(function(){for(const t of p)b("elementChanged",{element:t});p.clear()}));const f=Object.freeze({element:null,scope:null,reason:"cancel"});function v(t,e=f){if(!t.destroyed){["element","scope","reason"].forEach(t=>{if(!(t in e))throw new Error(`no <context.${t}> provided`)});for(const n of t.children)n.destroyed||v(n,{...e,reason:"cancel"});g("destroyScope",{element:t.element,scope:t}),t.destroyContext=e,t.destroyed=!0,_(t.element),t.parent&&_(t.parent.element),b("destroyScope",{scope:t})}}function g(t,e){b("trace",{...e,action:t})}function _(t){p.add(t),l.length||b("tick")}function y(t){b("scopeChanged",{scope:t})}function b(t,n={}){return e.fire("tokenSimulation.simulator."+t,n)}function S(t,n){e.on("tokenSimulation.simulator."+t,n)}function w(t,e){const n=x(t);o[t.id||t]={...n,...e},_(t)}function x(t){return o[t.id||t]||{}}this.waitAtElement=function(t,e=!0){w(t,{wait:e})},this.createScope=m,this.destroyScope=v,this.findScope=function(t){return c.find(d(t))},this.findScopes=function(t){return c.filter(d(t))},this.setConfig=w,this.getConfig=x,this.signal=function(t){const{element:e,parentScope:n,initiator:i}=t,o=t.scope||m(e,n,i&&i.element);return h(o,(function(){g("signal",{...t,scope:o}),u(e).signal({...t,scope:o}),o.parent&&y(o.parent)})),o},this.enter=function(t){const{element:e,scope:n}=t,i=m(e,n,e);return h(i,(function(){g("enter",t),u(e).enter({...t,scope:i}),y(n)})),i},this.exit=function(t){const{element:e,scope:n,initiator:i={element:e,scope:n}}=t;h(n,(function(){g("exit",t),u(e).exit(t),v(n,{...i,reason:"complete"}),n.parent&&y(n.parent)}))},this.reset=function(){for(const t of c)v(t);c.length=0,b("tick"),b("reset")},this.on=S,this.off=function(t,n){e.off("tokenSimulation.simulator."+t,n)},this.registerBehavior=function(t,e){r[t]=e}}function s(){this.signal=function(t){console.log("ignored #exit",t.element)},this.exit=function(t){console.log("ignored #exit",t.element)},this.enter=function(t){console.log("ignored #enter",t.element)}}function r(t,e,n){this._simulator=t,this._activityBehavior=e,this._scopeBehavior=n,t.registerBehavior("bpmn:StartEvent",this)}o.$inject=["injector","eventBus"],r.prototype.signal=function(t){const{parentScope:e}=t;if(!e)throw new Error("missing <parentScope>");this._scopeBehavior.enter(t),this._simulator.exit(t)},r.prototype.exit=function(t){this._activityBehavior.exit(t)},r.$inject=["simulator","activityBehavior","scopeBehavior"];var c=n("979a");function a(t){return t.filter(t=>Object(c.is)(t,"bpmn:SequenceFlow"))}function l(t){return Object(c.is)(t,"bpmn:MessageFlow")}function p(t){return Object(c.is)(t,"bpmn:SequenceFlow")}function h(t,e,n){this._simulator=t,this._eventBehaviors=e,this._scopeBehavior=n,t.registerBehavior("bpmn:EndEvent",this)}function u(t,e,n){this._simulator=t,this._activityBehavior=e,this._scopeBehavior=n,t.registerBehavior("bpmn:BoundaryEvent",this)}function m(t,e){this._activityBehavior=e,this._simulator=t,t.registerBehavior("bpmn:IntermediateCatchEvent",this),t.registerBehavior("bpmn:ReceiveTask",this)}function d(t,e,n){this._simulator=t,this._activityBehavior=e,this._eventBehaviors=n,t.registerBehavior("bpmn:IntermediateThrowEvent",this)}function f(t){this._simulator=t,t.registerBehavior("bpmn:ExclusiveGateway",this)}function v(t,e){this._simulator=t,this._activityBehavior=e,t.registerBehavior("bpmn:ParallelGateway",this)}function g(t){this._simulator=t,t.registerBehavior("bpmn:EventBasedGateway",this)}function _(t,e){this._simulator=t,this._scopeBehavior=e;const n=["bpmn:BusinessRuleTask","bpmn:CallActivity","bpmn:ManualTask","bpmn:ScriptTask","bpmn:SendTask","bpmn:ServiceTask","bpmn:Task","bpmn:UserTask"];for(const e of n)t.registerBehavior(e,this)}function y(t){return t&&t[t.length-1]}function b(t,e,n){this._simulator=t,this._activityBehavior=e,this._scopeBehavior=n,t.registerBehavior("bpmn:SubProcess",this),t.registerBehavior("bpmn:Transaction",this),t.registerBehavior("bpmn:AdHocSubProcess",this)}function S(t){return t.children.find(t=>Object(c.is)(t,"bpmn:StartEvent"))}function w(t,e){this._simulator=t,this._scopeBehavior=e,t.registerBehavior("bpmn:SequenceFlow",this)}function x(t){this._simulator=t,t.registerBehavior("bpmn:MessageFlow",this)}h.prototype.enter=function(t){const{element:e}=t,n=this._eventBehaviors.get(e);n&&n(t);for(const t of e.outgoing)l(t)&&this._simulator.signal({element:t});this._simulator.exit(t)},h.prototype.exit=function(t){const{element:e,scope:n}=t,i={element:e,scope:n},{parent:o}=n;(function(t){return(Object(c.getBusinessObject)(t).eventDefinitions||[]).find(t=>Object(c.is)(t,"bpmn:TerminateEventDefinition"))})(e)&&this._scopeBehavior.terminate(o,i),this._scopeBehavior.tryExit(o,i)},h.$inject=["simulator","eventBehaviors","scopeBehavior"],u.prototype.signal=function(t){const{element:e,scope:n}=t,i=e.host;if(Object(c.getBusinessObject)(e).cancelActivity){const t=this._simulator.findScope({parent:n.parent,element:i});if(!t)throw new Error("cancel scope not found");const o={element:e,scope:n};this._scopeBehavior.interrupt(t,o),this._scopeBehavior.tryExit(t,o)}this._simulator.exit(t)},u.prototype.exit=function(t){this._activityBehavior.exit(t)},u.$inject=["simulator","activityBehavior","scopeBehavior"],m.prototype.signal=function(t){this._simulator.exit(t)},m.prototype.enter=function(t){const{element:e}=t;(function(t){return(Object(c.getBusinessObject)(t).eventDefinitions||[]).find(t=>Object(c.is)(t,"bpmn:LinkEventDefinition"))})(e)&&this._simulator.exit(t)},m.prototype.exit=function(t){this._activityBehavior.exit(t)},m.$inject=["simulator","activityBehavior"],d.prototype.enter=function(t){const{element:e}=t,n=this._eventBehaviors.get(e);n&&n(t),this._activityBehavior.enter(t)},d.prototype.exit=function(t){this._activityBehavior.exit(t)},d.$inject=["simulator","activityBehavior","eventBehaviors"],f.prototype.enter=function(t){this._simulator.exit(t)},f.prototype.exit=function(t){const{element:e,scope:n}=t,i=a(e.outgoing);if(1===i.length)return this._simulator.enter({element:i[0],scope:n.parent});const{activeOutgoing:o}=this._simulator.getConfig(e),s=i.find(t=>t===o);if(!s)throw new Error("no outgoing configured");return this._simulator.enter({element:s,scope:n.parent})},f.$inject=["simulator"],v.prototype.enter=function(t){const{scope:e,element:n}=t,i=a(n.incoming),{parent:o}=e,s=o.children.filter(t=>!t.destroyed&&t.element===n);if(s.length===i.length){for(const t of s)t!==e&&this._simulator.destroyScope(t,{scope:e,element:n,reason:"join"});this._simulator.exit(t)}},v.prototype.exit=function(t){this._activityBehavior.exit(t)},v.$inject=["simulator","activityBehavior"],g.prototype.enter=function(t){},g.$inject=["simulator"],_.prototype.signal=function(t){const{initiator:e,element:n}=t,i=e&&e.element;if(l(i)){const e=y(i.waypoints),o=this._getMessageContexts(n,e);if(!this._triggerMessages(t,o))return}this._simulator.exit(t)},_.prototype.enter=function(t){const{element:e}=t,n=this._waitsAtElement(e),i=this._getMessageContexts(e);if(n||i[0]&&i[0].incoming)return;this._triggerMessages(t,i)&&this._simulator.exit(t)},_.prototype.exit=function(t){const{element:e,scope:n}=t;if(n.interrupted)return;const i=n.parent;let o=!1;for(const t of e.outgoing)p(t)&&(this._simulator.enter({element:t,scope:i}),o=!0);o||this._scopeBehavior.tryExit(n.parent,{element:e,scope:n})},_.prototype._waitsAtElement=function(t){return this._simulator.getConfig(t).wait},_.prototype._getMessageContexts=function(t,e=null){const n=e?t=>t.referencePoint.x>e.x:()=>!0;return[...t.incoming.filter(l).map(t=>({incoming:t,referencePoint:y(t.waypoints)})),...t.outgoing.filter(l).map(t=>{return{outgoing:t,referencePoint:(e=t.waypoints,e&&e[0])};var e})].sort((t,e)=>t.referencePoint.x-e.referencePoint.x).filter(n)},_.prototype._triggerMessages=function(t,e){let n=0;for(;n<e.length;n++){let{outgoing:t}=e[n];if(!t)break;this._simulator.signal({element:t})}return!(n-e.length)},_.$inject=["simulator","scopeBehavior"],b.prototype.signal=function(t){const{element:e,startEvent:n=S(e),scope:i}=t;if(!n)throw new Error("missing <startEvent>");this._simulator.signal({element:n,parentScope:i})},b.prototype.enter=function(t){const{element:e}=t;this._waitsAtElement(e)||this.signal(t)},b.prototype.exit=function(t){const{scope:e,initiator:n}=t;this._activityBehavior.exit(t);const{parent:i}=e;this._scopeBehavior.tryExit(i,{...n,scope:e})},b.prototype._waitsAtElement=function(t){return this._simulator.getConfig(t).wait},b.$inject=["simulator","activityBehavior","scopeBehavior"],w.prototype.enter=function(t){this._simulator.exit(t)},w.prototype.exit=function(t){const{element:e,scope:n}=t;this._simulator.enter({element:e.target,scope:n.parent})},w.$inject=["simulator","scopeBehavior"],x.prototype.signal=function(t){this._simulator.exit(t)},x.prototype.exit=function(t){const{element:e,scope:n}=t,i=e.target;if(Object(c.is)(i,"bpmn:Participant"))return;const o=i.incoming.find(t=>Object(c.is)(t.source,"bpmn:EventBasedGateway")),s=this._simulator.findScope({element:o&&o.source||i});if(s)this._simulator.signal({element:i,scope:s,initiator:{element:e,scope:n}});else if(Object(c.is)(i,"bpmn:StartEvent"))this._simulator.signal({startEvent:i,element:i.parent,initiator:{element:e,scope:n}});else{this._simulator.findScope({element:i.parent})}},x.$inject=["simulator"];var C=Object.prototype.toString,E=Object.prototype.hasOwnProperty;function B(t){return void 0===t}function j(t){return"[object Array]"===C.call(t)}function k(t){var e=C.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e||"[object GeneratorFunction]"===e||"[object AsyncGeneratorFunction]"===e||"[object Proxy]"===e}function O(t,e){return E.call(t,e)}function F(t,e){var n;return e=P(e),$(t,(function(t,i){if(e(t,i))return n=t,!1})),n}function $(t,e){var n;if(!B(t)){var i=j(t)?L:T;for(var o in t)if(O(t,o)&&!1===e(n=t[o],i(o)))return n}}function P(t){return k(t)?t:function(e){return e===t}}function T(t){return t}function L(t){return Number(t)}function M(t,e){return"label"!==t.type&&(Array.isArray(e)||(e=[e]),e.some((function(e){return Object(c.is)(t,e)})))}function A(t,e){return F(Object(c.getBusinessObject)(t).eventDefinitions,t=>M(t,e))}function I(t,e){return!!F(Object(c.getBusinessObject)(t).eventDefinitions,t=>M(t,e))}function R(t,e){this._simulator=t,this._elementRegistry=e}function z(t){this._simulator=t}function H(t,e){this._simulator=t,this._scopeBehavior=e,t.registerBehavior("bpmn:Process",this),t.registerBehavior("bpmn:Participant",this)}function q(t){return t.children.find(t=>Object(c.is)(t,"bpmn:StartEvent"))}R.prototype.get=function(t){const e={"bpmn:LinkEventDefinition":t=>{const{element:e,scope:n}=t,{parent:i}=n,o=A(e,"bpmn:LinkEventDefinition").get("name"),s=this._elementRegistry.filter(t=>t.parent===e.parent&&M(t,"bpmn:CatchEvent")&&I(t,"bpmn:LinkEventDefinition")&&A(t,"bpmn:LinkEventDefinition").get("name")===o);for(const t of s)this._simulator.enter({element:t,scope:i})},"bpmn:SignalEventDefinition":t=>{const{element:e}=t,n=A(e,"bpmn:SignalEventDefinition").get("signalRef"),i=this._elementRegistry.filter(t=>M(t,"bpmn:CatchEvent")&&I(t,"bpmn:SignalEventDefinition")&&A(t,"bpmn:SignalEventDefinition").get("signalRef")===n).map(t=>{if(M(t,"bpmn:StartEvent")){const e=t.parent,n=t;if(!M(e,"bpmn:SubProcess"))return()=>this._simulator.signal({element:t.parent,startEvent:n});if(Object(c.getBusinessObject)(e).triggeredByEvent){return this._simulator.findScopes({element:e.parent}).map(t=>()=>this._simulator.signal({element:e,startEvent:n,parentScope:t}))}}if(M(t,"bpmn:IntermediateCatchEvent")){const e=t.incoming.find(t=>M(t.source,"bpmn:EventBasedGateway"));return this._simulator.findScopes({element:e&&e.source||t}).map(e=>()=>this._simulator.signal({element:t,scope:e}))}if(M(t,"bpmn:BoundaryEvent")){return this._simulator.findScopes({element:t.host}).map(e=>()=>this._simulator.signal({element:t,parentScope:e.parent}))}return[]}).flat();for(const t of i)t&&t()},"bpmn:EscalationEventDefinition":t=>{const{element:e,scope:n}=t,i=A(e,"bpmn:EscalationEventDefinition").get("escalationRef");let o,s=n.parent;do{o=s.element.children.find(t=>M(t,"bpmn:SubProcess")&&t.children.find(t=>M(t,"bpmn:CatchEvent")&&I(t,"bpmn:EscalationEventDefinition")&&A(t,"bpmn:EscalationEventDefinition").get("escalationRef")===i))||s.element.attachers.find(t=>M(t,"bpmn:CatchEvent")&&I(t,"bpmn:EscalationEventDefinition")&&A(t,"bpmn:EscalationEventDefinition").get("escalationRef")===i)}while(!o&&(s=s.parent));o&&(M(o,"bpmn:BoundaryEvent")&&(s=s.parent),this._simulator.signal({element:o,parentScope:s}))},"bpmn:ErrorEventDefinition":t=>{const{element:e,scope:n}=t,i=A(e,"bpmn:ErrorEventDefinition").get("errorRef");let o=n.parent;const s=o.element.children.find(t=>M(t,"bpmn:SubProcess")&&t.children.find(t=>M(t,"bpmn:StartEvent")&&I(t,"bpmn:ErrorEventDefinition")&&A(t,"bpmn:ErrorEventDefinition").get("errorRef")===i))||o.element.attachers.find(t=>M(t,"bpmn:CatchEvent")&&I(t,"bpmn:ErrorEventDefinition")&&A(t,"bpmn:ErrorEventDefinition").get("errorRef")===i);s&&(M(s,"bpmn:BoundaryEvent")&&(o=o.parent),this._simulator.signal({element:s,parentScope:o}))}},n=Object.entries(e).find(e=>I(t,e[0]));return n&&n[1]},R.$inject=["simulator","elementRegistry"],z.prototype.isFinished=function(t,e=null){return t.children.every(t=>t===e||t.destroyed)},z.prototype.destroyChildren=function(t,e){for(const n of t.children)n.destroyed||this._simulator.destroyScope(n,{reason:"cancel",...e})},z.prototype.enter=function(t){const{element:e,scope:n,parentScope:i}=t,{parent:o}=e;if(function(t){return Object(c.getBusinessObject)(t).triggeredByEvent}(o)){if(!i)throw new Error("missing <parentScope>");(function(t){return Object(c.getBusinessObject)(t).isInterrupting})(e)&&(i.interrupting=!0,this.interrupt(i.parent,{element:e,scope:n}))}},z.prototype.terminate=function(t,e){t.interrupted=!0;for(const n of t.children)n.destroyed||n===e.scope||this._simulator.destroyScope(n,{reason:"cancel",...e})},z.prototype.interrupt=function(t,e){t.interrupted=!0;for(const n of t.children)n.destroyed||n.interrupting||this._simulator.destroyScope(n,{reason:"cancel",...e})},z.prototype.tryExit=function(t,e){if(!t)throw new Error("missing <scope>");if(!e)throw new Error("missing <initiator>");this.isFinished(t,e.scope)&&this.exit({scope:t,initiator:e})},z.prototype.exit=function(t){const{scope:e,initiator:n}=t;if(!n)throw new Error("missing <initiator>");this._simulator.exit({element:e.element,scope:e,initiator:n})},z.$inject=["simulator"],H.prototype.signal=function(t){const{element:e,startEvent:n=q(e),scope:i}=t;if(!n)throw new Error("missing <startEvent>");this._simulator.signal({element:n,parentScope:i})},H.prototype.exit=function(t){const{scope:e,initiator:n}=t;this._scopeBehavior.destroyChildren(e,n)},H.$inject=["simulator","scopeBehavior"];var D={__depends__:[{__init__:["startEventBehavior","endEventBehavior","boundaryEventBehavior","intermediateCatchEventBehavior","intermediateThrowEventBehavior","exclusiveGatewayBehavior","parallelGatewayBehavior","eventBasedGatewayBehavior","subProcessBehavior","sequenceFlowBehavior","messageFlowBehavior","processBehavior"],startEventBehavior:["type",r],endEventBehavior:["type",h],boundaryEventBehavior:["type",u],intermediateCatchEventBehavior:["type",m],intermediateThrowEventBehavior:["type",d],exclusiveGatewayBehavior:["type",f],parallelGatewayBehavior:["type",v],eventBasedGatewayBehavior:["type",g],activityBehavior:["type",_],subProcessBehavior:["type",b],sequenceFlowBehavior:["type",w],messageFlowBehavior:["type",x],eventBehaviors:["type",R],scopeBehavior:["type",z],processBehavior:["type",H]}],__init__:[["eventBus","simulator",function(t,e){t.on("tokenSimulation.toggleMode",5e3,t=>{t.active||e.reset()}),t.on("tokenSimulation.resetSimulation",5e3,t=>{e.reset()})}]],simulator:["type",o]},G=n("a092"),N=n.n(G);function V(t,e){t.invoke(x,this),this._animation=e}function Y(t,e){t.invoke(w,this),this._animation=e}N()(V,x),V.$inject=["injector","animation"],V.prototype.signal=function(t){const{element:e,scope:n}=t;this._animation.animate(e,n,()=>{x.prototype.signal.call(this,t)})},N()(Y,w),Y.$inject=["injector","animation"],Y.prototype.enter=function(t){const{element:e,scope:n}=t;this._animation.animate(e,n,()=>{w.prototype.enter.call(this,t)})};var U={sequenceFlowBehavior:["type",Y],messageFlowBehavior:["type",V]};const W="tokenSimulation.toggleMode",Z="tokenSimulation.resetSimulation",J="tokenSimulation.simulator.destroyScope",K="tokenSimulation.simulator.createScope",Q=t=>!0;function X(t,e){this._eventBus=t,this._simulator=e,this._filter=Q,t.on([W,Z],()=>{this._filter=Q}),t.on(J,t=>{const{scope:e}=t;this._scope===e&&e.parent&&this.toggle(e.parent)}),t.on(K,t=>{const{scope:e}=t;e.parent||!this._scope||tt(this._scope,e)||this.toggle(null)})}function tt(t,e){do{if(t===e)return!0}while(e=e.parent);return!1}X.prototype.toggle=function(t){const e=this._scope!==t;this._scope=e?t:null,this._filter=this._scope?t=>tt(this._scope,t):t=>!0,this._eventBus.fire("tokenSimulation.scopeFilterChanged",{filter:this._filter,scope:this._scope})},X.prototype.isShown=function(t){return"string"==typeof t&&(t=this._simulator.findScope(e=>e.id===t)),t&&this._filter(t)},X.prototype.findScope=function(t){return this._simulator.findScopes(t).filter(t=>this.isShown(t))[0]},X.$inject=["eventBus","simulator"];var et={scopeFilter:["type",X]},nt=n("f6d6"),it=n("bbf8");const ot=getComputedStyle(document.documentElement),st=ot.getPropertyValue("--token-simulation-green-base-44"),rt=ot.getPropertyValue("--token-simulation-white");function ct(){}function at(t,e){return 2===e.length?ut:1===t?pt:t===e.length-1?ht:lt}const lt=function(t){return t},pt=function(t){return 1-Math.cos(t*Math.PI/2)},ht=function(t){return Math.sin(t*Math.PI/2)},ut=function(t){return-Math.cos(t*Math.PI)/2+.5};function mt(t,e,n){this._eventBus=e,this._scopeFilter=n,this._animations=new Set,this._speed=1,e.on("import.done",()=>{const e=Object(nt.query)(".viewport",t._svg);this.group=Object(it.b)(Object(it.g)('<g class="animation-tokens" />'),e)}),e.on(Z,()=>{this.clearAnimations()}),e.on("tokenSimulation.pauseSimulation",()=>{this.pause()}),e.on("tokenSimulation.playSimulation",()=>{this.play()}),e.on("tokenSimulation.scopeFilterChanged",t=>{this.each(t=>{this._scopeFilter.isShown(t.scope)?t.show():t.hide()})}),e.on(J,t=>{const{scope:e}=t;this.clearAnimations(e)})}function dt(t,e,n){this.gfx=t,this.waypoints=e,this.done=n,this._paused=!0,this._t=0,this._parts=[],this.create()}mt.prototype.animate=function(t,e,n){this.createAnimation(t,e,n)},mt.prototype.pause=function(){this.each(t=>t.pause())},mt.prototype.play=function(){this.each(t=>t.play())},mt.prototype.each=function(t){this._animations.forEach(t)},mt.prototype.createAnimation=function(t,e,n=ct){if(!this.group)return;const i=new dt(this._createTokenGfx(e),t.waypoints,()=>{this._animations.delete(i),n()});return i.setSpeed(this.getAnimationSpeed()),this._scopeFilter.isShown(e)||i.hide(),i.scope=e,i.element=t,this._animations.add(i),this._eventBus.fire("tokenSimulation.animationCreated",{animation:i}),i.play(),i},mt.prototype.setAnimationSpeed=function(t){this._speed=t,this.each(e=>e.setSpeed(t)),this._eventBus.fire("tokenSimulation.animationSpeedChanged",{speed:t})},mt.prototype.getAnimationSpeed=function(){return this._speed},mt.prototype.clearAnimations=function(t){this.each(e=>{t&&e.scope!==t||e.remove()})},mt.prototype._createTokenGfx=function(t){const e=Object(it.g)(this._getTokenSVG(t).trim());return Object(it.b)(e,this.group)},mt.prototype._getTokenSVG=function(t){const e=t.colors||{primary:st,auxiliary:rt};return`\n    <g class="token">\n      <circle\n        class="circle"\n        r="10"\n        cx="10"\n        cy="10"\n        fill="${e.primary}"\n      />\n      <text\n        class="text"\n        transform="translate(10, 14)"\n        text-anchor="middle"\n        fill="${e.auxiliary}"\n      >1</text>\n    </g>\n  `},mt.$inject=["canvas","eventBus","scopeFilter"],dt.prototype.pause=function(){this._paused=!0},dt.prototype.play=function(){this._paused&&(this._paused=!1,this.tick(0)),this.schedule()},dt.prototype.schedule=function(){if(this._paused)return;if(this._scheduled)return;const t=Date.now();this._scheduled=!0,requestAnimationFrame(()=>{this._scheduled=!1,this._paused||(this.tick((Date.now()-t)*this._speed),this.schedule())})},dt.prototype.tick=function(t){const e=this._t=this._t+t,n=this._parts.find(t=>t.startTime<=e&&t.endTime>e);if(!n)return this.remove();const i=e-n.startTime,o=n.length*n.easing(i/n.duration),s=n.startLength+o,r=this._path.getPointAtLength(s);this.move(r.x,r.y)},dt.prototype.move=function(t,e){Object(it.c)(this.gfx,"transform",`translate(${t}, ${e})`)},dt.prototype.create=function(){const t=this.waypoints,e=t.reduce((e,n,i)=>{const o=t[i-1];if(o){const c=e[e.length-1],a=c&&c.endLength||0,l=(s=o,r=n,Math.sqrt(Math.pow(s.x-r.x,2)+Math.pow(s.y-r.y,2)));e.push({startLength:a,endLength:a+l,length:l,easing:at(i,t)})}var s,r;return e},[]),n=e.reduce((function(t,e){return t+e.length}),0),i=t.reduce((t,e,n)=>{const i=e.x-10,o=e.y-10;return t.push([n>0?"L":"M",i,o]),t},[]).flat().join(" "),o=(s=n,Math.log(s)*(c=300,(r=250)+Math.floor(Math.random()*(c-r))));var s,r,c;this._parts=e.reduce((t,e,i)=>{const s=o/n*e.length,r=i>0?t[i-1].endTime:0,c=r+s;return[...t,{...e,startTime:r,endTime:c,duration:s}]},[]),this._path=Object(it.g)(`<path d="${i}" />`),this._t=0},dt.prototype.show=function(){Object(it.c)(this.gfx,"display","")},dt.prototype.hide=function(){Object(it.c)(this.gfx,"display","none")},dt.prototype.remove=function(){this.pause(),Object(it.k)(this.gfx),this.done()},dt.prototype.setSpeed=function(t){this._speed=t};var ft={__depends__:[D,U,et],animation:["type",mt]},vt=n("2f5d"),gt=n.n(vt);function _t(t){const e=gt()({count:60}).filter(t=>n(t.substring(1))<200);function n(t){return(299*parseInt(t.substr(0,2),16)+587*parseInt(t.substr(2,2),16)+114*parseInt(t.substr(4,2),16))/1e3}let i=0;t.on(K,1500,t=>{const{scope:o}=t;o.colors=function(t){const{element:o}=t;if(o&&"bpmn:MessageFlow"===o.type)return{primary:"#999",auxiliary:"#FFF"};if(t.parent)return t.parent.colors;const s=e[i++%e.length];return{primary:s,auxiliary:n(s)>=128?"#111":"#fff"}}(o)})}_t.$inject=["eventBus"];var yt={__init__:["coloredScopes"],coloredScopes:["type",_t]};function bt(t){return function(e=""){return`<span class="bts-icon ${e}">${t}</span>`}}const St=bt('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">\x3c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\x3e<path fill="currentColor" d="M12.83 352h262.34A12.82 12.82 0 0 0 288 339.17v-38.34A12.82 12.82 0 0 0 275.17 288H12.83A12.82 12.82 0 0 0 0 300.83v38.34A12.82 12.82 0 0 0 12.83 352zm0-256h262.34A12.82 12.82 0 0 0 288 83.17V44.83A12.82 12.82 0 0 0 275.17 32H12.83A12.82 12.82 0 0 0 0 44.83v38.34A12.82 12.82 0 0 0 12.83 96zM432 160H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0 256H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z"/></svg>'),wt=bt('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512">\x3c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\x3e<path fill="currentColor" d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"/></svg>'),xt=bt('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\x3e<path fill="currentColor" d="M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"/></svg>'),Ct=bt('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 580.5 448">\n  <path fill="currentColor" d="M112 0C85 0 64 22 64 48v196l192-89V48c0-26-22-48-48-48zm256 0c-27 0-48 22-48 48v77l190-89c-5-21-24-36-46-36Zm144 105-192 89v70l192-89zM256 224 64 314v70l192-90zm256 21-192 89v66c0 27 21 48 48 48h96c26 0 48-21 48-48zM256 364 89 442c7 4 14 6 23 6h96c26 0 48-21 48-48z"/>\n  <rect fill="currentColor" width="63.3" height="618.2" x="311.5" y="-469.4" transform="rotate(65)" rx="10"/>\n</svg>\n'),Et=bt('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512">\x3c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\x3e<path fill="currentColor" d="M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z"/></svg>'),Bt=bt('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">\x3c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\x3e<path fill="currentColor" d="M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/></svg>'),jt=bt('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 192 512">\x3c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\x3e<path fill="currentColor" d="M20 424.229h20V279.771H20c-11.046 0-20-8.954-20-20V212c0-11.046 8.954-20 20-20h112c11.046 0 20 8.954 20 20v212.229h20c11.046 0 20 8.954 20 20V492c0 11.046-8.954 20-20 20H20c-11.046 0-20-8.954-20-20v-47.771c0-11.046 8.954-20 20-20zM96 0C56.235 0 24 32.235 24 72s32.235 72 72 72 72-32.235 72-72S135.764 0 96 0z"/></svg>'),kt=bt('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">\x3c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\x3e<path fill="currentColor" d="M144 479H48c-26.5 0-48-21.5-48-48V79c0-26.5 21.5-48 48-48h96c26.5 0 48 21.5 48 48v352c0 26.5-21.5 48-48 48zm304-48V79c0-26.5-21.5-48-48-48h-96c-26.5 0-48 21.5-48 48v352c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48z"/></svg>'),Ot=bt('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">\x3c!-- Adapted from Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\x3e<path fill="currentColor" d="M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"/></svg>'),Ft=bt('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\x3e<path fill="currentColor" d="M440.65 12.57l4 82.77A247.16 247.16 0 0 0 255.83 8C134.73 8 33.91 94.92 12.29 209.82A12 12 0 0 0 24.09 224h49.05a12 12 0 0 0 11.67-9.26 175.91 175.91 0 0 1 317-56.94l-101.46-4.86a12 12 0 0 0-12.57 12v47.41a12 12 0 0 0 12 12H500a12 12 0 0 0 12-12V12a12 12 0 0 0-12-12h-47.37a12 12 0 0 0-11.98 12.57zM255.83 432a175.61 175.61 0 0 1-146-77.8l101.8 4.87a12 12 0 0 0 12.57-12v-47.4a12 12 0 0 0-12-12H12a12 12 0 0 0-12 12V500a12 12 0 0 0 12 12h47.35a12 12 0 0 0 12-12.6l-4.15-82.57A247.17 247.17 0 0 0 255.83 504c121.11 0 221.93-86.92 243.55-201.82a12 12 0 0 0-11.8-14.18h-49.05a12 12 0 0 0-11.67 9.26A175.86 175.86 0 0 1 255.83 432z"/></svg>'),$t=bt('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">\x3c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\x3e<path fill="currentColor" d="M288 32C128.94 32 0 160.94 0 320c0 52.8 14.25 102.26 39.06 144.8 5.61 9.62 16.3 15.2 27.44 15.2h443c11.14 0 21.83-5.58 27.44-15.2C561.75 422.26 576 372.8 576 320c0-159.06-128.94-288-288-288zm0 64c14.71 0 26.58 10.13 30.32 23.65-1.11 2.26-2.64 4.23-3.45 6.67l-9.22 27.67c-5.13 3.49-10.97 6.01-17.64 6.01-17.67 0-32-14.33-32-32S270.33 96 288 96zM96 384c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm48-160c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm246.77-72.41l-61.33 184C343.13 347.33 352 364.54 352 384c0 11.72-3.38 22.55-8.88 32H232.88c-5.5-9.45-8.88-20.28-8.88-32 0-33.94 26.5-61.43 59.9-63.59l61.34-184.01c4.17-12.56 17.73-19.45 30.36-15.17 12.57 4.19 19.35 17.79 15.17 30.36zm14.66 57.2l15.52-46.55c3.47-1.29 7.13-2.23 11.05-2.23 17.67 0 32 14.33 32 32s-14.33 32-32 32c-11.38-.01-20.89-6.28-26.57-15.22zM480 384c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32z"/></svg>'),Pt=bt('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\x3e<path fill="currentColor" d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"/></svg>'),Tt=bt('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512">\x3c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\x3e<path fill="currentColor" d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"/></svg>'),Lt=bt('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">\x3c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\x3e<path fill="currentColor" d="M384 64H192C85.961 64 0 149.961 0 256s85.961 192 192 192h192c106.039 0 192-85.961 192-192S490.039 64 384 64zM64 256c0-70.741 57.249-128 128-128 70.741 0 128 57.249 128 128 0 70.741-57.249 128-128 128-70.741 0-128-57.249-128-128zm320 128h-48.905c65.217-72.858 65.236-183.12 0-256H384c70.741 0 128 57.249 128 128 0 70.74-57.249 128-128 128z"/></svg>'),Mt=bt('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">\x3c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\x3e<path fill="currentColor" d="M384 64H192C86 64 0 150 0 256s86 192 192 192h192c106 0 192-86 192-192S490 64 384 64zm0 320c-70.8 0-128-57.3-128-128 0-70.8 57.3-128 128-128 70.8 0 128 57.3 128 128 0 70.8-57.3 128-128 128z"/></svg>');function At(t){this._simulator=t}function It(t){this._exclusiveGatewaySettings=t}function Rt(t){this._simulator=t}function zt(t){this._simulator=t}function Ht(t){this._simulator=t}function qt(t){return Object(c.getBusinessObject)(t).triggeredByEvent}function Dt(t){return M(t,"bpmn:StartEvent")}function Gt(t){this._simulator=t}At.prototype.createContextPads=function(t){return t.attachers.map(t=>this.createBoundaryContextPad(t))},At.prototype.createBoundaryContextPad=function(t){const e=`\n    <div class="context-pad" title="Trigger Event">\n      ${Ot()}\n    </div>\n  `;return{action:e=>this._simulator.signal({element:t,parentScope:e[0].parent}),element:t,html:e,scopes:()=>this._findScopes({element:t.host})}},At.prototype._findScopes=function(t){return this._simulator.findScopes(t)},At.$inject=["simulator"],It.prototype.createContextPads=function(t){if(t.outgoing.filter((function(t){return M(t,"bpmn:SequenceFlow")})).length<2)return;const e=`\n    <div class="context-pad" title="Set Sequence Flow">\n      ${Et()}\n    </div>\n  `;return[{action:()=>{this._exclusiveGatewaySettings.setSequenceFlow(t)},element:t,html:e}]},It.$inject=["exclusiveGatewaySettings"],Rt.prototype.createContextPads=function(t){return t.outgoing.filter(t=>M(t,"bpmn:SequenceFlow")).map(t=>t.target).filter(t=>M(t,"bpmn:IntermediateCatchEvent")||M(t,"bpmn:ReceiveTask")).map(t=>this.createCatchEventPad(t))},Rt.prototype.createCatchEventPad=function(t){const e=t.incoming.map(t=>t.source).find(t=>M(t,"bpmn:EventBasedGateway"));if(!e)return;const n=`\n    <div class="context-pad" title="Trigger Event">\n      ${Ot()}\n    </div>\n  `;return{action:e=>{this._simulator.signal({element:t,scope:e[0]})},element:t,html:n,scopes:()=>this._findScopes({element:e})}},Rt.prototype._findScopes=function(t){return this._simulator.findScopes(t)},Rt.$inject=["simulator"],zt.prototype.createContextPads=function(t){const e=`\n    <div class="context-pad" title="Trigger Event">\n      ${Ot()}\n    </div>\n  `;return[{action:e=>{this._simulator.signal({element:t,scope:e[0]})},element:t,html:e,scopes:()=>this._findScopes(e=>!e.destroyed&&e.element===t&&!e.children.length)}]},zt.prototype._findScopes=function(t){return this._simulator.findScopes(t)},zt.$inject=["simulator"],Ht.prototype.createContextPads=function(t){return function(t){const e=t.businessObject.triggeredByEvent?[]:t.children.filter(Dt);return t.children.filter(qt).reduce((t,e)=>{for(const n of e.children)Dt(n)&&t.push(n);return t},e)}(t).map(e=>this.createStartEventContextPad(e,t))},Ht.prototype.createStartEventContextPad=function(t,e){const n=t.parent;let i;if(M(n,"bpmn:SubProcess")){if(!qt(n))return;i=()=>this._findScopes({element:n.parent})}const o=`\n    <div class="context-pad">\n      ${Ot()}\n    </div>\n  `;return{action:e=>{const i=e&&e[0];this._simulator.signal({element:n,startEvent:t,parentScope:i})},element:t,html:o,scopes:i}},Ht.prototype._findScopes=function(t){return this._simulator.findScopes(t)},Ht.$inject=["simulator"],Gt.prototype.createContextPads=function(t){return[this.createPauseContextPad(t)]},Gt.prototype.createPauseContextPad=function(t){const e=this._isPaused(t),n=`\n    <div class="context-pad ${e?"":"show-hover"}" title="${e?"Remove":"Add"} pause point">\n      ${(e?Ct:kt)("show-hover")}\n      ${kt("hide-hover")}\n    </div>\n  `;return{action:()=>{this._togglePaused(t)},element:t,hideScopes:()=>this._findScopes({element:t}).filter(t=>!t.children.length),html:n}},Gt.prototype._isPaused=function(t){const{wait:e}=this._simulator.getConfig(t);return e},Gt.prototype._togglePaused=function(t){const e=!this._isPaused(t);this._simulator.waitAtElement(t,e)},Gt.prototype._findScopes=function(t){return this._simulator.findScopes(t)},Gt.$inject=["simulator"];function Nt(t,e,n,i,o,s){this._elementRegistry=e,this._overlays=n,this._injector=i,this._canvas=o,this._scopeFilter=s,this._overlayCache=new Map,this._handlerIdx=0,this._handlers=[],this.registerHandler("bpmn:ExclusiveGateway",It),this.registerHandler("bpmn:IntermediateCatchEvent",zt),this.registerHandler("bpmn:Activity",zt),this.registerHandler("bpmn:EventBasedGateway",Rt),this.registerHandler("bpmn:Activity",At),this.registerHandler("bpmn:Process",Ht),this.registerHandler("bpmn:SubProcess",Ht),this.registerHandler("bpmn:Participant",Ht),this.registerHandler("bpmn:Activity",Gt),t.on(W,500,t=>{t.active?this.openContextPads():this.closeContextPads()}),t.on(Z,500,()=>{this.closeContextPads(),this.openContextPads()}),t.on("tokenSimulation.scopeFilterChanged",t=>{const e=Object(nt.queryAll)(".djs-overlay-ts-context-menu [data-scope-ids]",n._overlayRoot);for(const t of e){const e=t.dataset.scopeIds.split(",").some(t=>s.isShown(t));Object(nt.classes)(t).toggle("hidden",!e)}const i=Object(nt.queryAll)(".djs-overlay-ts-context-menu [data-hide-scope-ids]",n._overlayRoot);for(const t of i){const e=t.dataset.hideScopeIds.split(",").some(t=>s.isShown(t));Object(nt.classes)(t).toggle("hidden",e)}}),t.on("tokenSimulation.simulator.elementChanged",500,t=>{const{element:e}=t;this.updateElementContextPads(e)})}Nt.prototype.registerHandler=function(t,e){const n=this._injector.instantiate(e);n.hash=String(this._handlerIdx++),this._handlers.push({handler:n,type:t})},Nt.prototype.getHandlers=function(t){return this._handlers.filter(({type:e})=>M(t,e)).map(({handler:t})=>t)},Nt.prototype.openContextPads=function(t){t||(t=this._canvas.getRootElement()),this._elementRegistry.forEach(e=>{(function(t,e){do{if(t===e)return!0;e=e.parent}while(e);return!1})(t,e)&&this.updateElementContextPads(e)})},Nt.prototype._getOverlays=function(t){return this._overlayCache.get(t)||[]},Nt.prototype._addOverlay=function(t,e){const{handlerHash:n}=e;if(!n)throw new Error("<handlerHash> required");const i=this._overlays.add(t,"ts-context-menu",{...e,position:{top:-15,left:-15},show:{minZoom:.5}}),o=this._overlays.get(i),s=this._overlayCache;s.has(n)||s.set(n,[]),s.get(n).push(o)},Nt.prototype._removeOverlay=function(t){const{id:e,handlerHash:n}=t;this._overlays.remove(e);const i=this._overlayCache.get(n)||[],o=i.indexOf(t);-1!==o&&i.splice(o,1)},Nt.prototype.updateElementContextPads=function(t){for(const e of this.getHandlers(t))this._updateElementContextPads(t,e)},Nt.prototype._updateElementContextPads=function(t,e){const n=(e.createContextPads(t)||[]).filter(t=>t),i=`${t.id}------${e.hash}`,o=this._getOverlays(i),s=[];for(const t of n){const{element:e,scopes:n,hideScopes:r,action:c,html:a}=t,l=`${t.element.id}-------${a}`;let p=o.find(t=>t.hash===l);const h=p&&p.html||Object(nt.domify)(a);if(n){const t=n();h.dataset.scopeIds=t.map(t=>t.id).join(",");const e=t.filter(t=>this._scopeFilter.isShown(t));Object(nt.classes)(h).toggle("hidden",0===e.length)}if(r){const t=r();h.dataset.hideScopeIds=t.map(t=>t.id).join(",");const e=t.filter(t=>this._scopeFilter.isShown(t));Object(nt.classes)(h).toggle("hidden",e.length>0)}p?s.push(p):(c&&nt.event.bind(h,"click",t=>{t.preventDefault();const e=n?n().filter(t=>this._scopeFilter.isShown(t)):null;c(e)}),this._addOverlay(e,{hash:l,handlerHash:i,html:h}))}for(const t of o)s.includes(t)||this._removeOverlay(t)},Nt.prototype.closeContextPads=function(){for(const t of this._overlayCache.values())for(const e of t)this._closeOverlay(e);this._overlayCache.clear()},Nt.prototype._closeOverlay=function(t){this._overlays.remove(t.id)},Nt.$inject=["eventBus","elementRegistry","overlays","injector","canvas","scopeFilter"];var Vt={__depends__:[et],__init__:["contextPads"],contextPads:["type",Nt]};function Yt(t,e,n){t.on(J,t=>{const{scope:e}=t,{destroyContext:i,element:o}=e,{element:s,reason:r}=i;if("complete"!==r)return;["bpmn:Process","bpmn:Participant"].includes(o.type)&&n.addElementNotification(s,{type:"success",icon:xt(),text:"Finished",scope:e})})}Yt.$inject=["eventBus","simulator","elementNotifications"];function Ut(t,e){this._overlays=t,e.on([Z,K,W],()=>{this.clear()})}Ut.prototype.addElementNotification=function(t,e){const n={top:-15,right:15},{type:i,icon:o,text:s,scope:r={}}=e,c=r.colors,a=c?`style="color: ${c.auxiliary}; background: ${c.primary}"`:"",l=Object(nt.domify)(`\n    <div class="element-notification ${i||""}" ${a}>\n      ${o||""}\n      <span class="text">${s}</span>\n    </div>\n  `);this._overlays.add(t,"element-notification",{position:n,html:l,show:{minZoom:.5}})},Ut.prototype.clear=function(){this._overlays.remove({type:"element-notification"})},Ut.prototype.removeElementNotification=function(t){this._overlays.remove({element:t})},Ut.$inject=["overlays","eventBus"];var Wt={elementNotifications:["type",Ut]};const Zt=2e3,Jt=jt();function Kt(t,e,n){this._eventBus=t,this._canvas=e,this._scopeFilter=n,this._init(),t.on([W,Z],t=>{this.clear()})}Kt.prototype._init=function(){this.container=Object(nt.domify)('<div class="notifications"></div>'),this._canvas.getContainer().appendChild(this.container)},Kt.prototype.showNotification=function(t){const{text:e,type:n="info",icon:i=Jt,scope:o,ttl:s=Zt}=t;if(o&&!this._scopeFilter.isShown(o))return;const r=i.startsWith("<")?i:`<i class="${i}"></i>`,c=o&&o.colors,a=c?`style="color: ${c.auxiliary}; background: ${c.primary}"`:"",l=Object(nt.domify)(`\n    <div class="notification ${n}">\n      <span class="icon">${r}</span>\n      <span class="text">${e}</span>\n      ${o?`<span class="scope" ${a}>${o.id}</span>`:""}\n    </div>\n  `);for(this.container.appendChild(l);this.container.children.length>5;)this.container.children[0].remove();setTimeout((function(){l.remove()}),s)},Kt.prototype.clear=function(){for(;this.container.children.length;)this.container.children[0].remove()},Kt.$inject=["eventBus","canvas","scopeFilter"];var Qt={__depends__:[et],notifications:["type",Kt]},Xt={__depends__:[Wt,Qt],__init__:["simulationState"],simulationState:["type",Yt]};function te(t,e,n,i,o){this._eventBus=t,this._canvas=e,this._scopeFilter=n,this._elementColors=i,this._simulationStyles=o,this._highlight=null,this._init(),t.on(W,t=>{t.active?Object(nt.classes)(this._container).remove("hidden"):(Object(nt.classes)(this._container).add("hidden"),Object(nt.clear)(this._container),this.unhighlightScope())}),t.on("tokenSimulation.scopeFilterChanged",t=>{const e=this.getScopeElements();for(const t of e){const e=t.dataset.scopeId;Object(nt.classes)(t).toggle("inactive",!this._scopeFilter.isShown(e))}}),t.on(K,t=>{this.addScope(t.scope)}),t.on(J,t=>{this.removeScope(t.scope)}),t.on("tokenSimulation.simulator.scopeChanged",t=>{this.updateScope(t.scope)}),t.on(Z,()=>{this.removeAllInstances()})}function ee(){this._cache={}}function ne(){return{getPropertyValue:()=>""}}te.prototype._init=function(){this._container=Object(nt.domify)('<div class="token-simulation-scopes hidden"></div>'),this._canvas.getContainer().appendChild(this._container)},te.prototype.addScope=function(t){const{element:e}=t;if(!["bpmn:Process","bpmn:SubProcess","bpmn:Participant"].includes(e.type))return;const n=t.colors,i=n?`style="color: ${n.auxiliary}; background: ${n.primary}"`:"",o=Object(nt.domify)(`\n    <div data-scope-id="${t.id}" class="scope"\n         title="View Process Instance ${t.id}" ${i}>\n      ${t.getTokens()}\n    </div>\n  `);nt.event.bind(o,"click",()=>{this._scopeFilter.toggle(t)}),nt.event.bind(o,"mouseenter",()=>{this.highlightScope(e)}),nt.event.bind(o,"mouseleave",()=>{this.unhighlightScope()}),this._scopeFilter.isShown(t)||Object(nt.classes)(o).add("inactive"),this._container.appendChild(o)},te.prototype.getScopeElements=function(){return Object(nt.queryAll)("[data-scope-id]",this._container)},te.prototype.getScopeElement=function(t){return Object(nt.query)(`[data-scope-id="${t.id}"]`,this._container)},te.prototype.updateScope=function(t){const e=this.getScopeElement(t);e&&(e.textContent=t.getTokens())},te.prototype.removeScope=function(t){const e=this.getScopeElement(t);e&&e.remove()},te.prototype.removeAllInstances=function(){this._container.innerHTML=""},te.prototype.highlightScope=function(t){this.unhighlightScope(),this._highlight={element:t,colors:this._elementColors.get(t)},this._elementColors.set(t,this._getHighlightColors()),t.parent||Object(nt.classes)(this._canvas.getContainer()).add("highlight")},te.prototype.unhighlightScope=function(){if(!this._highlight)return;const{element:t,colors:e}=this._highlight;this._elementColors.set(t,e),t.parent||Object(nt.classes)(this._canvas.getContainer()).remove("highlight"),this._highlight=null},te.prototype._getHighlightColors=function(){return{fill:this._simulationStyles.get("--token-simulation-silver-base-97"),stroke:this._simulationStyles.get("--token-simulation-green-base-44")}},te.$inject=["eventBus","canvas","scopeFilter","elementColors","simulationStyles"],ee.$inject=[],ee.prototype.get=function(t){const e=this._cache[t];return e||(this._computedStyle||(this._computedStyle=this._getComputedStyle()),this._cache[t]=this._computedStyle.getPropertyValue(t).trim())},ee.prototype._getComputedStyle=function(){return("function"==typeof getComputedStyle?getComputedStyle:ne)("undefined"!=typeof document?document.documentElement:{})};var ie={simulationStyles:["type",ee]},oe={__depends__:[et,ie],__init__:["showScopes"],showScopes:["type",te]},se=n("04ae");const re=jt();function ce(t){const e=t&&t.businessObject.name;return e&&Object(se.a)(e)}function ae(t,e,n,i,o,s){this._notifications=e,this._tokenSimulationPalette=n,this._canvas=i,this._scopeFilter=o,this._init(),t.on("tokenSimulation.scopeFilterChanged",t=>{const e=Object(nt.queryAll)(".entry[data-scope-id]",this._container);for(const t of e){const e=t.dataset.scopeId;Object(nt.classes)(t).toggle("inactive",!this._scopeFilter.isShown(e))}}),t.on(J,t=>{const{scope:e}=t,{destroyContext:n,element:i}=e,{reason:o}=n,s="complete"===o;if(!["bpmn:Process","bpmn:Participant","bpmn:SubProcess"].includes(i.type))return;const r=`${M(i,"bpmn:SubProcess")?ce(i)||"SubProcess":"Process"} ${s?"finished":"canceled"}`;this.log({text:r,icon:s?xt():Pt(),scope:e})}),t.on(K,t=>{const{scope:e}=t,{element:n}=e;if(!["bpmn:Process","bpmn:Participant","bpmn:SubProcess"].includes(n.type))return;const i=(M(n,"bpmn:SubProcess")?ce(n)||"SubProcess":"Process")+" started";this.log({text:i,icon:xt(),scope:e})}),t.on("tokenSimulation.simulator.trace",t=>{const{action:e,scope:n,element:i}=t;if("exit"!==e)return;const o=n.parent,s=ce(i);if(M(i,"bpmn:BusinessRuleTask")?this.log({text:s||"Business Rule Task",icon:"bpmn-icon-business-rule",scope:o}):M(i,"bpmn:CallActivity")?this.log({text:s||"Call Activity",icon:"bpmn-icon-call-activity",scope:o}):(M(i,"bpmn:IntermediateCatchEvent")||M(i,"bpmn:IntermediateThrowEvent"))&&this.log({text:s||"Intermediate Event",icon:"bpmn-icon-intermediate-event-none",scope:o}),M(i,"bpmn:BoundaryEvent"))this.log({text:s||"Boundary Event",icon:"bpmn-icon-intermediate-event-none",scope:o});else if(M(i,"bpmn:ManualTask"))this.log({text:s||"Manual Task",icon:"bpmn-icon-manual",scope:o});else if(M(i,"bpmn:ScriptTask"))this.log({text:s||"Script Task",icon:"bpmn-icon-script",scope:o});else if(M(i,"bpmn:ServiceTask"))this.log({text:s||"Service Task",icon:"bpmn-icon-service",scope:o});else if(M(i,"bpmn:Task"))this.log({text:s||"Task",icon:"bpmn-icon-task",scope:o});else if(M(i,"bpmn:UserTask"))this.log({text:s||"User Task",icon:"bpmn-icon-user",scope:o});else if(M(i,"bpmn:ExclusiveGateway")){if(i.outgoing.length<2)return;const t=ce(i.sequenceFlow);let e=s||"Gateway";t&&(e=e.concat(` ${wt()} ${t}`)),this.log({text:e,icon:"bpmn-icon-gateway-xor",scope:o})}else M(i,"bpmn:EndEvent")?I(Object(c.getBusinessObject)(i),"bpmn:TerminateEventDefinition")?this.log({text:s||"Terminate End Event",icon:"bpmn-icon-end-event-terminate",scope:o}):this.log({text:s||"End Event",icon:"bpmn-icon-end-event-none",scope:o}):M(i,"bpmn:StartEvent")&&this.log({text:s||"Start Event",icon:"bpmn-icon-start-event-none",scope:o})}),t.on([W,Z],t=>{this.clear(),Object(nt.classes)(this._container).add("hidden")})}ae.prototype._init=function(){this._container=Object(nt.domify)(`\n    <div class="token-simulation-log hidden">\n      <div class="header">\n        ${St("log-icon")}\n        <button class="close">\n          ${Tt()}\n        </button>\n      </div>\n      <div class="content">\n        <p class="entry placeholder">No Entries</p>\n      </div>\n    </div>\n  `),this._placeholder=Object(nt.query)(".placeholder",this._container),this._content=Object(nt.query)(".content",this._container),nt.event.bind(this._content,"wheel",t=>{t.stopPropagation()}),nt.event.bind(this._content,"mousedown",t=>{t.stopPropagation()}),this._close=Object(nt.query)(".close",this._container),nt.event.bind(this._close,"click",()=>{Object(nt.classes)(this._container).add("hidden")}),this._icon=Object(nt.query)(".log-icon",this._container),nt.event.bind(this._icon,"click",()=>{Object(nt.classes)(this._container).add("hidden")}),this._canvas.getContainer().appendChild(this._container),this.paletteEntry=Object(nt.domify)(`\n    <div class="entry" title="Show Simulation Log">\n      ${St()}\n    </div>\n  `),nt.event.bind(this.paletteEntry,"click",()=>{Object(nt.classes)(this._container).remove("hidden")}),this._tokenSimulationPalette.addEntry(this.paletteEntry,3)},ae.prototype.toggle=function(){const t=this._container;Object(nt.classes)(t).has("hidden")?Object(nt.classes)(t).remove("hidden"):Object(nt.classes)(t).add("hidden")},ae.prototype.log=function(t){const{text:e,type:n="info",icon:i=re,scope:o}=t;Object(nt.classes)(this._placeholder).add("hidden");const s=new Date,r=s.toLocaleTimeString()+":"+s.getUTCMilliseconds();this._notifications.showNotification(t);const c=i.startsWith("<")?i:`<i class="${i}"></i>`,a=o&&o.colors,l=a?`style="background: ${a.primary}; color: ${a.auxiliary}"`:"",p=Object(nt.domify)(`\n    <p class="entry ${n} ${o&&this._scopeFilter.isShown(o)?"":"inactive"}" ${o?`data-scope-id="${o.id}"`:""}>\n      <span class="date">${r}</span>\n      <span class="icon">${c}</span>\n      <span class="text">${e}</span>\n      ${o?`<span class="scope" data-scope-id="${o.id}" ${l}>${o.id}</span>`:""}\n    </p>\n  `);nt.delegate.bind(p,".scope[data-scope-id]","click",t=>{this._scopeFilter.toggle(o)}),this._content.appendChild(p),this._content.scrollTop=this._content.scrollHeight},ae.prototype.clear=function(){for(;this._content.firstChild;)this._content.removeChild(this._content.firstChild);this._placeholder=Object(nt.domify)('<p class="entry placeholder">No Entries</p>'),this._content.appendChild(this._placeholder)},ae.$inject=["eventBus","notifications","tokenSimulationPalette","canvas","scopeFilter","simulator"];var le={__depends__:[Qt,et],__init__:["log"],log:["type",ae]};const pe=["bpmn:InclusiveGateway","bpmn:ComplexGateway"];function he(t,e,n,i,o){this._eventBus=t,this._elementRegistry=e,this._elementNotifications=o,this._notifications=i,this._canvasParent=n.getContainer().parentNode,t.on(W,t=>{t.active?this.enable():this.clear()})}he.prototype.getUnsupportedElements=function(){return this._unsupportedElements},he.prototype.enable=function(){const t=[];this._elementRegistry.forEach(e=>{(function(t){return t.labelTarget})(e)||M(e,pe)&&(this.showWarning(e),t.push(e))}),t.length&&this._notifications.showNotification({text:"Found unsupported elements",icon:Bt(),type:"warning",ttl:5e3}),this._unsupportedElements=t},he.prototype.clear=function(){Object(nt.classes)(this._canvasParent).remove("warning")},he.prototype.showWarning=function(t){this._elementNotifications.addElementNotification(t,{type:"warning",icon:Bt(),text:"Not supported"})},he.$inject=["eventBus","elementRegistry","canvas","notifications","elementNotifications"];var ue={__depends__:[Wt,Qt],__init__:["elementSupport"],elementSupport:["type",he]};const me=Ot(),de=kt();function fe(t,e,n,i){this._eventBus=t,this._tokenSimulationPalette=e,this._notifications=n,this.canvasParent=i.getContainer().parentNode,this.isActive=!1,this.isPaused=!0,this._init(),t.on(K,1500,t=>{this.activate(),this.unpause()}),t.on([Z,W],()=>{this.deactivate(),this.pause()}),t.on("tokenSimulation.simulator.trace",1500,t=>{this.unpause()})}fe.prototype._init=function(){this.paletteEntry=Object(nt.domify)(`\n    <div class="entry disabled" title="Play/Pause Simulation">\n      ${me}\n    </div>\n  `),nt.event.bind(this.paletteEntry,"click",this.toggle.bind(this)),this._tokenSimulationPalette.addEntry(this.paletteEntry,1)},fe.prototype.toggle=function(){this.isPaused?this.unpause():this.pause()},fe.prototype.pause=function(){this.isActive&&(Object(nt.classes)(this.paletteEntry).remove("active"),Object(nt.classes)(this.canvasParent).add("paused"),this.paletteEntry.innerHTML=me,this._eventBus.fire("tokenSimulation.pauseSimulation"),this._notifications.showNotification({text:"Pause Simulation"}),this.isPaused=!0)},fe.prototype.unpause=function(){this.isActive&&this.isPaused&&(Object(nt.classes)(this.paletteEntry).add("active"),Object(nt.classes)(this.canvasParent).remove("paused"),this.paletteEntry.innerHTML=de,this._eventBus.fire("tokenSimulation.playSimulation"),this._notifications.showNotification({text:"Play Simulation"}),this.isPaused=!1)},fe.prototype.activate=function(){this.isActive=!0,Object(nt.classes)(this.paletteEntry).remove("disabled")},fe.prototype.deactivate=function(){this.isActive=!1,Object(nt.classes)(this.paletteEntry).remove("active"),Object(nt.classes)(this.paletteEntry).add("disabled")},fe.$inject=["eventBus","tokenSimulationPalette","notifications","canvas"];var ve={__depends__:[Qt],__init__:["pauseSimulation"],pauseSimulation:["type",fe]};function ge(t,e,n){this._eventBus=t,this._tokenSimulationPalette=e,this._notifications=n,this._init(),t.on(K,()=>{Object(nt.classes)(this._paletteEntry).remove("disabled")}),t.on(W,t=>{(this._active=t.active)||this.resetSimulation()})}ge.prototype._init=function(){this._paletteEntry=Object(nt.domify)(`\n    <div class="entry disabled" title="Reset Simulation">\n      ${Ft()}\n    </div>\n  `),nt.event.bind(this._paletteEntry,"click",()=>{this.resetSimulation(),this._notifications.showNotification({text:"Reset Simulation",type:"info"})}),this._tokenSimulationPalette.addEntry(this._paletteEntry,2)},ge.prototype.resetSimulation=function(){Object(nt.classes)(this._paletteEntry).add("disabled"),this._eventBus.fire(Z)},ge.$inject=["eventBus","tokenSimulationPalette","notifications"];var _e={__depends__:[Qt],__init__:["resetSimulation"],resetSimulation:["type",ge]};function ye(t,e,n,i,o){this._overlays=e,this._scopeFilter=i,this._simulator=n,this._simulationStyles=o,this.overlayIds={},t.on("tokenSimulation.simulator.elementChanged",500,t=>{const{element:e}=t;this.removeTokenCounts(e),this.addTokenCounts(e)}),t.on("tokenSimulation.scopeFilterChanged",t=>{const n=Object(nt.queryAll)(".token-count[data-scope-id]",e._overlayRoot);for(const t of n){const e=t.dataset.scopeId;Object(nt.classes)(t).toggle("inactive",!this._scopeFilter.isShown(e))}})}ye.prototype.addTokenCounts=function(t){if(M(t,"bpmn:MessageFlow")||M(t,"bpmn:SequenceFlow"))return;const e=this._simulator.findScopes(e=>!e.destroyed&&e.children.some(e=>!e.destroyed&&e.element===t&&!e.children.length));this.addTokenCount(t,e)},ye.prototype.addTokenCount=function(t,e){if(!e.length)return;const n=e.map(e=>this._getTokenHTML(t,e)).join(""),i=Object(nt.domify)(`\n    <div class="token-count-parent">\n      ${n}\n    </div>\n  `),o={bottom:10,left:-15},s=this._overlays.add(t,"token-count",{position:o,html:i,show:{minZoom:.5}});this.overlayIds[t.id]=s},ye.prototype.removeTokenCounts=function(t){this.removeTokenCount(t)},ye.prototype.removeTokenCount=function(t){const e=this.overlayIds[t.id];e&&(this._overlays.remove(e),delete this.overlayIds[t.id])},ye.prototype._getTokenHTML=function(t,e){const n=e.colors||this._getDefaultColors();return`\n    <div data-scope-id="${e.id}" class="token-count waiting ${this._scopeFilter.isShown(e)?"":"inactive"}"\n         style="color: ${n.auxiliary}; background: ${n.primary}">\n      ${e.getTokensByElement(t)}\n    </div>\n  `},ye.prototype._getDefaultColors=function(){return{primary:this._simulationStyles.get("--token-simulation-green-base-44"),auxiliary:this._simuationStyles.get("--token-simulation-white")}},ye.$inject=["eventBus","overlays","simulator","scopeFilter","simulationStyles"];var be={__depends__:[et,ie],__init__:["tokenCount"],tokenCount:["type",ye]};const Se=[["Slow",.5],["Normal",1],["Fast",2]];function we(t,e,n){this._canvas=t,this._animation=e,this._eventBus=n,this._init(e.getAnimationSpeed()),n.on(W,t=>{t.active?Object(nt.classes)(this._container).remove("hidden"):Object(nt.classes)(this._container).add("hidden")}),n.on("tokenSimulation.animationSpeedChanged",t=>{this.setActive(t.speed)})}we.prototype.getToggleSpeed=function(t){return parseFloat(t.dataset.speed)},we.prototype._init=function(t){this._container=Object(nt.domify)(`\n    <div class="set-animation-speed hidden">\n      ${$t()}\n      <div class="animation-speed-buttons">\n        ${Se.map(([e,n],i)=>`\n            <button title="Set animation speed = ${e}" data-speed="${n}" class="animation-speed-button ${n===t?"active":""}">\n              ${Array.from({length:i+1}).map(()=>wt()).join("")}\n            </button>\n          `).join("")}\n      </div>\n    </div>\n  `),nt.delegate.bind(this._container,"[data-speed]","click",t=>{const e=t.delegateTarget,n=this.getToggleSpeed(e);this._animation.setAnimationSpeed(n)}),this._canvas.getContainer().appendChild(this._container)},we.prototype.setActive=function(t){Object(nt.queryAll)("[data-speed]",this._container).forEach(e=>{const n=this.getToggleSpeed(e)===t;Object(nt.classes)(e)[n?"add":"remove"]("active")})},we.$inject=["canvas","animation","eventBus"];var xe={__init__:["setAnimationSpeed"],setAnimationSpeed:["type",we]};function Ce(t){return M(t,"bpmn:SequenceFlow")}function Ee(t,e,n,i,o){this._elementRegistry=e,this._elementColors=n,this._simulator=i,this._simulationStyles=o,t.on(W,t=>{t.active?this.setSequenceFlowsDefault():this.resetSequenceFlows()})}function Be(t,e){this._elementRegistry=t,this._graphicsFactory=e}function je(t){return t.businessObject&&t.businessObject.di}function ke(t){return"labelTarget"in t}Ee.prototype.setSequenceFlowsDefault=function(){const t=this._elementRegistry.filter(t=>M(t,"bpmn:ExclusiveGateway"));for(const e of t)this.setSequenceFlow(e)},Ee.prototype.resetSequenceFlows=function(){this._elementRegistry.filter(t=>M(t,"bpmn:ExclusiveGateway")).forEach(t=>{t.outgoing.filter(Ce).length&&this.resetSequenceFlow(t)})},Ee.prototype.resetSequenceFlow=function(t){this._simulator.setConfig(t,{activeOutgoing:void 0})},Ee.prototype.setSequenceFlow=function(t){const e=t.outgoing.filter(Ce);if(e.length<2)return;const{activeOutgoing:n}=this._simulator.getConfig(t);let i;i=n?function(t,e){var n=t.outgoing.filter(Ce),i=n.indexOf(e||t.sequenceFlow);return n[i+1]?n[i+1]:n[0]}(t,n):e[0],this._simulator.setConfig(t,{activeOutgoing:i}),t.outgoing.forEach(t=>{const e=t===i?"--token-simulation-grey-darken-30":"--token-simulation-grey-lighten-56",n=this._simulationStyles.get(e);this._elementColors.set(t,{stroke:n})})},Ee.$inject=["eventBus","elementRegistry","elementColors","simulator","simulationStyles"],Be.$inject=["elementRegistry","graphicsFactory"],Be.prototype.get=function(t){const e=je(t);if(e)return ke(t)?{stroke:e.label&&e.label.get("color")}:{fill:e.get("background-color"),stroke:e.get("border-color")}},Be.prototype.set=function(t,e){const{fill:n,stroke:i}=e,o=je(t);o&&(ke(t)?o.label&&o.label.set("color",i):(o.set("background-color",n),o.set("border-color",i)),this._forceRedraw(t))},Be.prototype._forceRedraw=function(t){const e=this._elementRegistry.getGraphics(t),n=t.waypoints?"connection":"shape";this._graphicsFactory.update(n,t,e)};var Oe={elementColors:["type",Be]},Fe={__depends__:[Oe,ie],exclusiveGatewaySettings:["type",Ee]};function $e(t,e,n){this._elementRegistry=e,this._elementColors=n,this._colorCache={},t.on(W,5e4,t=>{t.active?this.preserveColors():this.resetColors()})}$e.prototype.preserveColors=function(){this._elementRegistry.forEach(t=>{this._colorCache[t.id]=this._elementColors.get(t),this._elementColors.set(t,{stroke:"#000",fill:"#fff"})})},$e.prototype.resetColors=function(){this._elementRegistry.forEach(t=>{const e=this._colorCache[t.id];e&&this._elementColors.set(t,e)}),this._colorCache={}},$e.$inject=["eventBus","elementRegistry","elementColors"];var Pe={__depends__:[Oe],__init__:["preserveElementColors"],preserveElementColors:["type",$e]};function Te(t,e){var n=this;this._canvas=e,this.entries=[],this._init(),t.on(W,(function(t){t.active?Object(nt.classes)(n.container).remove("hidden"):Object(nt.classes)(n.container).add("hidden")}))}Te.prototype._init=function(){this.container=Object(nt.domify)('<div class="token-simulation-palette hidden"></div>'),this._canvas.getContainer().appendChild(this.container)},Te.prototype.addEntry=function(t,e){var n=0;this.entries.forEach((function(t){e>=t.index&&n++})),this.container.insertBefore(t,this.container.childNodes[n]),this.entries.push({entry:t,index:e})},Te.$inject=["eventBus","canvas"];var Le={__depends__:[D,ft,yt,Vt,Xt,oe,le,ue,ve,_e,be,xe,Fe,Pe,{__init__:["tokenSimulationPalette"],tokenSimulationPalette:["type",Te]}]};function Me(t,e,n,i,o,s,r,c){let a=!1;function l(t,e,n){const i=t[e];t[e]=function(){return n.call(this,i,arguments)}}function p(t,e){l(t,e,(function(t,e){if(!a)return t.apply(this,e)}))}function h(t,e){l(t,e,(function(t,e){if(a)throw new Error("model is read-only");return t.apply(this,e)}))}t.on(W,10001,t=>{a=t.active,a&&(i.cancel(),e.close(),n.cancel()),r._update()}),p(e,"open"),p(n,"init"),p(i,"activate"),p(n,"init"),p(i,"activate"),h(s,"moveShape"),h(s,"updateAttachment"),h(s,"moveElements"),h(s,"moveConnection"),h(s,"layoutConnection"),h(s,"createConnection"),h(s,"createShape"),h(s,"createLabel"),h(s,"appendShape"),h(s,"removeElements"),h(s,"distributeElements"),h(s,"removeShape"),h(s,"removeConnection"),h(s,"replaceShape"),h(s,"pasteElements"),h(s,"alignElements"),h(s,"resizeShape"),h(s,"createSpace"),h(s,"updateWaypoints"),h(s,"reconnectStart"),h(s,"reconnectEnd"),l(o,"trigger",(function(t,e){const n=e[0];if(!a||!function(t,e){return t.indexOf(e)>-1}(["undo","redo","copy","paste","removeSelection","spaceTool","lassoTool","globalConnectTool","distributeElements","alignElements","directEditing"],n))return t.apply(this,e)}))}Me.$inject=["eventBus","contextPad","dragging","directEditing","editorActions","modeling","palette","paletteProvider"];var Ae={__init__:["disableModeling"],disableModeling:["type",Me]};function Ie(t,e,n,i){this._eventBus=t,this._canvas=e,this._selection=n,this._contextPad=i,this._active=!1,t.on("import.parse.start",()=>{this._active&&(this.toggleMode(!1),t.once("import.done",()=>{this.toggleMode(!0)}))}),t.on("diagram.init",()=>{this._canvasParent=this._canvas.getContainer().parentNode,this._palette=Object(nt.query)(".djs-palette",this._canvas.getContainer()),this._init()})}Ie.prototype._init=function(){this._container=Object(nt.domify)(`\n    <div class="toggle-mode">\n      Token Simulation <span class="toggle">${Lt()}</span>\n    </div>\n  `),nt.event.bind(this._container,"click",()=>this.toggleMode()),this._canvas.getContainer().appendChild(this._container)},Ie.prototype.toggleMode=function(t=!this._active){if(t!==this._active){if(t)this._container.innerHTML=`Token Simulation <span class="toggle">${Mt()}</span>`,Object(nt.classes)(this._canvasParent).add("simulation"),Object(nt.classes)(this._palette).add("hidden");else{this._container.innerHTML=`Token Simulation <span class="toggle">${Lt()}</span>`,Object(nt.classes)(this._canvasParent).remove("simulation"),Object(nt.classes)(this._palette).remove("hidden");const t=this._selection.get();1===t.length&&this._contextPad.open(t[0])}this._eventBus.fire(W,{active:t}),this._active=t}},Ie.$inject=["eventBus","canvas","selection","contextPad"];var Re={__init__:["toggleMode"],toggleMode:["type",Ie]};function ze(t,e,n,i,o,s){o.register({toggleTokenSimulation:function(){e.toggleMode()}}),o.register({togglePauseTokenSimulation:function(){n.toggle()}}),o.register({resetTokenSimulation:function(){i.resetSimulation()}});const r=s.get("log",!1);r&&o.register({toggleTokenSimulationLog:function(){r.toggle()}})}ze.$inject=["eventBus","toggleMode","pauseSimulation","resetSimulation","editorActions","injector"];var He={__init__:["tokenSimulationEditorActions"],tokenSimulationEditorActions:["type",ze]};function qe(t,e){var n=e.get("editorActions",!1),i=e.get("keyboard",!1);if(i&&n){var o=!1;t.on("keyboard.init",(function(){i.addListener(1e4,(function(t){!function(t){De(["t","T"],t)?n.trigger("toggleTokenSimulation"):o&&(De(["l","L"],t)?n.trigger("toggleTokenSimulationLog"):De([" ","Spacebar"],t)?n.trigger("togglePauseTokenSimulation"):De(["r","R"],t)&&n.trigger("resetTokenSimulation"))}(t.keyEvent)}))})),t.on(W,(function(t){var e=t.active;o=!!e}))}}function De(t,e){return t.indexOf(e.key)>-1}qe.$inject=["eventBus","injector"];var Ge={__init__:["tokenSimulationKeyboardBindings"],tokenSimulationKeyboardBindings:["type",qe]};e.a={__depends__:[Le,Ae,Re,He,Ge]}}}]);