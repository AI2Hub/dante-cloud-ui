(window.webpackJsonp=window.webpackJsonp||[]).push([["npm.node-rsa"],{"0885":function(t,e,r){(function(e){r("3a6f");var i=r("0b00");t.exports={isEncryption:!0,isSignature:!1},t.exports.digestLength={md4:16,md5:16,ripemd160:20,rmd160:20,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64};t.exports.eme_oaep_mgf1=function(r,n,o){o=o||"sha1";for(var s=t.exports.digestLength[o],h=Math.ceil(n/s),p=e.alloc(s*h),a=e.alloc(4),f=0;f<h;++f){var c=i.createHash(o);c.update(r),a.writeUInt32BE(f,0),c.update(a),c.digest().copy(p,f*s)}return p.slice(0,n)},t.exports.makeScheme=function(r,n){function o(t,e){this.key=t,this.options=e}return o.prototype.maxMessageLength=function(){return this.key.encryptedDataLength-2*t.exports.digestLength[this.options.encryptionSchemeOptions.hash||"sha1"]-2},o.prototype.encPad=function(r){var n=this.options.encryptionSchemeOptions.hash||"sha1",o=this.options.encryptionSchemeOptions.mgf||t.exports.eme_oaep_mgf1,s=this.options.encryptionSchemeOptions.label||e.alloc(0),h=this.key.encryptedDataLength,p=t.exports.digestLength[n];if(r.length>h-2*p-2)throw new Error("Message is too long to encode into an encoded message with a length of "+h+" bytes, increaseemLen to fix this error (minimum value for given parameters and options: "+(h-2*p-2)+")");var a=i.createHash(n);a.update(s),a=a.digest();var f=e.alloc(h-r.length-2*p-1);f.fill(0),f[f.length-1]=1;for(var c=e.concat([a,f,r]),u=i.randomBytes(p),l=o(u,c.length,n),m=0;m<c.length;m++)c[m]^=l[m];for(l=o(c,p,n),m=0;m<u.length;m++)u[m]^=l[m];var y=e.alloc(1+u.length+c.length);return y[0]=0,u.copy(y,1),c.copy(y,1+u.length),y},o.prototype.encUnPad=function(r){var n=this.options.encryptionSchemeOptions.hash||"sha1",o=this.options.encryptionSchemeOptions.mgf||t.exports.eme_oaep_mgf1,s=this.options.encryptionSchemeOptions.label||e.alloc(0),h=t.exports.digestLength[n];if(r.length<2*h+2)throw new Error("Error decoding message, the supplied message is not long enough to be a valid OAEP encoded message");for(var p=r.slice(1,h+1),a=r.slice(1+h),f=o(a,h,n),c=0;c<p.length;c++)p[c]^=f[c];for(f=o(p,a.length,n),c=0;c<a.length;c++)a[c]^=f[c];var u=i.createHash(n);if(u.update(s),u=u.digest(),a.slice(0,h).toString("hex")!=u.toString("hex"))throw new Error("Error decoding message, the lHash calculated from the label provided and the lHash in the encrypted data do not match.");for(c=h;0===a[c++]&&c<a.length;);if(1!=a[c-1])throw new Error("Error decoding message, there is no padding message separator byte");return a.slice(c)},new o(r,n)}}).call(this,r("2cc2").Buffer)},"0dce":function(t,e,r){(function(e){var i=r("74ea").Ber,n=r("7aa4")._,o=r("7aa4");t.exports={privateExport:function(t,e){e=e||{};var r=t.n.toBuffer(),n=t.d.toBuffer(),s=t.p.toBuffer(),h=t.q.toBuffer(),p=t.dmp1.toBuffer(),a=t.dmq1.toBuffer(),f=t.coeff.toBuffer(),c=r.length+n.length+s.length+h.length+p.length+a.length+f.length+512,u=new i.Writer({size:c});u.startSequence(),u.writeInt(0),u.writeBuffer(r,2),u.writeInt(t.e),u.writeBuffer(n,2),u.writeBuffer(s,2),u.writeBuffer(h,2),u.writeBuffer(p,2),u.writeBuffer(a,2),u.writeBuffer(f,2),u.endSequence();var l=new i.Writer({size:c});return l.startSequence(),l.writeInt(0),l.startSequence(),l.writeOID("1.2.840.113549.1.1.1"),l.writeNull(),l.endSequence(),l.writeBuffer(u.buffer,4),l.endSequence(),"der"===e.type?l.buffer:"-----BEGIN PRIVATE KEY-----\n"+o.linebrk(l.buffer.toString("base64"),64)+"\n-----END PRIVATE KEY-----"},privateImport:function(t,r,s){var h;if("der"!==(s=s||{}).type){if(e.isBuffer(r)&&(r=r.toString("utf8")),!n.isString(r))throw Error("Unsupported key format");var p=o.trimSurroundingText(r,"-----BEGIN PRIVATE KEY-----","-----END PRIVATE KEY-----").replace("-----END PRIVATE KEY-----","").replace(/\s+|\n\r|\n|\r$/gm,"");h=e.from(p,"base64")}else{if(!e.isBuffer(r))throw Error("Unsupported key format");h=r}var a=new i.Reader(h);if(a.readSequence(),a.readInt(0),"1.2.840.113549.1.1.1"!==new i.Reader(a.readString(48,!0)).readOID(6,!0))throw Error("Invalid Public key format");var f=new i.Reader(a.readString(4,!0));f.readSequence(),f.readString(2,!0),t.setPrivate(f.readString(2,!0),f.readString(2,!0),f.readString(2,!0),f.readString(2,!0),f.readString(2,!0),f.readString(2,!0),f.readString(2,!0),f.readString(2,!0))},publicExport:function(t,e){e=e||{};var r=t.n.toBuffer(),n=r.length+512,s=new i.Writer({size:n});s.writeByte(0),s.startSequence(),s.writeBuffer(r,2),s.writeInt(t.e),s.endSequence();var h=new i.Writer({size:n});return h.startSequence(),h.startSequence(),h.writeOID("1.2.840.113549.1.1.1"),h.writeNull(),h.endSequence(),h.writeBuffer(s.buffer,3),h.endSequence(),"der"===e.type?h.buffer:"-----BEGIN PUBLIC KEY-----\n"+o.linebrk(h.buffer.toString("base64"),64)+"\n-----END PUBLIC KEY-----"},publicImport:function(t,r,s){var h;if("der"!==(s=s||{}).type){if(e.isBuffer(r)&&(r=r.toString("utf8")),n.isString(r)){var p=o.trimSurroundingText(r,"-----BEGIN PUBLIC KEY-----","-----END PUBLIC KEY-----").replace(/\s+|\n\r|\n|\r$/gm,"");h=e.from(p,"base64")}}else{if(!e.isBuffer(r))throw Error("Unsupported key format");h=r}var a=new i.Reader(h);if(a.readSequence(),"1.2.840.113549.1.1.1"!==new i.Reader(a.readString(48,!0)).readOID(6,!0))throw Error("Invalid Public key format");var f=new i.Reader(a.readString(3,!0));f.readByte(),f.readSequence(),t.setPublic(f.readString(2,!0),f.readString(2,!0))},autoImport:function(e,r){return/^[\S\s]*-----BEGIN PRIVATE KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END PRIVATE KEY-----[\S\s]*$/g.test(r)?(t.exports.privateImport(e,r),!0):!!/^[\S\s]*-----BEGIN PUBLIC KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END PUBLIC KEY-----[\S\s]*$/g.test(r)&&(t.exports.publicImport(e,r),!0)}}}).call(this,r("2cc2").Buffer)},1651:function(t,e,r){var i=r("0b00"),n=r("227a"),o=r("f286");t.exports=function(t,e){var r=o.pkcs1.makeScheme(t,e);return{encrypt:function(t,o){var s;if(o)return s=n.RSA_PKCS1_PADDING,e.encryptionSchemeOptions&&e.encryptionSchemeOptions.padding&&(s=e.encryptionSchemeOptions.padding),i.privateEncrypt({key:e.rsaUtils.exportKey("private"),padding:s},t);s=n.RSA_PKCS1_OAEP_PADDING,"pkcs1"===e.encryptionScheme&&(s=n.RSA_PKCS1_PADDING),e.encryptionSchemeOptions&&e.encryptionSchemeOptions.padding&&(s=e.encryptionSchemeOptions.padding);var h=t;return s===n.RSA_NO_PADDING&&(h=r.pkcs0pad(t)),i.publicEncrypt({key:e.rsaUtils.exportKey("public"),padding:s},h)},decrypt:function(t,o){var s;if(o)return s=n.RSA_PKCS1_PADDING,e.encryptionSchemeOptions&&e.encryptionSchemeOptions.padding&&(s=e.encryptionSchemeOptions.padding),i.publicDecrypt({key:e.rsaUtils.exportKey("public"),padding:s},t);s=n.RSA_PKCS1_OAEP_PADDING,"pkcs1"===e.encryptionScheme&&(s=n.RSA_PKCS1_PADDING),e.encryptionSchemeOptions&&e.encryptionSchemeOptions.padding&&(s=e.encryptionSchemeOptions.padding);var h=i.privateDecrypt({key:e.rsaUtils.exportKey("private"),padding:s},t);return s===n.RSA_NO_PADDING?r.pkcs0unpad(h):h}}}},2172:function(t,e,r){var i=r("3a6f"),n=r("f286");t.exports=function(t,e){var r=n.pkcs1.makeScheme(t,e);return{encrypt:function(e,n){var o,s;return n?(o=new i(r.encPad(e,{type:1})),s=t.$doPrivate(o)):(o=new i(t.encryptionScheme.encPad(e)),s=t.$doPublic(o)),s.toBuffer(t.encryptedDataLength)},decrypt:function(e,n){var o,s=new i(e);return n?(o=t.$doPublic(s),r.encUnPad(o.toBuffer(t.encryptedDataLength),{type:1})):(o=t.$doPrivate(s),t.encryptionScheme.encUnPad(o.toBuffer(t.encryptedDataLength)))}}}},2556:function(t,e,r){r("7aa4")._,r("7aa4");t.exports={privateExport:function(t,e){return{n:t.n.toBuffer(),e:t.e,d:t.d.toBuffer(),p:t.p.toBuffer(),q:t.q.toBuffer(),dmp1:t.dmp1.toBuffer(),dmq1:t.dmq1.toBuffer(),coeff:t.coeff.toBuffer()}},privateImport:function(t,e,r){if(!(e.n&&e.e&&e.d&&e.p&&e.q&&e.dmp1&&e.dmq1&&e.coeff))throw Error("Invalid key data");t.setPrivate(e.n,e.e,e.d,e.p,e.q,e.dmp1,e.dmq1,e.coeff)},publicExport:function(t,e){return{n:t.n.toBuffer(),e:t.e}},publicImport:function(t,e,r){if(!e.n||!e.e)throw Error("Invalid key data");t.setPublic(e.n,e.e)},autoImport:function(e,r){return!(!r.n||!r.e)&&(r.d&&r.p&&r.q&&r.dmp1&&r.dmq1&&r.coeff?(t.exports.privateImport(e,r),!0):(t.exports.publicImport(e,r),!0))}}},"3a6f":function(t,e,r){(function(e){var i=r("0b00"),n=r("7aa4")._;function o(t,r){null!=t&&("number"==typeof t?this.fromNumber(t,r):e.isBuffer(t)?this.fromBuffer(t):null==r&&"string"!=typeof t?this.fromByteArray(t):this.fromString(t,r))}function s(){return new o(null)}o.prototype.am=function(t,e,r,i,n,o){for(var s=16383&e,h=e>>14;--o>=0;){var p=16383&this[t],a=this[t++]>>14,f=h*p+a*s;n=((p=s*p+((16383&f)<<14)+r[i]+n)>>28)+(f>>14)+h*a,r[i++]=268435455&p}return n},o.prototype.DB=28,o.prototype.DM=268435455,o.prototype.DV=1<<28;o.prototype.FV=Math.pow(2,52),o.prototype.F1=24,o.prototype.F2=4;var h,p,a=new Array;for(h="0".charCodeAt(0),p=0;p<=9;++p)a[h++]=p;for(h="a".charCodeAt(0),p=10;p<36;++p)a[h++]=p;for(h="A".charCodeAt(0),p=10;p<36;++p)a[h++]=p;function f(t){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(t)}function c(t,e){var r=a[t.charCodeAt(e)];return null==r?-1:r}function u(t){var e=s();return e.fromInt(t),e}function l(t){var e,r=1;return 0!=(e=t>>>16)&&(t=e,r+=16),0!=(e=t>>8)&&(t=e,r+=8),0!=(e=t>>4)&&(t=e,r+=4),0!=(e=t>>2)&&(t=e,r+=2),0!=(e=t>>1)&&(t=e,r+=1),r}function m(t){this.m=t}function y(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function d(t,e){return t&e}function g(t,e){return t|e}function v(t,e){return t^e}function S(t,e){return t&~e}function b(t){if(0===t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function E(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function B(){}function w(t){return t}function T(t){this.r2=s(),this.q3=s(),o.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}m.prototype.convert=function(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t},m.prototype.revert=function(t){return t},m.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},m.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},m.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},y.prototype.convert=function(t){var e=s();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(o.ZERO)>0&&this.m.subTo(e,e),e},y.prototype.revert=function(t){var e=s();return t.copyTo(e),this.reduce(e),e},y.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=32767&t[e],i=r*this.mpl+((r*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[r=e+this.m.t]+=this.m.am(0,i,t,e,0,this.m.t);t[r]>=t.DV;)t[r]-=t.DV,t[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)},y.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},y.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},B.prototype.convert=w,B.prototype.revert=w,B.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r)},B.prototype.sqrTo=function(t,e){t.squareTo(e)},T.prototype.convert=function(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=s();return t.copyTo(e),this.reduce(e),e},T.prototype.revert=function(t){return t},T.prototype.reduce=function(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)},T.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},T.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)};var D=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],k=(1<<26)/D[D.length-1];o.prototype.copyTo=function(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s},o.prototype.fromInt=function(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+DV:this.t=0},o.prototype.fromString=function(t,e,r){var i;switch(e){case 2:i=1;break;case 4:i=2;break;case 8:i=3;break;case 16:i=4;break;case 32:i=5;break;case 256:i=8;break;default:return void this.fromRadix(t,e)}this.t=0,this.s=0;for(var n=t.length,s=!1,h=0;--n>=0;){var p=8==i?255&t[n]:c(t,n);p<0?"-"==t.charAt(n)&&(s=!0):(s=!1,0===h?this[this.t++]=p:h+i>this.DB?(this[this.t-1]|=(p&(1<<this.DB-h)-1)<<h,this[this.t++]=p>>this.DB-h):this[this.t-1]|=p<<h,(h+=i)>=this.DB&&(h-=this.DB))}r||8!=i||0==(128&t[0])||(this.s=-1,h>0&&(this[this.t-1]|=(1<<this.DB-h)-1<<h)),this.clamp(),s&&o.ZERO.subTo(this,this)},o.prototype.fromByteArray=function(t,e){this.fromString(t,256,e)},o.prototype.fromBuffer=function(t){this.fromString(t,256,!0)},o.prototype.clamp=function(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t},o.prototype.dlShiftTo=function(t,e){var r;for(r=this.t-1;r>=0;--r)e[r+t]=this[r];for(r=t-1;r>=0;--r)e[r]=0;e.t=this.t+t,e.s=this.s},o.prototype.drShiftTo=function(t,e){for(var r=t;r<this.t;++r)e[r-t]=this[r];e.t=Math.max(this.t-t,0),e.s=this.s},o.prototype.lShiftTo=function(t,e){var r,i=t%this.DB,n=this.DB-i,o=(1<<n)-1,s=Math.floor(t/this.DB),h=this.s<<i&this.DM;for(r=this.t-1;r>=0;--r)e[r+s+1]=this[r]>>n|h,h=(this[r]&o)<<i;for(r=s-1;r>=0;--r)e[r]=0;e[s]=h,e.t=this.t+s+1,e.s=this.s,e.clamp()},o.prototype.rShiftTo=function(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t)e.t=0;else{var i=t%this.DB,n=this.DB-i,o=(1<<i)-1;e[0]=this[r]>>i;for(var s=r+1;s<this.t;++s)e[s-r-1]|=(this[s]&o)<<n,e[s-r]=this[s]>>i;i>0&&(e[this.t-r-1]|=(this.s&o)<<n),e.t=this.t-r,e.clamp()}},o.prototype.subTo=function(t,e){for(var r=0,i=0,n=Math.min(t.t,this.t);r<n;)i+=this[r]-t[r],e[r++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i-=t.s;r<this.t;)i+=this[r],e[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i-=t[r],e[r++]=i&this.DM,i>>=this.DB;i-=t.s}e.s=i<0?-1:0,i<-1?e[r++]=this.DV+i:i>0&&(e[r++]=i),e.t=r,e.clamp()},o.prototype.multiplyTo=function(t,e){var r=this.abs(),i=t.abs(),n=r.t;for(e.t=n+i.t;--n>=0;)e[n]=0;for(n=0;n<i.t;++n)e[n+r.t]=r.am(0,i[n],e,n,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&o.ZERO.subTo(e,e)},o.prototype.squareTo=function(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t[r]=0;for(r=0;r<e.t-1;++r){var i=e.am(r,e[r],t,2*r,0,1);(t[r+e.t]+=e.am(r+1,2*e[r],t,2*r+1,i,e.t-r-1))>=e.DV&&(t[r+e.t]-=e.DV,t[r+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(r,e[r],t,2*r,0,1)),t.s=0,t.clamp()},o.prototype.divRemTo=function(t,e,r){var i=t.abs();if(!(i.t<=0)){var n=this.abs();if(n.t<i.t)return null!=e&&e.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=s());var h=s(),p=this.s,a=t.s,f=this.DB-l(i[i.t-1]);f>0?(i.lShiftTo(f,h),n.lShiftTo(f,r)):(i.copyTo(h),n.copyTo(r));var c=h.t,u=h[c-1];if(0!==u){var m=u*(1<<this.F1)+(c>1?h[c-2]>>this.F2:0),y=this.FV/m,d=(1<<this.F1)/m,g=1<<this.F2,v=r.t,S=v-c,b=null==e?s():e;for(h.dlShiftTo(S,b),r.compareTo(b)>=0&&(r[r.t++]=1,r.subTo(b,r)),o.ONE.dlShiftTo(c,b),b.subTo(h,h);h.t<c;)h[h.t++]=0;for(;--S>=0;){var E=r[--v]==u?this.DM:Math.floor(r[v]*y+(r[v-1]+g)*d);if((r[v]+=h.am(0,E,r,S,0,c))<E)for(h.dlShiftTo(S,b),r.subTo(b,r);r[v]<--E;)r.subTo(b,r)}null!=e&&(r.drShiftTo(c,e),p!=a&&o.ZERO.subTo(e,e)),r.t=c,r.clamp(),f>0&&r.rShiftTo(f,r),p<0&&o.ZERO.subTo(r,r)}}},o.prototype.invDigit=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return(e=(e=(e=(e=e*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)>0?this.DV-e:-e},o.prototype.isEven=function(){return 0===(this.t>0?1&this[0]:this.s)},o.prototype.exp=function(t,e){if(t>4294967295||t<1)return o.ONE;var r=s(),i=s(),n=e.convert(this),h=l(t)-1;for(n.copyTo(r);--h>=0;)if(e.sqrTo(r,i),(t&1<<h)>0)e.mulTo(i,n,r);else{var p=r;r=i,i=p}return e.revert(r)},o.prototype.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},o.prototype.toRadix=function(t){if(null==t&&(t=10),0===this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),i=u(r),n=s(),o=s(),h="";for(this.divRemTo(i,n,o);n.signum()>0;)h=(r+o.intValue()).toString(t).substr(1)+h,n.divRemTo(i,n,o);return o.intValue().toString(t)+h},o.prototype.fromRadix=function(t,e){this.fromInt(0),null==e&&(e=10);for(var r=this.chunkSize(e),i=Math.pow(e,r),n=!1,s=0,h=0,p=0;p<t.length;++p){var a=c(t,p);a<0?"-"==t.charAt(p)&&0===this.signum()&&(n=!0):(h=e*h+a,++s>=r&&(this.dMultiply(i),this.dAddOffset(h,0),s=0,h=0))}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(h,0)),n&&o.ZERO.subTo(this,this)},o.prototype.fromNumber=function(t,e){if("number"==typeof e)if(t<2)this.fromInt(1);else for(this.fromNumber(t),this.testBit(t-1)||this.bitwiseTo(o.ONE.shiftLeft(t-1),g,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(o.ONE.shiftLeft(t-1),this);else{var r=i.randomBytes(1+(t>>3)),n=7&t;n>0?r[0]&=(1<<n)-1:r[0]=0,this.fromByteArray(r)}},o.prototype.bitwiseTo=function(t,e,r){var i,n,o=Math.min(t.t,this.t);for(i=0;i<o;++i)r[i]=e(this[i],t[i]);if(t.t<this.t){for(n=t.s&this.DM,i=o;i<this.t;++i)r[i]=e(this[i],n);r.t=this.t}else{for(n=this.s&this.DM,i=o;i<t.t;++i)r[i]=e(n,t[i]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()},o.prototype.changeBit=function(t,e){var r=o.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r},o.prototype.addTo=function(t,e){for(var r=0,i=0,n=Math.min(t.t,this.t);r<n;)i+=this[r]+t[r],e[r++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i+=t.s;r<this.t;)i+=this[r],e[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i+=t[r],e[r++]=i&this.DM,i>>=this.DB;i+=t.s}e.s=i<0?-1:0,i>0?e[r++]=i:i<-1&&(e[r++]=this.DV+i),e.t=r,e.clamp()},o.prototype.dMultiply=function(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},o.prototype.dAddOffset=function(t,e){if(0!==t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}},o.prototype.multiplyLowerTo=function(t,e,r){var i,n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r[--n]=0;for(i=r.t-this.t;n<i;++n)r[n+this.t]=this.am(0,t[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t[n],r,n,0,e-n);r.clamp()},o.prototype.multiplyUpperTo=function(t,e,r){--e;var i=r.t=this.t+t.t-e;for(r.s=0;--i>=0;)r[i]=0;for(i=Math.max(e-this.t,0);i<t.t;++i)r[this.t+i-e]=this.am(e-i,t[i],r,0,0,this.t+i-e);r.clamp(),r.drShiftTo(1,r)},o.prototype.modInt=function(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(0===e)r=this[0]%t;else for(var i=this.t-1;i>=0;--i)r=(e*r+this[i])%t;return r},o.prototype.millerRabin=function(t){var e=this.subtract(o.ONE),r=e.getLowestSetBit();if(r<=0)return!1;var i=e.shiftRight(r);(t=t+1>>1)>D.length&&(t=D.length);for(var n=s(),h=0;h<t;++h){n.fromInt(D[Math.floor(Math.random()*D.length)]);var p=n.modPow(i,this);if(0!=p.compareTo(o.ONE)&&0!=p.compareTo(e)){for(var a=1;a++<r&&0!=p.compareTo(e);)if(0===(p=p.modPowInt(2,this)).compareTo(o.ONE))return!1;if(0!=p.compareTo(e))return!1}}return!0},o.prototype.toString=function(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var r,i=(1<<e)-1,n=!1,o="",s=this.t,h=this.DB-s*this.DB%e;if(s-- >0)for(h<this.DB&&(r=this[s]>>h)>0&&(n=!0,o=f(r));s>=0;)h<e?(r=(this[s]&(1<<h)-1)<<e-h,r|=this[--s]>>(h+=this.DB-e)):(r=this[s]>>(h-=e)&i,h<=0&&(h+=this.DB,--s)),r>0&&(n=!0),n&&(o+=f(r));return n?o:"0"},o.prototype.negate=function(){var t=s();return o.ZERO.subTo(this,t),t},o.prototype.abs=function(){return this.s<0?this.negate():this},o.prototype.compareTo=function(t){var e=this.s-t.s;if(0!=e)return e;var r=this.t;if(0!=(e=r-t.t))return this.s<0?-e:e;for(;--r>=0;)if(0!=(e=this[r]-t[r]))return e;return 0},o.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+l(this[this.t-1]^this.s&this.DM)},o.prototype.mod=function(t){var e=s();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(o.ZERO)>0&&t.subTo(e,e),e},o.prototype.modPowInt=function(t,e){var r;return r=t<256||e.isEven()?new m(e):new y(e),this.exp(t,r)},o.prototype.clone=function(){var t=s();return this.copyTo(t),t},o.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0===this.t)return-1}else{if(1==this.t)return this[0];if(0===this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},o.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},o.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},o.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},o.prototype.toByteArray=function(){var t=this.t,e=new Array;e[0]=this.s;var r,i=this.DB-t*this.DB%8,n=0;if(t-- >0)for(i<this.DB&&(r=this[t]>>i)!=(this.s&this.DM)>>i&&(e[n++]=r|this.s<<this.DB-i);t>=0;)i<8?(r=(this[t]&(1<<i)-1)<<8-i,r|=this[--t]>>(i+=this.DB-8)):(r=this[t]>>(i-=8)&255,i<=0&&(i+=this.DB,--t)),0!=(128&r)&&(r|=-256),0===n&&(128&this.s)!=(128&r)&&++n,(n>0||r!=this.s)&&(e[n++]=r);return e},o.prototype.toBuffer=function(t){var r=e.from(this.toByteArray());if(!0===t&&0===r[0])r=r.slice(1);else if(n.isNumber(t)){if(r.length>t){for(var i=0;i<r.length-t;i++)if(0!==r[i])return null;return r.slice(r.length-t)}if(r.length<t){var o=e.alloc(t);return o.fill(0,0,t-r.length),r.copy(o,t-r.length),o}}return r},o.prototype.equals=function(t){return 0==this.compareTo(t)},o.prototype.min=function(t){return this.compareTo(t)<0?this:t},o.prototype.max=function(t){return this.compareTo(t)>0?this:t},o.prototype.and=function(t){var e=s();return this.bitwiseTo(t,d,e),e},o.prototype.or=function(t){var e=s();return this.bitwiseTo(t,g,e),e},o.prototype.xor=function(t){var e=s();return this.bitwiseTo(t,v,e),e},o.prototype.andNot=function(t){var e=s();return this.bitwiseTo(t,S,e),e},o.prototype.not=function(){for(var t=s(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t},o.prototype.shiftLeft=function(t){var e=s();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e},o.prototype.shiftRight=function(t){var e=s();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e},o.prototype.getLowestSetBit=function(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+b(this[t]);return this.s<0?this.t*this.DB:-1},o.prototype.bitCount=function(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=E(this[r]^e);return t},o.prototype.testBit=function(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)},o.prototype.setBit=function(t){return this.changeBit(t,g)},o.prototype.clearBit=function(t){return this.changeBit(t,S)},o.prototype.flipBit=function(t){return this.changeBit(t,v)},o.prototype.add=function(t){var e=s();return this.addTo(t,e),e},o.prototype.subtract=function(t){var e=s();return this.subTo(t,e),e},o.prototype.multiply=function(t){var e=s();return this.multiplyTo(t,e),e},o.prototype.divide=function(t){var e=s();return this.divRemTo(t,e,null),e},o.prototype.remainder=function(t){var e=s();return this.divRemTo(t,null,e),e},o.prototype.divideAndRemainder=function(t){var e=s(),r=s();return this.divRemTo(t,e,r),new Array(e,r)},o.prototype.modPow=function(t,e){var r,i,n=t.bitLength(),o=u(1);if(n<=0)return o;r=n<18?1:n<48?3:n<144?4:n<768?5:6,i=n<8?new m(e):e.isEven()?new T(e):new y(e);var h=new Array,p=3,a=r-1,f=(1<<r)-1;if(h[1]=i.convert(this),r>1){var c=s();for(i.sqrTo(h[1],c);p<=f;)h[p]=s(),i.mulTo(c,h[p-2],h[p]),p+=2}var d,g,v=t.t-1,S=!0,b=s();for(n=l(t[v])-1;v>=0;){for(n>=a?d=t[v]>>n-a&f:(d=(t[v]&(1<<n+1)-1)<<a-n,v>0&&(d|=t[v-1]>>this.DB+n-a)),p=r;0==(1&d);)d>>=1,--p;if((n-=p)<0&&(n+=this.DB,--v),S)h[d].copyTo(o),S=!1;else{for(;p>1;)i.sqrTo(o,b),i.sqrTo(b,o),p-=2;p>0?i.sqrTo(o,b):(g=o,o=b,b=g),i.mulTo(b,h[d],o)}for(;v>=0&&0==(t[v]&1<<n);)i.sqrTo(o,b),g=o,o=b,b=g,--n<0&&(n=this.DB-1,--v)}return i.revert(o)},o.prototype.modInverse=function(t){var e=t.isEven();if(this.isEven()&&e||0===t.signum())return o.ZERO;for(var r=t.clone(),i=this.clone(),n=u(1),s=u(0),h=u(0),p=u(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),e?(n.isEven()&&s.isEven()||(n.addTo(this,n),s.subTo(t,s)),n.rShiftTo(1,n)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;i.isEven();)i.rShiftTo(1,i),e?(h.isEven()&&p.isEven()||(h.addTo(this,h),p.subTo(t,p)),h.rShiftTo(1,h)):p.isEven()||p.subTo(t,p),p.rShiftTo(1,p);r.compareTo(i)>=0?(r.subTo(i,r),e&&n.subTo(h,n),s.subTo(p,s)):(i.subTo(r,i),e&&h.subTo(n,h),p.subTo(s,p))}return 0!=i.compareTo(o.ONE)?o.ZERO:p.compareTo(t)>=0?p.subtract(t):p.signum()<0?(p.addTo(t,p),p.signum()<0?p.add(t):p):p},o.prototype.pow=function(t){return this.exp(t,new B)},o.prototype.gcd=function(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var i=e;e=r,r=i}var n=e.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return e;for(n<o&&(o=n),o>0&&(e.rShiftTo(o,e),r.rShiftTo(o,r));e.signum()>0;)(n=e.getLowestSetBit())>0&&e.rShiftTo(n,e),(n=r.getLowestSetBit())>0&&r.rShiftTo(n,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r},o.prototype.isProbablePrime=function(t){var e,r=this.abs();if(1==r.t&&r[0]<=D[D.length-1]){for(e=0;e<D.length;++e)if(r[0]==D[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<D.length;){for(var i=D[e],n=e+1;n<D.length&&i<k;)i*=D[n++];for(i=r.modInt(i);e<n;)if(i%D[e++]==0)return!1}return r.millerRabin(t)},o.int2char=f,o.ZERO=u(0),o.ONE=u(1),o.prototype.square=function(){var t=s();return this.squareTo(t),t},t.exports=o}).call(this,r("2cc2").Buffer)},"54a2":function(t,e,r){(function(e){var i=r("7aa4")._,n=r("7aa4"),o=r("3a6f");function s(t){const e=t.buf.readInt32BE(t.off);t.off+=4;const r=t.buf.slice(t.off,t.off+e);return t.off+=e,r}function h(t,e){t.buf.writeInt32BE(e.byteLength,t.off),t.off+=4,t.off+=e.copy(t.buf,t.off)}t.exports={privateExport:function(t,r){const i=t.n.toBuffer();let o=e.alloc(4);for(o.writeUInt32BE(t.e,0);0===o[0];)o=o.slice(1);const s=t.d.toBuffer(),p=t.coeff.toBuffer(),a=t.p.toBuffer(),f=t.q.toBuffer();let c;c=void 0!==t.sshcomment?e.from(t.sshcomment):e.from([]);const u=15+o.byteLength+4+i.byteLength,l=23+i.byteLength+4+o.byteLength+4+s.byteLength+4+p.byteLength+4+a.byteLength+4+f.byteLength+4+c.byteLength;let m=43+u+4+l;m+=8*Math.ceil(l/8)-l;const y=e.alloc(m),d={buf:y,off:0};y.write("openssh-key-v1","utf8"),y.writeUInt8(0,14),d.off+=15,h(d,e.from("none")),h(d,e.from("none")),h(d,e.from("")),d.off=d.buf.writeUInt32BE(1,d.off),d.off=d.buf.writeUInt32BE(u,d.off),h(d,e.from("ssh-rsa")),h(d,o),h(d,i),d.off=d.buf.writeUInt32BE(m-47-u,d.off),d.off+=8,h(d,e.from("ssh-rsa")),h(d,i),h(d,o),h(d,s),h(d,p),h(d,a),h(d,f),h(d,c);let g=1;for(;d.off<m;)d.off=d.buf.writeUInt8(g++,d.off);return"der"===r.type?d.buf:"-----BEGIN OPENSSH PRIVATE KEY-----\n"+n.linebrk(y.toString("base64"),70)+"\n-----END OPENSSH PRIVATE KEY-----\n"},privateImport:function(t,r,h){var p;if("der"!==(h=h||{}).type){if(e.isBuffer(r)&&(r=r.toString("utf8")),!i.isString(r))throw Error("Unsupported key format");var a=n.trimSurroundingText(r,"-----BEGIN OPENSSH PRIVATE KEY-----","-----END OPENSSH PRIVATE KEY-----").replace(/\s+|\n\r|\n|\r$/gm,"");p=e.from(a,"base64")}else{if(!e.isBuffer(r))throw Error("Unsupported key format");p=r}const f={buf:p,off:0};if("openssh-key-v1"!==p.slice(0,14).toString("ascii"))throw"Invalid file format.";if(f.off+=15,"none"!==s(f).toString("ascii"))throw Error("Unsupported key type");if("none"!==s(f).toString("ascii"))throw Error("Unsupported key type");if(""!==s(f).toString("ascii"))throw Error("Unsupported key type");if(f.off+=4,f.off+=4,"ssh-rsa"!==s(f).toString("ascii"))throw Error("Unsupported key type");if(s(f),s(f),f.off+=12,"ssh-rsa"!==s(f).toString("ascii"))throw Error("Unsupported key type");const c=s(f),u=s(f),l=s(f),m=s(f),y=s(f),d=s(f),g=new o(l),v=new o(d),S=new o(y),b=g.mod(S.subtract(o.ONE)),E=g.mod(v.subtract(o.ONE));t.setPrivate(c,u,l,y,d,b.toBuffer(),E.toBuffer(),m),t.sshcomment=s(f).toString("ascii")},publicExport:function(t,r){let i=e.alloc(4);for(i.writeUInt32BE(t.e,0);0===i[0];)i=i.slice(1);const n=t.n.toBuffer(),o=e.alloc(i.byteLength+4+n.byteLength+4+"ssh-rsa".length+4),s={buf:o,off:0};h(s,e.from("ssh-rsa")),h(s,i),h(s,n);let p=t.sshcomment||"";return"der"===r.type?s.buf:"ssh-rsa "+o.toString("base64")+" "+p+"\n"},publicImport:function(t,r,n){var o;if("der"!==(n=n||{}).type){if(e.isBuffer(r)&&(r=r.toString("utf8")),!i.isString(r))throw Error("Unsupported key format");{if("ssh-rsa "!==r.substring(0,8))throw Error("Unsupported key format");let i=r.indexOf(" ",8);-1===i?i=r.length:t.sshcomment=r.substring(i+1).replace(/\s+|\n\r|\n|\r$/gm,"");const n=r.substring(8,i).replace(/\s+|\n\r|\n|\r$/gm,"");o=e.from(n,"base64")}}else{if(!e.isBuffer(r))throw Error("Unsupported key format");o=r}const h={buf:o,off:0},p=s(h).toString("ascii");if("ssh-rsa"!==p)throw Error("Invalid key type: "+p);const a=s(h),f=s(h);t.setPublic(f,a)},autoImport:function(e,r){return/^[\S\s]*-----BEGIN OPENSSH PRIVATE KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END OPENSSH PRIVATE KEY-----[\S\s]*$/g.test(r)?(t.exports.privateImport(e,r),!0):!!/^[\S\s]*ssh-rsa \s*(?=(([A-Za-z0-9+/=]+\s*)+))\1[\S\s]*$/g.test(r)&&(t.exports.publicImport(e,r),!0)}}}).call(this,r("2cc2").Buffer)},"70fb":function(t,e,r){(function(e){var i=r("74ea").Ber,n=r("7aa4")._,o=r("7aa4");t.exports={privateExport:function(t,e){e=e||{};var r=t.n.toBuffer(),n=t.d.toBuffer(),s=t.p.toBuffer(),h=t.q.toBuffer(),p=t.dmp1.toBuffer(),a=t.dmq1.toBuffer(),f=t.coeff.toBuffer(),c=r.length+n.length+s.length+h.length+p.length+a.length+f.length+512,u=new i.Writer({size:c});return u.startSequence(),u.writeInt(0),u.writeBuffer(r,2),u.writeInt(t.e),u.writeBuffer(n,2),u.writeBuffer(s,2),u.writeBuffer(h,2),u.writeBuffer(p,2),u.writeBuffer(a,2),u.writeBuffer(f,2),u.endSequence(),"der"===e.type?u.buffer:"-----BEGIN RSA PRIVATE KEY-----\n"+o.linebrk(u.buffer.toString("base64"),64)+"\n-----END RSA PRIVATE KEY-----"},privateImport:function(t,r,s){var h;if("der"!==(s=s||{}).type){if(e.isBuffer(r)&&(r=r.toString("utf8")),!n.isString(r))throw Error("Unsupported key format");var p=o.trimSurroundingText(r,"-----BEGIN RSA PRIVATE KEY-----","-----END RSA PRIVATE KEY-----").replace(/\s+|\n\r|\n|\r$/gm,"");h=e.from(p,"base64")}else{if(!e.isBuffer(r))throw Error("Unsupported key format");h=r}var a=new i.Reader(h);a.readSequence(),a.readString(2,!0),t.setPrivate(a.readString(2,!0),a.readString(2,!0),a.readString(2,!0),a.readString(2,!0),a.readString(2,!0),a.readString(2,!0),a.readString(2,!0),a.readString(2,!0))},publicExport:function(t,e){e=e||{};var r=t.n.toBuffer(),n=r.length+512,s=new i.Writer({size:n});return s.startSequence(),s.writeBuffer(r,2),s.writeInt(t.e),s.endSequence(),"der"===e.type?s.buffer:"-----BEGIN RSA PUBLIC KEY-----\n"+o.linebrk(s.buffer.toString("base64"),64)+"\n-----END RSA PUBLIC KEY-----"},publicImport:function(t,r,s){var h;if("der"!==(s=s||{}).type){if(e.isBuffer(r)&&(r=r.toString("utf8")),n.isString(r)){var p=o.trimSurroundingText(r,"-----BEGIN RSA PUBLIC KEY-----","-----END RSA PUBLIC KEY-----").replace(/\s+|\n\r|\n|\r$/gm,"");h=e.from(p,"base64")}}else{if(!e.isBuffer(r))throw Error("Unsupported key format");h=r}var a=new i.Reader(h);a.readSequence(),t.setPublic(a.readString(2,!0),a.readString(2,!0))},autoImport:function(e,r){return/^[\S\s]*-----BEGIN RSA PRIVATE KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END RSA PRIVATE KEY-----[\S\s]*$/g.test(r)?(t.exports.privateImport(e,r),!0):!!/^[\S\s]*-----BEGIN RSA PUBLIC KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END RSA PUBLIC KEY-----[\S\s]*$/g.test(r)&&(t.exports.publicImport(e,r),!0)}}}).call(this,r("2cc2").Buffer)},"74e4":function(t,e,r){r("7aa4")._;function i(t){t=t.split("-");for(var e="private",r={type:"default"},i=1;i<t.length;i++)if(t[i])switch(t[i]){case"public":case"private":e=t[i];break;case"pem":case"der":r.type=t[i]}return{scheme:t[0],keyType:e,keyOpt:r}}t.exports={pkcs1:r("70fb"),pkcs8:r("0dce"),components:r("2556"),openssh:r("54a2"),isPrivateExport:function(e){return t.exports[e]&&"function"==typeof t.exports[e].privateExport},isPrivateImport:function(e){return t.exports[e]&&"function"==typeof t.exports[e].privateImport},isPublicExport:function(e){return t.exports[e]&&"function"==typeof t.exports[e].publicExport},isPublicImport:function(e){return t.exports[e]&&"function"==typeof t.exports[e].publicImport},detectAndImport:function(e,r,n){if(void 0===n){for(var o in t.exports)if("function"==typeof t.exports[o].autoImport&&t.exports[o].autoImport(e,r))return!0}else if(n){var s=i(n);if(!t.exports[s.scheme])throw Error("Unsupported key format");"private"===s.keyType?t.exports[s.scheme].privateImport(e,r,s.keyOpt):t.exports[s.scheme].publicImport(e,r,s.keyOpt)}return!1},detectAndExport:function(e,r){if(r){var n=i(r);if(t.exports[n.scheme]){if("private"===n.keyType){if(!e.isPrivate())throw Error("This is not private key");return t.exports[n.scheme].privateExport(e,n.keyOpt)}if(!e.isPublic())throw Error("This is not public key");return t.exports[n.scheme].publicExport(e,n.keyOpt)}throw Error("Unsupported key format")}}}},"75e3":function(t,e,r){(function(i){var n=r("7aa4")._,o=(r("0b00"),r("3a6f")),s=r("7aa4"),h=r("f286"),p=r("deaf");e.BigInteger=o,t.exports.Key=function(){function t(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}return t.prototype.setOptions=function(t){var e=h[t.signingScheme],r=h[t.encryptionScheme];e===r?this.signingScheme=this.encryptionScheme=r.makeScheme(this,t):(this.encryptionScheme=r.makeScheme(this,t),this.signingScheme=e.makeScheme(this,t)),this.encryptEngine=p.getEngine(this,t)},t.prototype.generate=function(t,e){var r=t>>1;this.e=parseInt(e,16);for(var i=new o(e,16);;){for(;this.p=new o(t-r,1),0!==this.p.subtract(o.ONE).gcd(i).compareTo(o.ONE)||!this.p.isProbablePrime(10););for(;this.q=new o(r,1),0!==this.q.subtract(o.ONE).gcd(i).compareTo(o.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var n=this.p;this.p=this.q,this.q=n}var s=this.p.subtract(o.ONE),h=this.q.subtract(o.ONE),p=s.multiply(h);if(0===p.gcd(i).compareTo(o.ONE)){if(this.n=this.p.multiply(this.q),this.n.bitLength()<t)continue;this.d=i.modInverse(p),this.dmp1=this.d.mod(s),this.dmq1=this.d.mod(h),this.coeff=this.q.modInverse(this.p);break}}this.$$recalculateCache()},t.prototype.setPrivate=function(t,e,r,i,h,p,a,f){if(!(t&&e&&r&&t.length>0&&(n.isNumber(e)||e.length>0)&&r.length>0))throw Error("Invalid RSA private key");this.n=new o(t),this.e=n.isNumber(e)?e:s.get32IntFromBuffer(e,0),this.d=new o(r),i&&h&&p&&a&&f&&(this.p=new o(i),this.q=new o(h),this.dmp1=new o(p),this.dmq1=new o(a),this.coeff=new o(f)),this.$$recalculateCache()},t.prototype.setPublic=function(t,e){if(!(t&&e&&t.length>0&&(n.isNumber(e)||e.length>0)))throw Error("Invalid RSA public key");this.n=new o(t),this.e=n.isNumber(e)?e:s.get32IntFromBuffer(e,0),this.$$recalculateCache()},t.prototype.$doPrivate=function(t){if(this.p||this.q)return t.modPow(this.d,this.n);for(var e=t.mod(this.p).modPow(this.dmp1,this.p),r=t.mod(this.q).modPow(this.dmq1,this.q);e.compareTo(r)<0;)e=e.add(this.p);return e.subtract(r).multiply(this.coeff).mod(this.p).multiply(this.q).add(r)},t.prototype.$doPublic=function(t){return t.modPowInt(this.e,this.n)},t.prototype.encrypt=function(t,e){var r=[],n=[],o=t.length,s=Math.ceil(o/this.maxMessageLength)||1,h=Math.ceil(o/s||1);if(1==s)r.push(t);else for(var p=0;p<s;p++)r.push(t.slice(p*h,(p+1)*h));for(var a=0;a<r.length;a++)n.push(this.encryptEngine.encrypt(r[a],e));return i.concat(n)},t.prototype.decrypt=function(t,e){if(t.length%this.encryptedDataLength>0)throw Error("Incorrect data or key");for(var r=[],n=0,o=0,s=t.length/this.encryptedDataLength,h=0;h<s;h++)o=(n=h*this.encryptedDataLength)+this.encryptedDataLength,r.push(this.encryptEngine.decrypt(t.slice(n,Math.min(o,t.length)),e));return i.concat(r)},t.prototype.sign=function(t){return this.signingScheme.sign.apply(this.signingScheme,arguments)},t.prototype.verify=function(t,e,r){return this.signingScheme.verify.apply(this.signingScheme,arguments)},t.prototype.isPrivate=function(){return!!(this.n&&this.e&&this.d)},t.prototype.isPublic=function(t){return this.n&&this.e&&!(t&&this.d)||!1},Object.defineProperty(t.prototype,"keySize",{get:function(){return this.cache.keyBitLength}}),Object.defineProperty(t.prototype,"encryptedDataLength",{get:function(){return this.cache.keyByteLength}}),Object.defineProperty(t.prototype,"maxMessageLength",{get:function(){return this.encryptionScheme.maxMessageLength()}}),t.prototype.$$recalculateCache=function(){this.cache=this.cache||{},this.cache.keyBitLength=this.n.bitLength(),this.cache.keyByteLength=this.cache.keyBitLength+6>>3},t}()}).call(this,r("2cc2").Buffer)},"7aa4":function(t,e,r){(function(e){r("0b00");t.exports.linebrk=function(t,e){for(var r="",i=0;i+e<t.length;)r+=t.substring(i,i+e)+"\n",i+=e;return r+t.substring(i,t.length)},t.exports.detectEnvironment=function(){return"undefined"==typeof window||!window||e&&"node"===e.title?"node":"browser"},t.exports.get32IntFromBuffer=function(t,e){e=e||0;var r;if((r=t.length-e)>0){if(r>=4)return t.readUIntBE(e,r);for(var i=0,n=e+r,o=0;n>e;n--,o+=2)i+=t[n-1]*Math.pow(16,o);return i}return NaN},t.exports._={isObject:function(t){var e=typeof t;return!!t&&("object"==e||"function"==e)},isString:function(t){return"string"==typeof t||t instanceof String},isNumber:function(t){return"number"==typeof t||!isNaN(parseFloat(t))&&isFinite(t)},omit:function(t,e){var r={};for(var i in t)t.hasOwnProperty(i)&&i!==e&&(r[i]=t[i]);return r}},t.exports.trimSurroundingText=function(t,e,r){var i=0,n=t.length,o=t.indexOf(e);o>=0&&(i=o+e.length);var s=t.indexOf(r,o);return s>=0&&(n=s),t.substring(i,n)}}).call(this,r("ec9d"))},"8edd":function(t,e,r){(function(e){var i=r("3a6f"),n=r("0b00");t.exports={isEncryption:!1,isSignature:!0};t.exports.makeScheme=function(t,o){var s=r("f286").pkcs1_oaep;function h(t,e){this.key=t,this.options=e}return h.prototype.sign=function(t){var e=n.createHash(this.options.signingSchemeOptions.hash||"sha1");e.update(t);var r=this.emsa_pss_encode(e.digest(),this.key.keySize-1);return this.key.$doPrivate(new i(r)).toBuffer(this.key.encryptedDataLength)},h.prototype.verify=function(t,r,o){o&&(r=e.from(r,o)),r=new i(r);var s=Math.ceil((this.key.keySize-1)/8),h=this.key.$doPublic(r).toBuffer(s),p=n.createHash(this.options.signingSchemeOptions.hash||"sha1");return p.update(t),this.emsa_pss_verify(p.digest(),h,this.key.keySize-1)},h.prototype.emsa_pss_encode=function(t,r){var i=this.options.signingSchemeOptions.hash||"sha1",o=this.options.signingSchemeOptions.mgf||s.eme_oaep_mgf1,h=this.options.signingSchemeOptions.saltLength||20,p=s.digestLength[i],a=Math.ceil(r/8);if(a<p+h+2)throw new Error("Output length passed to emBits("+r+") is too small for the options specified("+i+", "+h+"). To fix this issue increase the value of emBits. (minimum size: "+(8*p+8*h+9)+")");var f=n.randomBytes(h),c=e.alloc(8+p+h);c.fill(0,0,8),t.copy(c,8),f.copy(c,8+t.length);var u=n.createHash(i);u.update(c),u=u.digest();var l=e.alloc(a-f.length-p-2);l.fill(0);var m=e.alloc(l.length+1+f.length);l.copy(m),m[l.length]=1,f.copy(m,l.length+1);for(var y=o(u,m.length,i),d=e.alloc(m.length),g=0;g<y.length;g++)d[g]=m[g]^y[g];var v=8*a-r,S=255^255>>8-v<<8-v;d[0]=d[0]&S;var b=e.alloc(d.length+u.length+1);return d.copy(b,0),u.copy(b,d.length),b[b.length-1]=188,b},h.prototype.emsa_pss_verify=function(t,r,i){var o=this.options.signingSchemeOptions.hash||"sha1",h=this.options.signingSchemeOptions.mgf||s.eme_oaep_mgf1,p=this.options.signingSchemeOptions.saltLength||20,a=s.digestLength[o],f=Math.ceil(i/8);if(f<a+p+2||188!=r[r.length-1])return!1;var c=e.alloc(f-a-1);r.copy(c,0,0,f-a-1);for(var u=0,l=0,m=8*f-i;l<m;l++)u|=1<<7-l;if(0!=(c[0]&u))return!1;var y=r.slice(f-a-1,f-1),d=h(y,c.length,o);for(l=0;l<c.length;l++)c[l]^=d[l];for(u=255^255>>8-(m=8*f-i)<<8-m,c[0]=c[0]&u,l=0;0===c[l]&&l<c.length;l++);if(1!=c[l])return!1;var g=c.slice(c.length-p),v=e.alloc(8+a+p);v.fill(0,0,8),t.copy(v,8),g.copy(v,8+t.length);var S=n.createHash(o);return S.update(v),S=S.digest(),y.toString("hex")===S.toString("hex")},new h(t,o)}}).call(this,r("2cc2").Buffer)},"9a73":function(t,e,r){(function(e){var i=r("3a6f"),n=r("0b00"),o=r("227a"),s={md2:e.from("3020300c06082a864886f70d020205000410","hex"),md5:e.from("3020300c06082a864886f70d020505000410","hex"),sha1:e.from("3021300906052b0e03021a05000414","hex"),sha224:e.from("302d300d06096086480165030402040500041c","hex"),sha256:e.from("3031300d060960864801650304020105000420","hex"),sha384:e.from("3041300d060960864801650304020205000430","hex"),sha512:e.from("3051300d060960864801650304020305000440","hex"),ripemd160:e.from("3021300906052b2403020105000414","hex"),rmd160:e.from("3021300906052b2403020105000414","hex")},h={ripemd160:"rmd160"};t.exports={isEncryption:!0,isSignature:!0},t.exports.makeScheme=function(t,r){function p(t,e){this.key=t,this.options=e}return p.prototype.maxMessageLength=function(){return this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==o.RSA_NO_PADDING?this.key.encryptedDataLength:this.key.encryptedDataLength-11},p.prototype.encPad=function(t,r){var i;if(r=r||{},t.length>this.key.maxMessageLength)throw new Error("Message too long for RSA (n="+this.key.encryptedDataLength+", l="+t.length+")");if(this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==o.RSA_NO_PADDING)return(i=e.alloc(this.key.maxMessageLength-t.length)).fill(0),e.concat([i,t]);if(1===r.type)return(i=e.alloc(this.key.encryptedDataLength-t.length-1)).fill(255,0,i.length-1),i[0]=1,i[i.length-1]=0,e.concat([i,t]);(i=e.alloc(this.key.encryptedDataLength-t.length))[0]=0,i[1]=2;for(var s=n.randomBytes(i.length-3),h=0;h<s.length;h++){for(var p=s[h];0===p;)p=n.randomBytes(1)[0];i[h+2]=p}return i[i.length-1]=0,e.concat([i,t])},p.prototype.encUnPad=function(t,e){e=e||{};var r=0;if(this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==o.RSA_NO_PADDING)return"function"==typeof t.lastIndexOf?t.slice(t.lastIndexOf("\0")+1,t.length):t.slice(String.prototype.lastIndexOf.call(t,"\0")+1,t.length);if(t.length<4)return null;if(1===e.type){if(0!==t[0]||1!==t[1])return null;for(r=3;0!==t[r];)if(255!=t[r]||++r>=t.length)return null}else{if(0!==t[0]||2!==t[1])return null;for(r=3;0!==t[r];)if(++r>=t.length)return null}return t.slice(r+1,t.length)},p.prototype.sign=function(t){var e=this.options.signingSchemeOptions.hash||"sha256";if("browser"===this.options.environment){e=h[e]||e;var r=n.createHash(e);r.update(t);var o=this.pkcs1pad(r.digest(),e);return this.key.$doPrivate(new i(o)).toBuffer(this.key.encryptedDataLength)}var s=n.createSign("RSA-"+e.toUpperCase());return s.update(t),s.sign(this.options.rsaUtils.exportKey("private"))},p.prototype.verify=function(t,r,s){if(this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==o.RSA_NO_PADDING)return!1;var p=this.options.signingSchemeOptions.hash||"sha256";if("browser"===this.options.environment){p=h[p]||p,s&&(r=e.from(r,s));var a=n.createHash(p);a.update(t);var f=this.pkcs1pad(a.digest(),p);return this.key.$doPublic(new i(r)).toBuffer().toString("hex")==f.toString("hex")}var c=n.createVerify("RSA-"+p.toUpperCase());return c.update(t),c.verify(this.options.rsaUtils.exportKey("public"),r,s)},p.prototype.pkcs0pad=function(t){var r=e.alloc(this.key.maxMessageLength-t.length);return r.fill(0),e.concat([r,t])},p.prototype.pkcs0unpad=function(t){return"function"==typeof t.lastIndexOf?t.slice(t.lastIndexOf("\0")+1,t.length):t.slice(String.prototype.lastIndexOf.call(t,"\0")+1,t.length)},p.prototype.pkcs1pad=function(t,r){var i=s[r];if(!i)throw Error("Unsupported hash algorithm");var n=e.concat([i,t]);if(n.length+10>this.key.encryptedDataLength)throw Error("Key is too short for signing algorithm ("+r+")");var o=e.alloc(this.key.encryptedDataLength-n.length-1);return o.fill(255,0,o.length-1),o[0]=1,o[o.length-1]=0,e.concat([o,n])},new p(t,r)}}).call(this,r("2cc2").Buffer)},a74d:function(t,e,r){var i=r("0b00"),n=r("227a"),o=r("f286");t.exports=function(t,e){var s=r("2172")(t,e),h=o.pkcs1.makeScheme(t,e);return{encrypt:function(t,r){if(r)return s.encrypt(t,r);var o=n.RSA_PKCS1_OAEP_PADDING;"pkcs1"===e.encryptionScheme&&(o=n.RSA_PKCS1_PADDING),e.encryptionSchemeOptions&&e.encryptionSchemeOptions.padding&&(o=e.encryptionSchemeOptions.padding);var p=t;return o===n.RSA_NO_PADDING&&(p=h.pkcs0pad(t)),i.publicEncrypt({key:e.rsaUtils.exportKey("public"),padding:o},p)},decrypt:function(t,r){if(r)return s.decrypt(t,r);var o=n.RSA_PKCS1_OAEP_PADDING;"pkcs1"===e.encryptionScheme&&(o=n.RSA_PKCS1_PADDING),e.encryptionSchemeOptions&&e.encryptionSchemeOptions.padding&&(o=e.encryptionSchemeOptions.padding);var p=i.privateDecrypt({key:e.rsaUtils.exportKey("private"),padding:o},t);return o===n.RSA_NO_PADDING?h.pkcs0unpad(p):p}}}},c40d:function(t,e,r){(function(e){
/*!
 * RSA library for Node.js
 *
 * Author: rzcoder
 * License MIT
 */
var i=r("227a"),n=r("75e3"),o=(r("0b00"),r("74ea").Ber,r("7aa4")._),s=r("7aa4"),h=r("f286"),p=r("74e4");void 0===i.RSA_NO_PADDING&&(i.RSA_NO_PADDING=3),t.exports=function(){var t={node10:["md4","md5","ripemd160","sha1","sha224","sha256","sha384","sha512"],node:["md4","md5","ripemd160","sha1","sha224","sha256","sha384","sha512"],iojs:["md4","md5","ripemd160","sha1","sha224","sha256","sha384","sha512"],browser:["md5","ripemd160","sha1","sha256","sha512"]},r={private:"pkcs1-private-pem","private-der":"pkcs1-private-der",public:"pkcs8-public-pem","public-der":"pkcs8-public-der"};function i(t,r,h){if(!(this instanceof i))return new i(t,r,h);o.isObject(r)&&(h=r,r=void 0),this.$options={signingScheme:"pkcs1",signingSchemeOptions:{hash:"sha256",saltLength:null},encryptionScheme:"pkcs1_oaep",encryptionSchemeOptions:{hash:"sha1",label:null},environment:s.detectEnvironment(),rsaUtils:this},this.keyPair=new n.Key,this.$cache={},e.isBuffer(t)||o.isString(t)?this.importKey(t,r):o.isObject(t)&&this.generateKeyPair(t.b,t.e),this.setOptions(h)}return i.prototype.setOptions=function(e){if((e=e||{}).environment&&(this.$options.environment=e.environment),e.signingScheme){if(o.isString(e.signingScheme)){var r=e.signingScheme.toLowerCase().split("-");1==r.length?t.node.indexOf(r[0])>-1?(this.$options.signingSchemeOptions={hash:r[0]},this.$options.signingScheme="pkcs1"):(this.$options.signingScheme=r[0],this.$options.signingSchemeOptions={hash:null}):(this.$options.signingSchemeOptions={hash:r[1]},this.$options.signingScheme=r[0])}else o.isObject(e.signingScheme)&&(this.$options.signingScheme=e.signingScheme.scheme||"pkcs1",this.$options.signingSchemeOptions=o.omit(e.signingScheme,"scheme"));if(!h.isSignature(this.$options.signingScheme))throw Error("Unsupported signing scheme");if(this.$options.signingSchemeOptions.hash&&-1===t[this.$options.environment].indexOf(this.$options.signingSchemeOptions.hash))throw Error("Unsupported hashing algorithm for "+this.$options.environment+" environment")}if(e.encryptionScheme){if(o.isString(e.encryptionScheme)?(this.$options.encryptionScheme=e.encryptionScheme.toLowerCase(),this.$options.encryptionSchemeOptions={}):o.isObject(e.encryptionScheme)&&(this.$options.encryptionScheme=e.encryptionScheme.scheme||"pkcs1_oaep",this.$options.encryptionSchemeOptions=o.omit(e.encryptionScheme,"scheme")),!h.isEncryption(this.$options.encryptionScheme))throw Error("Unsupported encryption scheme");if(this.$options.encryptionSchemeOptions.hash&&-1===t[this.$options.environment].indexOf(this.$options.encryptionSchemeOptions.hash))throw Error("Unsupported hashing algorithm for "+this.$options.environment+" environment")}this.keyPair.setOptions(this.$options)},i.prototype.generateKeyPair=function(t,e){if(e=e||65537,(t=t||2048)%8!=0)throw Error("Key size must be a multiple of 8.");return this.keyPair.generate(t,e.toString(16)),this.$cache={},this},i.prototype.importKey=function(t,e){if(!t)throw Error("Empty key given");if(e&&(e=r[e]||e),!p.detectAndImport(this.keyPair,t,e)&&void 0===e)throw Error("Key format must be specified");return this.$cache={},this},i.prototype.exportKey=function(t){return t=r[t=t||"private"]||t,this.$cache[t]||(this.$cache[t]=p.detectAndExport(this.keyPair,t)),this.$cache[t]},i.prototype.isPrivate=function(){return this.keyPair.isPrivate()},i.prototype.isPublic=function(t){return this.keyPair.isPublic(t)},i.prototype.isEmpty=function(t){return!(this.keyPair.n||this.keyPair.e||this.keyPair.d)},i.prototype.encrypt=function(t,e,r){return this.$$encryptKey(!1,t,e,r)},i.prototype.decrypt=function(t,e){return this.$$decryptKey(!1,t,e)},i.prototype.encryptPrivate=function(t,e,r){return this.$$encryptKey(!0,t,e,r)},i.prototype.decryptPublic=function(t,e){return this.$$decryptKey(!0,t,e)},i.prototype.$$encryptKey=function(t,e,r,i){try{var n=this.keyPair.encrypt(this.$getDataForEncrypt(e,i),t);return"buffer"!=r&&r?n.toString(r):n}catch(t){throw Error("Error during encryption. Original error: "+t)}},i.prototype.$$decryptKey=function(t,r,i){try{r=o.isString(r)?e.from(r,"base64"):r;var n=this.keyPair.decrypt(r,t);if(null===n)throw Error("Key decrypt method returns null.");return this.$getDecryptedData(n,i)}catch(t){throw Error("Error during decryption (probably incorrect key). Original error: "+t)}},i.prototype.sign=function(t,e,r){if(!this.isPrivate())throw Error("This is not private key");var i=this.keyPair.sign(this.$getDataForEncrypt(t,r));return e&&"buffer"!=e&&(i=i.toString(e)),i},i.prototype.verify=function(t,e,r,i){if(!this.isPublic())throw Error("This is not public key");return i=i&&"buffer"!=i?i:null,this.keyPair.verify(this.$getDataForEncrypt(t,r),e,i)},i.prototype.getKeySize=function(){return this.keyPair.keySize},i.prototype.getMaxMessageSize=function(){return this.keyPair.maxMessageLength},i.prototype.$getDataForEncrypt=function(t,r){if(o.isString(t)||o.isNumber(t))return e.from(""+t,r||"utf8");if(e.isBuffer(t))return t;if(o.isObject(t))return e.from(JSON.stringify(t));throw Error("Unexpected data type")},i.prototype.$getDecryptedData=function(t,e){return"buffer"==(e=e||"buffer")?t:"json"==e?JSON.parse(t.toString()):t.toString(e)},i}()}).call(this,r("2cc2").Buffer)},deaf:function(t,e,r){var i=r("0b00");t.exports={getEngine:function(t,e){var n=r("2172");return"node"===e.environment&&"function"==typeof i.publicEncrypt&&"function"==typeof i.privateDecrypt&&(n="function"==typeof i.privateEncrypt&&"function"==typeof i.publicDecrypt?r("1651"):r("a74d")),n(t,e)}}},f286:function(t,e,r){t.exports={pkcs1:r("9a73"),pkcs1_oaep:r("0885"),pss:r("8edd"),isEncryption:function(e){return t.exports[e]&&t.exports[e].isEncryption},isSignature:function(e){return t.exports[e]&&t.exports[e].isSignature}}}}]);