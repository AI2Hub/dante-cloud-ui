!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue"),require("tslib"),require("vue-property-decorator"),require("bpmn-js/lib/Modeler"),require("bpmn-js-properties-panel"),require("bpmn-js-properties-panel/lib/provider/camunda"),require("@hecate/h-button"),require("@hecate/utils"),require("vue-runtime-helpers/dist/normalize-component.mjs")):"function"==typeof define&&define.amd?define(["exports","vue","tslib","vue-property-decorator","bpmn-js/lib/Modeler","bpmn-js-properties-panel","bpmn-js-properties-panel/lib/provider/camunda","@hecate/h-button","@hecate/utils","vue-runtime-helpers/dist/normalize-component.mjs"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).main={},e.Vue,e.tslib,e.vuePropertyDecorator,e.BpmnModeler,e.PropertiesPanelModule,e.PropertiesProviderModule,e.HButton,e.utils,e.__vue_normalize__)}(this,(function(e,t,n,a,i,r,o,s,p,l){"use strict";function m(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var d=m(i),c=m(r),u=m(o),y=m(s),g=m(l),v={name:"Camunda",uri:"http://camunda.org/schema/1.0/bpmn",prefix:"camunda",xml:{tagAlias:"lowerCase"},associations:[],types:[{name:"Definitions",isAbstract:!0,extends:["bpmn:Definitions"],properties:[{name:"diagramRelationId",isAttr:!0,type:"String"}]},{name:"InOutBinding",superClass:["Element"],isAbstract:!0,properties:[{name:"source",isAttr:!0,type:"String"},{name:"sourceExpression",isAttr:!0,type:"String"},{name:"target",isAttr:!0,type:"String"},{name:"businessKey",isAttr:!0,type:"String"},{name:"local",isAttr:!0,type:"Boolean",default:!1},{name:"variables",isAttr:!0,type:"String"}]},{name:"In",superClass:["InOutBinding"],meta:{allowedIn:["bpmn:CallActivity","bpmn:SignalEventDefinition"]}},{name:"Out",superClass:["InOutBinding"],meta:{allowedIn:["bpmn:CallActivity"]}},{name:"AsyncCapable",isAbstract:!0,extends:["bpmn:Activity","bpmn:Gateway","bpmn:Event"],properties:[{name:"async",isAttr:!0,type:"Boolean",default:!1},{name:"asyncBefore",isAttr:!0,type:"Boolean",default:!1},{name:"asyncAfter",isAttr:!0,type:"Boolean",default:!1},{name:"exclusive",isAttr:!0,type:"Boolean",default:!0}]},{name:"JobPriorized",isAbstract:!0,extends:["bpmn:Process","camunda:AsyncCapable"],properties:[{name:"jobPriority",isAttr:!0,type:"String"}]},{name:"SignalEventDefinitionExtension",isAbstract:!0,extends:["bpmn:SignalEventDefinition"],properties:[{name:"async",isAttr:!0,type:"Boolean",default:!1}]},{name:"ErrorEventDefinitionExtension",isAbstract:!0,extends:["bpmn:ErrorEventDefinition"],properties:[{name:"errorCodeVariable",isAttr:!0,type:"String"},{name:"errorMessageVariable",isAttr:!0,type:"String"}]},{name:"ErrorEventDefinition",superClass:["bpmn:ErrorEventDefinition","Element"],properties:[{name:"expression",isAttr:!0,type:"String"}],meta:{allowedIn:["bpmn:ServiceTask"]}},{name:"Error",isAbstract:!0,extends:["bpmn:Error"],properties:[{name:"camunda:errorMessage",isAttr:!0,type:"String"}]},{name:"PotentialStarter",superClass:["Element"],properties:[{name:"resourceAssignmentExpression",type:"bpmn:ResourceAssignmentExpression"}]},{name:"FormSupported",isAbstract:!0,extends:["bpmn:StartEvent","bpmn:UserTask"],properties:[{name:"formHandlerClass",isAttr:!0,type:"String"},{name:"formKey",isAttr:!0,type:"String"},{name:"formRef",isAttr:!0,type:"String"},{name:"formRefBinding",isAttr:!0,type:"String"},{name:"formRefVersion",isAttr:!0,type:"String"}]},{name:"TemplateSupported",isAbstract:!0,extends:["bpmn:Collaboration","bpmn:Process","bpmn:FlowElement"],properties:[{name:"modelerTemplate",isAttr:!0,type:"String"},{name:"modelerTemplateVersion",isAttr:!0,type:"Integer"}]},{name:"Initiator",isAbstract:!0,extends:["bpmn:StartEvent"],properties:[{name:"initiator",isAttr:!0,type:"String"}]},{name:"ScriptTask",isAbstract:!0,extends:["bpmn:ScriptTask"],properties:[{name:"resultVariable",isAttr:!0,type:"String"},{name:"resource",isAttr:!0,type:"String"}]},{name:"Process",isAbstract:!0,extends:["bpmn:Process"],properties:[{name:"candidateStarterGroups",isAttr:!0,type:"String"},{name:"candidateStarterUsers",isAttr:!0,type:"String"},{name:"versionTag",isAttr:!0,type:"String"},{name:"historyTimeToLive",isAttr:!0,type:"String"},{name:"isStartableInTasklist",isAttr:!0,type:"Boolean",default:!0}]},{name:"EscalationEventDefinitionExtension",isAbstract:!0,extends:["bpmn:EscalationEventDefinition"],properties:[{name:"escalationCodeVariable",isAttr:!0,type:"String"}]},{name:"FormalExpression",isAbstract:!0,extends:["bpmn:FormalExpression"],properties:[{name:"resource",isAttr:!0,type:"String"}]},{name:"Assignable",extends:["bpmn:UserTask"],properties:[{name:"assignee",isAttr:!0,type:"String"},{name:"candidateUsers",isAttr:!0,type:"String"},{name:"candidateGroups",isAttr:!0,type:"String"},{name:"dueDate",isAttr:!0,type:"String"},{name:"followUpDate",isAttr:!0,type:"String"},{name:"priority",isAttr:!0,type:"String"}]},{name:"CallActivity",extends:["bpmn:CallActivity"],properties:[{name:"calledElementBinding",isAttr:!0,type:"String",default:"latest"},{name:"calledElementVersion",isAttr:!0,type:"String"},{name:"calledElementVersionTag",isAttr:!0,type:"String"},{name:"calledElementTenantId",isAttr:!0,type:"String"},{name:"caseRef",isAttr:!0,type:"String"},{name:"caseBinding",isAttr:!0,type:"String",default:"latest"},{name:"caseVersion",isAttr:!0,type:"String"},{name:"caseTenantId",isAttr:!0,type:"String"},{name:"variableMappingClass",isAttr:!0,type:"String"},{name:"variableMappingDelegateExpression",isAttr:!0,type:"String"}]},{name:"ServiceTaskLike",extends:["bpmn:ServiceTask","bpmn:BusinessRuleTask","bpmn:SendTask","bpmn:MessageEventDefinition"],properties:[{name:"expression",isAttr:!0,type:"String"},{name:"class",isAttr:!0,type:"String"},{name:"delegateExpression",isAttr:!0,type:"String"},{name:"resultVariable",isAttr:!0,type:"String"}]},{name:"DmnCapable",extends:["bpmn:BusinessRuleTask"],properties:[{name:"decisionRef",isAttr:!0,type:"String"},{name:"decisionRefBinding",isAttr:!0,type:"String",default:"latest"},{name:"decisionRefVersion",isAttr:!0,type:"String"},{name:"mapDecisionResult",isAttr:!0,type:"String",default:"resultList"},{name:"decisionRefTenantId",isAttr:!0,type:"String"}]},{name:"ExternalCapable",extends:["camunda:ServiceTaskLike"],properties:[{name:"type",isAttr:!0,type:"String"},{name:"topic",isAttr:!0,type:"String"}]},{name:"TaskPriorized",extends:["bpmn:Process","camunda:ExternalCapable"],properties:[{name:"taskPriority",isAttr:!0,type:"String"}]},{name:"Properties",superClass:["Element"],meta:{allowedIn:["*"]},properties:[{name:"values",type:"Property",isMany:!0}]},{name:"Property",superClass:["Element"],properties:[{name:"id",type:"String",isAttr:!0},{name:"name",type:"String",isAttr:!0},{name:"value",type:"String",isAttr:!0}]},{name:"Connector",superClass:["Element"],meta:{allowedIn:["camunda:ServiceTaskLike"]},properties:[{name:"inputOutput",type:"InputOutput"},{name:"connectorId",type:"String"}]},{name:"InputOutput",superClass:["Element"],meta:{allowedIn:["bpmn:FlowNode","camunda:Connector"]},properties:[{name:"inputOutput",type:"InputOutput"},{name:"connectorId",type:"String"},{name:"inputParameters",isMany:!0,type:"InputParameter"},{name:"outputParameters",isMany:!0,type:"OutputParameter"}]},{name:"InputOutputParameter",properties:[{name:"name",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"},{name:"definition",type:"InputOutputParameterDefinition"}]},{name:"InputOutputParameterDefinition",isAbstract:!0},{name:"List",superClass:["InputOutputParameterDefinition"],properties:[{name:"items",isMany:!0,type:"InputOutputParameterDefinition"}]},{name:"Map",superClass:["InputOutputParameterDefinition"],properties:[{name:"entries",isMany:!0,type:"Entry"}]},{name:"Entry",properties:[{name:"key",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"},{name:"definition",type:"InputOutputParameterDefinition"}]},{name:"Value",superClass:["InputOutputParameterDefinition"],properties:[{name:"id",isAttr:!0,type:"String"},{name:"name",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"}]},{name:"Script",superClass:["InputOutputParameterDefinition"],properties:[{name:"scriptFormat",isAttr:!0,type:"String"},{name:"resource",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"}]},{name:"Field",superClass:["Element"],meta:{allowedIn:["camunda:ServiceTaskLike","camunda:ExecutionListener","camunda:TaskListener"]},properties:[{name:"name",isAttr:!0,type:"String"},{name:"expression",type:"String"},{name:"stringValue",isAttr:!0,type:"String"},{name:"string",type:"String"}]},{name:"InputParameter",superClass:["InputOutputParameter"]},{name:"OutputParameter",superClass:["InputOutputParameter"]},{name:"Collectable",isAbstract:!0,extends:["bpmn:MultiInstanceLoopCharacteristics"],superClass:["camunda:AsyncCapable"],properties:[{name:"collection",isAttr:!0,type:"String"},{name:"elementVariable",isAttr:!0,type:"String"}]},{name:"FailedJobRetryTimeCycle",superClass:["Element"],meta:{allowedIn:["camunda:AsyncCapable","bpmn:MultiInstanceLoopCharacteristics"]},properties:[{name:"body",isBody:!0,type:"String"}]},{name:"ExecutionListener",superClass:["Element"],meta:{allowedIn:["bpmn:Task","bpmn:ServiceTask","bpmn:UserTask","bpmn:BusinessRuleTask","bpmn:ScriptTask","bpmn:ReceiveTask","bpmn:ManualTask","bpmn:ExclusiveGateway","bpmn:SequenceFlow","bpmn:ParallelGateway","bpmn:InclusiveGateway","bpmn:EventBasedGateway","bpmn:StartEvent","bpmn:IntermediateCatchEvent","bpmn:IntermediateThrowEvent","bpmn:EndEvent","bpmn:BoundaryEvent","bpmn:CallActivity","bpmn:SubProcess","bpmn:Process"]},properties:[{name:"expression",isAttr:!0,type:"String"},{name:"class",isAttr:!0,type:"String"},{name:"delegateExpression",isAttr:!0,type:"String"},{name:"event",isAttr:!0,type:"String"},{name:"script",type:"Script"},{name:"fields",type:"Field",isMany:!0}]},{name:"TaskListener",superClass:["Element"],meta:{allowedIn:["bpmn:UserTask"]},properties:[{name:"expression",isAttr:!0,type:"String"},{name:"class",isAttr:!0,type:"String"},{name:"delegateExpression",isAttr:!0,type:"String"},{name:"event",isAttr:!0,type:"String"},{name:"script",type:"Script"},{name:"fields",type:"Field",isMany:!0},{name:"id",type:"String",isAttr:!0},{name:"eventDefinitions",type:"bpmn:TimerEventDefinition",isMany:!0}]},{name:"FormProperty",superClass:["Element"],meta:{allowedIn:["bpmn:StartEvent","bpmn:UserTask"]},properties:[{name:"id",type:"String",isAttr:!0},{name:"name",type:"String",isAttr:!0},{name:"type",type:"String",isAttr:!0},{name:"required",type:"String",isAttr:!0},{name:"readable",type:"String",isAttr:!0},{name:"writable",type:"String",isAttr:!0},{name:"variable",type:"String",isAttr:!0},{name:"expression",type:"String",isAttr:!0},{name:"datePattern",type:"String",isAttr:!0},{name:"default",type:"String",isAttr:!0},{name:"values",type:"Value",isMany:!0}]},{name:"FormData",superClass:["Element"],meta:{allowedIn:["bpmn:StartEvent","bpmn:UserTask"]},properties:[{name:"fields",type:"FormField",isMany:!0},{name:"businessKey",type:"String",isAttr:!0}]},{name:"FormField",superClass:["Element"],properties:[{name:"id",type:"String",isAttr:!0},{name:"label",type:"String",isAttr:!0},{name:"type",type:"String",isAttr:!0},{name:"datePattern",type:"String",isAttr:!0},{name:"defaultValue",type:"String",isAttr:!0},{name:"properties",type:"Properties"},{name:"validation",type:"Validation"},{name:"values",type:"Value",isMany:!0}]},{name:"Validation",superClass:["Element"],properties:[{name:"constraints",type:"Constraint",isMany:!0}]},{name:"Constraint",superClass:["Element"],properties:[{name:"name",type:"String",isAttr:!0},{name:"config",type:"String",isAttr:!0}]},{name:"ConditionalEventDefinitionExtension",isAbstract:!0,extends:["bpmn:ConditionalEventDefinition"],properties:[{name:"variableName",isAttr:!0,type:"String"},{name:"variableEvents",isAttr:!0,type:"String"}]}],emumerations:[]},b=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.onElementChanged=function(e,t){console.log(e.businessObject)},t}(a.Vue);n.__decorate([a.Prop({type:Object,default:function(){}}),n.__metadata("design:type",Object)],b.prototype,"element",void 0),n.__decorate([a.Watch("element"),n.__metadata("design:type",Function),n.__metadata("design:paramtypes",[Object,Object]),n.__metadata("design:returntype",void 0)],b.prototype,"onElementChanged",null);var f=b=n.__decorate([a.Component({name:"HPropertyPanel"})],b),S=g.default({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{attrs:{fluid:""}},[n("v-row",[n("v-col",{staticClass:"pa-0"},[n("v-card",[n("v-card-title",[e._v(e._s(e.element.id))])],1)],1)],1)],1)},staticRenderFns:[]},undefined,f,undefined,false,undefined,!1,void 0,void 0,void 0),E={"Activate the global connect tool":"激活全局连接工具","Append {type}":"添加 {type}","Add Lane above":"在上面添加道","Divide into two Lanes":"分割成两个道","Divide into three Lanes":"分割成三个道","Add Lane below":"在下面添加道","Append compensation activity":"追加补偿活动","Change type":"修改类型","Connect using Association":"使用关联连接","Connect using Sequence/MessageFlow or Association":"使用顺序/消息流或者关联连接","Connect using DataInputAssociation":"使用数据输入关联连接",Remove:"移除","Activate the hand tool":"激活抓手工具","Activate the lasso tool":"激活套索工具","Activate the create/remove space tool":"激活创建/删除空间工具","Create expanded SubProcess":"创建扩展子过程","Create IntermediateThrowEvent/BoundaryEvent":"创建中间抛出事件/边界事件","Create Pool/Participant":"创建池/参与者","Parallel Multi Instance":"并行多重事件","Sequential Multi Instance":"时序多重事件",DataObjectReference:"数据对象参考",DataStoreReference:"数据存储参考",Loop:"循环","Ad-hoc":"即席","Create {type}":"创建 {type}",Task:"任务","Send Task":"发送任务","Receive Task":"接收任务","User Task":"用户任务","Manual Task":"手工任务","Business Rule Task":"业务规则任务","Service Task":"服务任务","Script Task":"脚本任务","Call Activity":"调用活动","Sub Process (collapsed)":"子流程（折叠的）","Sub Process (expanded)":"子流程（展开的）","Start Event":"开始事件",StartEvent:"开始事件","Intermediate Throw Event":"中间事件","End Event":"结束事件",EndEvent:"结束事件","Create Gateway":"创建网关","Create Intermediate/Boundary Event":"创建中间/边界事件","Message Start Event":"消息开始事件","Timer Start Event":"定时开始事件","Conditional Start Event":"条件开始事件","Signal Start Event":"信号开始事件","Error Start Event":"错误开始事件","Escalation Start Event":"升级开始事件","Compensation Start Event":"补偿开始事件","Message Start Event (non-interrupting)":"消息开始事件（非中断）","Timer Start Event (non-interrupting)":"定时开始事件（非中断）","Conditional Start Event (non-interrupting)":"条件开始事件（非中断）","Signal Start Event (non-interrupting)":"信号开始事件（非中断）","Escalation Start Event (non-interrupting)":"升级开始事件（非中断）","Message Intermediate Catch Event":"消息中间捕获事件","Message Intermediate Throw Event":"消息中间抛出事件","Timer Intermediate Catch Event":"定时中间捕获事件","Escalation Intermediate Throw Event":"升级中间抛出事件","Conditional Intermediate Catch Event":"条件中间捕获事件","Link Intermediate Catch Event":"链接中间捕获事件","Link Intermediate Throw Event":"链接中间抛出事件","Compensation Intermediate Throw Event":"补偿中间抛出事件","Signal Intermediate Catch Event":"信号中间捕获事件","Signal Intermediate Throw Event":"信号中间抛出事件","Message End Event":"消息结束事件","Escalation End Event":"定时结束事件","Error End Event":"错误结束事件","Cancel End Event":"取消结束事件","Compensation End Event":"补偿结束事件","Signal End Event":"信号结束事件","Terminate End Event":"终止结束事件","Message Boundary Event":"消息边界事件","Message Boundary Event (non-interrupting)":"消息边界事件（非中断）","Timer Boundary Event":"定时边界事件","Timer Boundary Event (non-interrupting)":"定时边界事件（非中断）","Escalation Boundary Event":"升级边界事件","Escalation Boundary Event (non-interrupting)":"升级边界事件（非中断）","Conditional Boundary Event":"条件边界事件","Conditional Boundary Event (non-interrupting)":"条件边界事件（非中断）","Error Boundary Event":"错误边界事件","Cancel Boundary Event":"取消边界事件","Signal Boundary Event":"信号边界事件","Signal Boundary Event (non-interrupting)":"信号边界事件（非中断）","Compensation Boundary Event":"补偿边界事件","Exclusive Gateway":"互斥网关","Parallel Gateway":"并行网关","Inclusive Gateway":"相容网关","Complex Gateway":"复杂网关","Event based Gateway":"事件网关",Transaction:"转运","Sub Process":"子流程","Event Sub Process":"事件子流程","Collapsed Pool":"折叠池","Expanded Pool":"展开池","no parent for {element} in {parent}":"在{parent}里，{element}没有父类","no shape type specified":"没有指定的形状类型","flow elements must be children of pools/participants":"流元素必须是池/参与者的子类","out of bounds release":"out of bounds release","more than {count} child lanes":"子道大于{count} ","element required":"元素不能为空","diagram not part of bpmn:Definitions":"流程图不符合bpmn规范","no diagram to display":"没有可展示的流程图","no process or collaboration to display":"没有可展示的流程/协作","element {element} referenced by {referenced}#{property} not yet drawn":"由{referenced}#{property}引用的{element}元素仍未绘制","already rendered {element}":"{element} 已被渲染","failed to import {element}":"导入{element}失败",Id:"编号",Name:"名称",General:"常规",Details:"详情","Message Name":"消息名称",Message:"消息",Initiator:"创建者","Asynchronous Continuations":"持续异步","Asynchronous Before":"异步前","Asynchronous After":"异步后","Job Configuration":"工作配置",Exclusive:"排除","Job Priority":"工作优先级","Retry Time Cycle":"重试时间周期",Documentation:"文档","Element Documentation":"元素文档","History Configuration":"历史配置","History Time To Live":"历史的生存时间",Forms:"表单","Form Key":"表单key","Form Fields":"表单字段","Business Key":"业务key","Form Field":"表单字段",ID:"编号",Type:"类型",Label:"名称","Default Value":"默认值",Validation:"校验","Add Constraint":"添加约束",Config:"配置",Properties:"属性","Add Property":"添加属性",Value:"值",Listeners:"监听器","Execution Listener":"执行监听","Event Type":"事件类型","Listener Type":"监听器类型","Java Class":"Java类",Expression:"表达式","Must provide a value":"必须提供一个值","Delegate Expression":"代理表达式",Script:"脚本","Script Format":"脚本格式","Script Type":"脚本类型","Inline Script":"内联脚本","External Script":"外部脚本",Resource:"资源","Field Injection":"字段注入",Extensions:"扩展","Input/Output":"输入/输出","Input Parameters":"输入参数","Output Parameters":"输出参数",Parameters:"参数","Output Parameter":"输出参数","Timer Definition Type":"定时器定义类型","Timer Definition":"定时器定义",Date:"日期",Duration:"持续",Cycle:"循环",Signal:"信号","Signal Name":"信号名称",Escalation:"升级",Error:"错误","Link Name":"链接名称",Condition:"条件名称","Variable Name":"变量名称","Variable Event":"变量事件","Specify more than one variable change event as a comma separated list.":"多个变量事件以逗号隔开","Wait for Completion":"等待完成","Activity Ref":"活动参考","Version Tag":"版本标签",Executable:"可执行文件","External Task Configuration":"扩展任务配置","Task Priority":"任务优先级",External:"外部",Connector:"连接器","Must configure Connector":"必须配置连接器","Connector Id":"连接器编号",Implementation:"实现方式","Field Injections":"字段注入",Fields:"字段","Result Variable":"结果变量",Topic:"主题","Configure Connector":"配置连接器","Input Parameter":"输入参数",Assignee:"代理人","Candidate Users":"候选用户","Candidate Groups":"候选组","Due Date":"到期时间","Follow Up Date":"跟踪日期",Priority:"优先级","The follow up date as an EL expression (e.g. ${someDate} or an ISO date (e.g. 2015-06-26T09:54:00)":"跟踪日期必须符合EL表达式，如： ${someDate} ,或者一个ISO标准日期，如：2015-06-26T09:54:00","The due date as an EL expression (e.g. ${someDate} or an ISO date (e.g. 2015-06-26T09:54:00)":"跟踪日期必须符合EL表达式，如： ${someDate} ,或者一个ISO标准日期，如：2015-06-26T09:54:00",Variables:"变量"};var h={translate:["value",function(e,t){var n=t||{};return(E[e]||e).replace(/{([^}]+)}/g,(function(e,t){return n[t]||"{"+t+"}"}))}]},A=function(e){function t(){e.apply(this,arguments),this.diagram="",this.bpmnModeler={},this.scale=1,this.element={},this.fileName=""}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.mounted=function(){this.init()},t.prototype.beforeDestroy=function(){this.bpmnModeler.destroy()},t.prototype.onValueChange=function(e){this.diagram=e},t.prototype.onModelChange=function(e){this.$emit("input",e)},t.prototype.deploy=async function(){var e=(await this.showInputFileNameDialog()).value;if(e)return this.createFormData(e,this.diagram)},t.prototype.init=function(){this.bpmnModeler=this.createBpmnModeler(),this.createNewDiagram(this.diagram)},t.prototype.createBpmnModeler=function(){return new d.default({container:"#canvas",keyboard:{bindTo:window},propertiesPanel:{parent:"#properties-panel"},additionalModules:[u.default,c.default,h],moddleExtensions:{camunda:v}})},t.prototype.createNewDiagram=async function(e){try{var t=(await this.bpmnModeler.importXML(e)).warnings;this.addListeners(),console.log("[HBM] |- Create New Diagram Success !",t);var n=this.getCanvas();n.zoom("fit-viewport","auto"),this.element=n.getRootElement()}catch(e){var a=e.warnings,i=e.message;console.error("[HBM] |- Could not create BPMN 2.0 diagram!",a,i)}},t.prototype.addListeners=function(){this.addModelerListener(),this.addEventBusListener()},t.prototype.addModelerListener=function(){},t.prototype.addEventBusListener=function(){var e=this,t=e.getEventBus();["element.click","element.changed"].forEach((function(n){t.on(n,(function(t){console.log("[HBM] |- Event Type : ",n),console.log("[HBM] |- E : ",t),t&&"bpmn:Process"!=t.element.type&&("element.changed"===n?e.elementChanged(t):"element.click"===n&&(e.element=t.element,console.log(t.element.id)))}))}))},t.prototype.elementChanged=function(e){var t=this,n=t.getShape(e.element.id);this.element=n,n?n.type&&!t.isInvalid(n.type)&&t.isSequenceFlow(n.type)&&console.log("[HBM] |- Changing line."):console.log("[HBM] |- Invalid shape.")},t.prototype.loadLocalDiagram=function(){var e=this,t=e.$refs.loadXml.files[0],n=new FileReader;n.onload=function(){e.diagram=n.result,e.createNewDiagram(e.diagram)},n.readAsText(t)},t.prototype.showInputFileNameDialog=function(){return p.library.Swal.fire({title:"请输入文件名",input:"text",inputLabel:"保存的文件名",inputValue:"",showCancelButton:!0,cancelButtonColor:"#d33",confirmButtonText:"确认",cancelButtonText:"取消",inputValidator:function(e){if(!e)return"请输入文件名!"}})},t.prototype.handleUpload=function(){},t.prototype.createFormData=function(e,t,n,a){void 0===n&&(n=""),void 0===a&&(a="");var i=new FormData;i.append("deployment-name",e),i.append("enable-duplicate-filtering","false"),i.append("deploy-changed-only","false");var r=n||"Middle stage";i.append("deployment-source",r);var o=new Blob([t],{type:"application/octet-stream"}),s=this.checkFileName(a,e);return i.append("data",o,s),i},t.prototype.checkFileName=function(e,t){var n=e||t;return p.library.lodash.endsWith(n,".bpmn")||p.library.lodash.endsWith(n,".bpmn20.xml")?n:n+".bpmn"},t.prototype.getCanvas=function(){return this.bpmnModeler.get("canvas")},t.prototype.getCommandStack=function(){return this.bpmnModeler.get("commandStack")},t.prototype.getElementRegistry=function(){return this.bpmnModeler.get("elementRegistry")},t.prototype.getEventBus=function(){return this.bpmnModeler.get("eventBus")},t.prototype.getShape=function(e){return this.getElementRegistry().get(e)},t.prototype.isInvalid=function(e){return null==e||""===e},t.prototype.isSequenceFlow=function(e){return"bpmn:SequenceFlow"===e},t.prototype.saveSVG=async function(){try{var e=(await this.bpmnModeler.saveSVG({format:!0})).svg;this.download(e,"svg")}catch(e){var t=e.warnings,n=e.message;console.error("[HBM] |- Error happened saving svg: ",t,n)}},t.prototype.saveXML=async function(){try{var e=(await this.bpmnModeler.saveXML({format:!0})).xml;this.download(e,"xml")}catch(e){var t=e.warnings,n=e.message;console.error("[HBM] |- Error happened saving xml: ",t,n)}},t.prototype.handleRedo=function(){this.getCommandStack().redo()},t.prototype.handleUndo=function(){this.getCommandStack().undo()},t.prototype.handleZoom=function(e){var t=1;e&&(t=this.scale+e<=.2?.2:this.scale+e),this.getCanvas().zoom(t),this.scale=t},t.prototype.createDownloadLink=function(e,t,n){void 0===n&&(n="xml");var a=document.createElement("a");a.download=e+"."+n.toLowerCase(),a.innerHTML="Save BPMN "+n.toUpperCase,a.href=window.URL.createObjectURL(t),a.onclick=function(e){document.body.removeChild(e.target)},a.style.visibility="hidden",document.body.appendChild(a),a.click()},t.prototype.download=async function(e,t){void 0===t&&(t="xml");var n=t.toLowerCase(),a=new Blob([e],{type:"application/bpmn20-xml;charset=UTF-8,"});if("svg"===n&&(a=new Blob([e],{type:"image/svg+xml"})),this.fileName)this.createDownloadLink(this.fileName,a,n);else{var i=(await this.showInputFileNameDialog()).value;i&&(this.fileName=i,this.createDownloadLink(i,a,n))}},t}(a.Vue);n.__decorate([a.Prop(String),n.__metadata("design:type",String)],A.prototype,"value",void 0),n.__decorate([a.Watch("value",{immediate:!0}),n.__metadata("design:type",Function),n.__metadata("design:paramtypes",[String]),n.__metadata("design:returntype",void 0)],A.prototype,"onValueChange",null),n.__decorate([a.Watch("diagram"),n.__metadata("design:type",Function),n.__metadata("design:paramtypes",[String]),n.__metadata("design:returntype",void 0)],A.prototype,"onModelChange",null),n.__decorate([a.Emit(),n.__metadata("design:type",Function),n.__metadata("design:paramtypes",[]),n.__metadata("design:returntype",Promise)],A.prototype,"deploy",null);var C=A=n.__decorate([a.Component({components:{HButton:y.default,HPropertyPanel:S}})],A),T=g.default({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",{attrs:{id:"generator"}},[n("v-app-bar",{attrs:{dense:"","clipped-left":"","clipped-right":""}},[n("h-button",{attrs:{icon:"","icon-name":"mdi-undo-variant",tooltip:"撤销(Undo)"},on:{click:e.handleUndo}}),e._v(" "),n("h-button",{staticClass:"ml-1",attrs:{icon:"","icon-name":"mdi-redo-variant",tooltip:"恢复(Redo)"},on:{click:e.handleRedo}}),e._v(" "),n("h-button",{staticClass:"ml-1",attrs:{icon:"","icon-name":"mdi-magnify-plus-outline",tooltip:"放大"},on:{click:function(t){return e.handleZoom(.1)}}}),e._v(" "),n("h-button",{staticClass:"ml-1",attrs:{icon:"","icon-name":"mdi-magnify-minus-outline",tooltip:"缩小"},on:{click:function(t){return e.handleZoom(-.1)}}}),e._v(" "),n("h-button",{staticClass:"ml-1",attrs:{icon:"","icon-name":"mdi-cloud-upload-outline",tooltip:"部署"},on:{click:function(t){return e.deploy()}}}),e._v(" "),n("h-button",{staticClass:"ml-1",attrs:{icon:"","icon-name":"mdi-folder-open-outline",tooltip:"打开"},on:{click:function(t){return e.$refs.loadXml.click()}}}),e._v(" "),n("input",{ref:"loadXml",staticClass:"file-input",attrs:{type:"file",accept:".bpmn, .bpmn20.xml"},on:{change:function(t){return e.loadLocalDiagram()}}}),e._v(" "),n("h-button",{staticClass:"ml-1",attrs:{icon:"","icon-name":"mdi-xml",tooltip:"保存XML"},on:{click:function(t){return e.saveXML()}}}),e._v(" "),n("h-button",{staticClass:"ml-1",attrs:{icon:"","icon-name":"mdi-svg",tooltip:"保存SVG"},on:{click:function(t){return e.saveSVG()}}}),e._v(" "),n("v-spacer"),e._v(" "),n("v-btn",{attrs:{large:"",icon:""}},[n("v-icon",[e._v("mdi-volleyball")])],1)],1),e._v(" "),n("v-main",{staticClass:"pa-0"},[n("v-container",{attrs:{"grid-list-xl":"",fluid:""}},[n("v-row",[n("v-col",{staticClass:"pa-0",attrs:{cols:"10"}},[n("div",{staticClass:"containers"},[n("div",{staticClass:"canvas",attrs:{id:"canvas"}})])]),e._v(" "),n("v-col",{staticClass:"pa-0",attrs:{cols:"2"}},[n("div",{staticClass:"properties-panel",attrs:{id:"properties-panel"}})])],1)],1)],1)],1)},staticRenderFns:[]},undefined,C,undefined,false,undefined,!1,void 0,void 0,void 0),w={install:function(e){e.component("HBpmnModdle",T)}};e.HBpmnModdleComponent=w,e.default=T,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=index.umd.js.map
