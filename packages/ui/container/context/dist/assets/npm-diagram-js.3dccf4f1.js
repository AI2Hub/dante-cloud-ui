import{m as t,j as e,y as n,l as i,z as r,A as o,n as s,x as a,B as h,C as c,D as p}from"./npm-min-dash.ee8df4a0.js";import"./npm-css.escape.2e43da6f.js";import{I as u}from"./npm-didi.3e1b2c2f.js";import{e as l}from"./npm-inherits-browser.af2f44d9.js";import{c as d,b as f,d as y,r as m,e as _,t as g,f as v,g as w}from"./npm-tiny-svg.98039dc0.js";import{h as x,f as b}from"./npm-min-dom.8fd3350a.js";import{R as E}from"./npm-object-refs.e1a5409a.js";var R=["y","Y",89],C=["z","Z",90];function B(t){return!t.altKey&&(t.ctrlKey||t.metaKey)}function L(e,n){return-1!==(e=t(e)?e:[e]).indexOf(n.key)||-1!==e.indexOf(n.keyCode)}function k(t){return t.shiftKey}function j(t){return B(t)&&!k(t)&&L(C,t)}function P(t){return B(t)&&(L(R,t)||L(C,t)&&k(t))}function S(t,e,n){if(t&&e){"number"!=typeof n&&(n=-1);var i=t.indexOf(e);if(-1!==i){if(i===n)return;if(-1===n)return;t.splice(i,1)}-1!==n?t.splice(n,0,e):t.push(e)}}var M={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function G(t){return(t=""+t)&&t.replace(/[&<>"']/g,(function(t){return M[t]}))}function V(t,e){var n=this;e=e||1e3,t.on(["render.shape","render.connection"],e,(function(t,e){var i=t.type,r=e.element,o=e.gfx,s=e.attrs;if(n.canRender(r))return"render.shape"===i?n.drawShape(o,r,s):n.drawConnection(o,r,s)})),t.on(["render.getShapePath","render.getConnectionPath"],e,(function(t,e){if(n.canRender(e))return"render.getShapePath"===t.type?n.getShapePath(e):n.getConnectionPath(e)}))}function N(t){return t.join(",").replace(/,?([A-z]),?/g,"$1")}function T(t){for(var e,n="",i=0;e=t[i];i++)n+=e.x+","+e.y+" ";return n}function F(n,i){var r,o,s,a;return i=!!i,t(n)||(n=[n]),e(n,(function(t){var e=t;t.waypoints&&!i&&(e=F(t.waypoints,!0));var n=e.x,h=e.y,c=e.height||0,p=e.width||0;(n<r||void 0===r)&&(r=n),(h<o||void 0===o)&&(o=h),(n+p>s||void 0===s)&&(s=n+p),(h+c>a||void 0===a)&&(a=h+c)})),{x:r,y:o,height:a-o,width:s-r}}function I(t){return!(!t||!t.isFrame)}V.prototype.canRender=function(){},V.prototype.drawShape=function(){},V.prototype.drawConnection=function(){},V.prototype.getShapePath=function(){},V.prototype.getConnectionPath=function(){};function A(t,e){V.call(this,t,1),this.CONNECTION_STYLE=e.style(["no-fill"],{strokeWidth:5,stroke:"fuchsia"}),this.SHAPE_STYLE=e.style({fill:"white",stroke:"fuchsia",strokeWidth:2}),this.FRAME_STYLE=e.style(["no-fill"],{stroke:"fuchsia",strokeDasharray:4,strokeWidth:2})}l(A,V),A.prototype.canRender=function(){return!0},A.prototype.drawShape=function(t,e,i){var r=d("rect");return f(r,{x:0,y:0,width:e.width||0,height:e.height||0}),I(e)?f(r,n({},this.FRAME_STYLE,i||{})):f(r,n({},this.SHAPE_STYLE,i||{})),y(t,r),r},A.prototype.drawConnection=function(t,e,i){var r=function(t,e){var n=d("polyline");return f(n,{points:T(t)}),e&&f(n,e),n}(e.waypoints,n({},this.CONNECTION_STYLE,i||{}));return y(t,r),r},A.prototype.getShapePath=function(t){var e=t.x,n=t.y,i=t.width;return N([["M",e,n],["l",i,0],["l",0,t.height],["l",-i,0],["z"]])},A.prototype.getConnectionPath=function(t){var e,n,i=t.waypoints,r=[];for(e=0;n=i[e];e++)n=n.original||n,r.push([0===e?"M":"L",n.x,n.y]);return N(r)},A.$inject=["eventBus","styles"];const O={__init__:["defaultRenderer"],defaultRenderer:["type",A],styles:["type",function(){var e={"no-fill":{fill:"none"},"no-border":{strokeOpacity:0},"no-events":{pointerEvents:"none"}},r=this;this.cls=function(t,e,i){var r=this.style(e,i);return n(r,{class:t})},this.style=function(r,o){t(r)||o||(o=r,r=[]);var s=i(r,(function(t,i){return n(t,e[i]||{})}),{});return o?n(s,o):s},this.computeStyle=function(e,i,o){return t(i)||(o=i,i=[]),r.style(i||[],n({},o,e||{}))}}]};function z(t){return{top:t.y,right:t.x+(t.width||0),bottom:t.y+(t.height||0),left:t.x}}function Y(t,e){return Math.round(t*e)/e}function D(t){return c(t)?t+"px":t}function $(t,e,n){const i=d("g");_(i).add(e);const r=void 0!==n?n:t.childNodes.length-1;return t.insertBefore(i,t.childNodes[r]||null),i}const K={shape:["x","y","width","height"],connection:["waypoints"]};function W(t,e,n,i){this._eventBus=e,this._elementRegistry=i,this._graphicsFactory=n,this._rootsIdx=0,this._layers={},this._planes=[],this._rootElement=null,this._init(t||{})}function H(t,e){const n="matrix("+e.a+","+e.b+","+e.c+","+e.d+","+e.e+","+e.f+")";t.setAttribute("transform",n)}W.$inject=["config.canvas","eventBus","graphicsFactory","elementRegistry"],W.prototype._init=function(t){const e=this._eventBus,i=this._container=function(t){const e=(t=n({},{width:"100%",height:"100%"},t)).container||document.body,i=document.createElement("div");return i.setAttribute("class","djs-container"),x(i,{position:"relative",overflow:"hidden",width:D(t.width),height:D(t.height)}),e.appendChild(i),i}(t),s=this._svg=d("svg");f(s,{width:"100%",height:"100%"}),y(i,s);const a=this._viewport=$(s,"viewport");!1!==t.deferUpdate&&(this._viewboxChanged=r(o(this._viewboxChanged,this),300)),e.on("diagram.init",(function(){e.fire("canvas.init",{svg:s,viewport:a})}),this),e.on(["shape.added","connection.added","shape.removed","connection.removed","elements.changed","root.set"],(function(){delete this._cachedViewbox}),this),e.on("diagram.destroy",500,this._destroy,this),e.on("diagram.clear",500,this._clear,this)},W.prototype._destroy=function(t){this._eventBus.fire("canvas.destroy",{svg:this._svg,viewport:this._viewport});const e=this._container.parentNode;e&&e.removeChild(this._container),delete this._svg,delete this._container,delete this._layers,delete this._planes,delete this._rootElement,delete this._viewport},W.prototype._clear=function(){this._elementRegistry.getAll().forEach((t=>{const e=function(t){return"waypoints"in t?"connection":"x"in t?"shape":"root"}(t);"root"===e?this.removeRootElement(t):this._removeElement(t,e)})),this._planes=[],this._rootElement=null,delete this._cachedViewbox},W.prototype.getDefaultLayer=function(){return this.getLayer("base",0)},W.prototype.getLayer=function(t,e){if(!t)throw new Error("must specify a name");let n=this._layers[t];if(n||(n=this._layers[t]=this._createLayer(t,e)),void 0!==e&&n.index!==e)throw new Error("layer <"+t+"> already created at index <"+e+">");return n.group},W.prototype._getChildIndex=function(t){return i(this._layers,(function(e,n){return n.visible&&t>=n.index&&e++,e}),0)},W.prototype._createLayer=function(t,e){void 0===e&&(e=1);const n=this._getChildIndex(e);return{group:$(this._viewport,"layer-"+t,n),index:e,visible:!0}},W.prototype.showLayer=function(t){if(!t)throw new Error("must specify a name");const e=this._layers[t];if(!e)throw new Error("layer <"+t+"> does not exist");const n=this._viewport,i=e.group,r=e.index;if(e.visible)return i;const o=this._getChildIndex(r);return n.insertBefore(i,n.childNodes[o]||null),e.visible=!0,i},W.prototype.hideLayer=function(t){if(!t)throw new Error("must specify a name");const e=this._layers[t];if(!e)throw new Error("layer <"+t+"> does not exist");const n=e.group;return e.visible?(m(n),e.visible=!1,n):n},W.prototype._removeLayer=function(t){const e=this._layers[t];e&&(delete this._layers[t],m(e.group))},W.prototype.getActiveLayer=function(){const t=this._findPlaneForRoot(this.getRootElement());return t?t.layer:null},W.prototype.findRoot=function(t){if("string"==typeof t&&(t=this._elementRegistry.get(t)),!t)return;const e=this._findPlaneForRoot(function(t){for(;t.parent;)t=t.parent;return t}(t))||{};return e.rootElement},W.prototype.getRootElements=function(){return this._planes.map((function(t){return t.rootElement}))},W.prototype._findPlaneForRoot=function(t){return s(this._planes,(function(e){return e.rootElement===t}))},W.prototype.getContainer=function(){return this._container},W.prototype._updateMarker=function(t,n,i){let r;t.id||(t=this._elementRegistry.get(t)),r=this._elementRegistry._elements[t.id],r&&(e([r.gfx,r.secondaryGfx],(function(t){t&&(i?_(t).add(n):_(t).remove(n))})),this._eventBus.fire("element.marker.update",{element:t,gfx:r.gfx,marker:n,add:!!i}))},W.prototype.addMarker=function(t,e){this._updateMarker(t,e,!0)},W.prototype.removeMarker=function(t,e){this._updateMarker(t,e,!1)},W.prototype.hasMarker=function(t,e){t.id||(t=this._elementRegistry.get(t));const n=this.getGraphics(t);return _(n).has(e)},W.prototype.toggleMarker=function(t,e){this.hasMarker(t,e)?this.removeMarker(t,e):this.addMarker(t,e)},W.prototype.getRootElement=function(){const t=this._rootElement;return t||this._planes.length?t:this.setRootElement(this.addRootElement(null))},W.prototype.addRootElement=function(t){const e=this._rootsIdx++;t||(t={id:"__implicitroot_"+e,children:[],isImplicit:!0});const n=t.layer="root-"+e;this._ensureValid("root",t);const i=this.getLayer(n,0);return this.hideLayer(n),this._addRoot(t,i),this._planes.push({rootElement:t,layer:i}),t},W.prototype.removeRootElement=function(t){"string"==typeof t&&(t=this._elementRegistry.get(t));if(this._findPlaneForRoot(t))return this._removeRoot(t),this._removeLayer(t.layer),this._planes=this._planes.filter((function(e){return e.rootElement!==t})),this._rootElement===t&&(this._rootElement=null),t},W.prototype.setRootElement=function(t,e){if(a(e))throw new Error("override not supported");if(t===this._rootElement)return;let n;if(!t)throw new Error("rootElement required");return n=this._findPlaneForRoot(t),n||(t=this.addRootElement(t)),this._setRoot(t),t},W.prototype._removeRoot=function(t){const e=this._elementRegistry,n=this._eventBus;n.fire("root.remove",{element:t}),n.fire("root.removed",{element:t}),e.remove(t)},W.prototype._addRoot=function(t,e){const n=this._elementRegistry,i=this._eventBus;i.fire("root.add",{element:t}),n.add(t,e),i.fire("root.added",{element:t,gfx:e})},W.prototype._setRoot=function(t,e){const n=this._rootElement;n&&(this._elementRegistry.updateGraphics(n,null,!0),this.hideLayer(n.layer)),t&&(e||(e=this._findPlaneForRoot(t).layer),this._elementRegistry.updateGraphics(t,this._svg,!0),this.showLayer(t.layer)),this._rootElement=t,this._eventBus.fire("root.set",{element:t})},W.prototype._ensureValid=function(t,e){if(!e.id)throw new Error("element must have an id");if(this._elementRegistry.get(e.id))throw new Error("element <"+e.id+"> already exists");const n=K[t];if(!h(n,(function(t){return void 0!==e[t]})))throw new Error("must supply { "+n.join(", ")+" } with "+t)},W.prototype._setParent=function(t,e,n){S(e.children,t,n),t.parent=e},W.prototype._addElement=function(t,e,n,i){n=n||this.getRootElement();const r=this._eventBus,o=this._graphicsFactory;this._ensureValid(t,e),r.fire(t+".add",{element:e,parent:n}),this._setParent(e,n,i);const s=o.create(t,e,i);return this._elementRegistry.add(e,s),o.update(t,e,s),r.fire(t+".added",{element:e,gfx:s}),e},W.prototype.addShape=function(t,e,n){return this._addElement("shape",t,e,n)},W.prototype.addConnection=function(t,e,n){return this._addElement("connection",t,e,n)},W.prototype._removeElement=function(t,e){const n=this._elementRegistry,i=this._graphicsFactory,r=this._eventBus;if(t=n.get(t.id||t))return r.fire(e+".remove",{element:t}),i.remove(t),function(t,e){if(!t||!e)return-1;var n=t.indexOf(e);-1!==n&&t.splice(n,1)}(t.parent&&t.parent.children,t),t.parent=null,r.fire(e+".removed",{element:t}),n.remove(t),t},W.prototype.removeShape=function(t){return this._removeElement(t,"shape")},W.prototype.removeConnection=function(t){return this._removeElement(t,"connection")},W.prototype.getGraphics=function(t,e){return this._elementRegistry.getGraphics(t,e)},W.prototype._changeViewbox=function(t){this._eventBus.fire("canvas.viewbox.changing"),t.apply(this),this._cachedViewbox=null,this._viewboxChanged()},W.prototype._viewboxChanged=function(){this._eventBus.fire("canvas.viewbox.changed",{viewbox:this.viewbox()})},W.prototype.viewbox=function(t){if(void 0===t&&this._cachedViewbox)return this._cachedViewbox;const e=this._viewport,n=this.getSize();let i,r,o,s,a,h,c;return t?(this._changeViewbox((function(){a=Math.min(n.width/t.width,n.height/t.height);const i=this._svg.createSVGMatrix().scale(a).translate(-t.x,-t.y);g(e,i)})),t):(o=this._rootElement?this.getActiveLayer():null,i=o&&o.getBBox()||{},s=g(e),r=s?s.matrix:v(),a=Y(r.a,1e3),h=Y(-r.e||0,1e3),c=Y(-r.f||0,1e3),t=this._cachedViewbox={x:h?h/a:0,y:c?c/a:0,width:n.width/a,height:n.height/a,scale:a,inner:{width:i.width||0,height:i.height||0,x:i.x||0,y:i.y||0},outer:n})},W.prototype.scroll=function(t){const e=this._viewport;let i=e.getCTM();return t&&this._changeViewbox((function(){t=n({dx:0,dy:0},t||{}),i=this._svg.createSVGMatrix().translate(t.dx,t.dy).multiply(i),H(e,i)})),{x:i.e,y:i.f}},W.prototype.scrollToElement=function(t,e){let n=100;"string"==typeof t&&(t=this._elementRegistry.get(t));const i=this.findRoot(t);i!==this.getRootElement()&&this.setRootElement(i),e||(e={}),"number"==typeof e&&(n=e),e={top:e.top||n,right:e.right||n,bottom:e.bottom||n,left:e.left||n};const r=F(t),o=z(r),s=this.viewbox(),a=this.zoom();let h,c;s.y+=e.top/a,s.x+=e.left/a,s.width-=(e.right+e.left)/a,s.height-=(e.bottom+e.top)/a;const p=z(s);if(r.width<s.width&&r.height<s.height){const t=Math.max(0,o.right-p.right),e=Math.min(0,o.left-p.left),n=Math.max(0,o.bottom-p.bottom),i=Math.min(0,o.top-p.top);h=t||e,c=n||i}else h=r.x-s.x,c=r.y-s.y;this.scroll({dx:-h*a,dy:-c*a})},W.prototype.zoom=function(t,e){if(!t)return this.viewbox(t).scale;if("fit-viewport"===t)return this._fitViewport(e);let n,i;return this._changeViewbox((function(){"object"!=typeof e&&(n=this.viewbox().outer,e={x:n.width/2,y:n.height/2}),i=this._setZoom(t,e)})),Y(i.a,1e3)},W.prototype._fitViewport=function(t){const e=this.viewbox(),n=e.outer,i=e.inner;let r,o;return i.x>=0&&i.y>=0&&i.x+i.width<=n.width&&i.y+i.height<=n.height&&!t?o={x:0,y:0,width:Math.max(i.width+i.x,n.width),height:Math.max(i.height+i.y,n.height)}:(r=Math.min(1,n.width/i.width,n.height/i.height),o={x:i.x+(t?i.width/2-n.width/r/2:0),y:i.y+(t?i.height/2-n.height/r/2:0),width:n.width/r,height:n.height/r}),this.viewbox(o),this.viewbox(!1).scale},W.prototype._setZoom=function(t,e){const i=this._svg,r=this._viewport,o=i.createSVGMatrix(),s=i.createSVGPoint();let a,h,c,p,u;c=r.getCTM();const l=c.a;return e?(a=n(s,e),h=a.matrixTransform(c.inverse()),p=o.translate(h.x,h.y).scale(1/l*t).translate(-h.x,-h.y),u=c.multiply(p)):u=o.scale(t),H(this._viewport,u),u},W.prototype.getSize=function(){return{width:this._container.clientWidth,height:this._container.clientHeight}},W.prototype.getAbsoluteBBox=function(t){const e=this.viewbox();let n;if(t.waypoints){n=this.getGraphics(t).getBBox()}else n=t;return{x:n.x*e.scale-e.x*e.scale,y:n.y*e.scale-e.y*e.scale,width:n.width*e.scale,height:n.height*e.scale}},W.prototype.resized=function(){delete this._cachedViewbox,this._eventBus.fire("canvas.resized")};var Z="data-element-id";function q(t){this._elements={},this._eventBus=t}q.$inject=["eventBus"],q.prototype.add=function(t,e,n){var i=t.id;this._validateId(i),f(e,Z,i),n&&f(n,Z,i),this._elements[i]={element:t,gfx:e,secondaryGfx:n}},q.prototype.remove=function(t){var e=this._elements,n=t.id||t,i=n&&e[n];i&&(f(i.gfx,Z,""),i.secondaryGfx&&f(i.secondaryGfx,Z,""),delete e[n])},q.prototype.updateId=function(t,e){this._validateId(e),"string"==typeof t&&(t=this.get(t)),this._eventBus.fire("element.updateId",{element:t,newId:e});var n=this.getGraphics(t),i=this.getGraphics(t,!0);this.remove(t),t.id=e,this.add(t,n,i)},q.prototype.updateGraphics=function(t,e,n){var i=t.id||t,r=this._elements[i];return n?r.secondaryGfx=e:r.gfx=e,e&&f(e,Z,i),e},q.prototype.get=function(t){var e;e="string"==typeof t?t:t&&f(t,Z);var n=this._elements[e];return n&&n.element},q.prototype.filter=function(t){var e=[];return this.forEach((function(n,i){t(n,i)&&e.push(n)})),e},q.prototype.find=function(t){for(var e=this._elements,n=Object.keys(e),i=0;i<n.length;i++){var r=e[n[i]],o=r.element;if(t(o,r.gfx))return o}},q.prototype.getAll=function(){return this.filter((function(t){return t}))},q.prototype.forEach=function(t){var e=this._elements;Object.keys(e).forEach((function(n){var i=e[n],r=i.element,o=i.gfx;return t(r,o)}))},q.prototype.getGraphics=function(t,e){var n=t.id||t,i=this._elements[n];return i&&(e?i.secondaryGfx:i.gfx)},q.prototype._validateId=function(t){if(!t)throw new Error("element must have an id");if(this._elements[t])throw new Error("element with id "+t+" already added")};var U=new E({name:"children",enumerable:!0,collection:!0},{name:"parent"}),J=new E({name:"labels",enumerable:!0,collection:!0},{name:"labelTarget"}),Q=new E({name:"attachers",collection:!0},{name:"host"}),X=new E({name:"outgoing",collection:!0},{name:"source"}),tt=new E({name:"incoming",collection:!0},{name:"target"});function et(){Object.defineProperty(this,"businessObject",{writable:!0}),Object.defineProperty(this,"label",{get:function(){return this.labels[0]},set:function(t){var e=this.label,n=this.labels;!t&&e?n.remove(e):n.add(t,0)}}),U.bind(this,"parent"),J.bind(this,"labels"),X.bind(this,"outgoing"),tt.bind(this,"incoming")}function nt(){et.call(this),U.bind(this,"children"),Q.bind(this,"host"),Q.bind(this,"attachers")}function it(){nt.call(this)}function rt(){nt.call(this),J.bind(this,"labelTarget")}function ot(){et.call(this),X.bind(this,"source"),tt.bind(this,"target")}l(nt,et),l(it,nt),l(rt,nt),l(ot,et);var st={connection:ot,shape:nt,label:rt,root:it};function at(){this._uid=12}at.prototype.createRoot=function(t){return this.create("root",t)},at.prototype.createLabel=function(t){return this.create("label",t)},at.prototype.createShape=function(t){return this.create("shape",t)},at.prototype.createConnection=function(t){return this.create("connection",t)},at.prototype.create=function(t,e){return(e=n({},e||{})).id||(e.id=t+"_"+this._uid++),function(t,e){var i=st[t];if(!i)throw new Error("unknown type: <"+t+">");return n(new i,e)}(t,e)};var ht="__fn",ct=Array.prototype.slice;function pt(){this._listeners={},this.on("diagram.destroy",1,this._destroy,this)}function ut(){}function lt(t,e){this._eventBus=t,this._elementRegistry=e}function dt(t,e,n){var i=n||e.firstChild;t!==i&&e.insertBefore(t,i)}pt.prototype.on=function(e,n,i,r){if(e=t(e)?e:[e],p(n)&&(r=i,i=n,n=1e3),!c(n))throw new Error("priority must be a number");var s=i;r&&((s=o(i,r))[ht]=i[ht]||i);var a=this;e.forEach((function(t){a._addListener(t,{priority:n,callback:s,next:null})}))},pt.prototype.once=function(t,e,n,i){var r=this;if(p(e)&&(i=n,n=e,e=1e3),!c(e))throw new Error("priority must be a number");function o(){o.__isTomb=!0;var e=n.apply(i,arguments);return r.off(t,o),e}o[ht]=n,this.on(t,e,o)},pt.prototype.off=function(e,n){e=t(e)?e:[e];var i=this;e.forEach((function(t){i._removeListener(t,n)}))},pt.prototype.createEvent=function(t){var e=new ut;return e.init(t),e},pt.prototype.fire=function(t,e){var n,i,r,o;if(o=ct.call(arguments),"object"==typeof t&&(t=(e=t).type),!t)throw new Error("no event type specified");if(i=this._listeners[t]){n=e instanceof ut?e:this.createEvent(e),o[0]=n;var s=n.type;t!==s&&(n.type=t);try{r=this._invokeListeners(n,o,i)}finally{t!==s&&(n.type=s)}return void 0===r&&n.defaultPrevented&&(r=!1),r}},pt.prototype.handleError=function(t){return!1===this.fire("error",{error:t})},pt.prototype._destroy=function(){this._listeners={}},pt.prototype._invokeListeners=function(t,e,n){for(var i;n&&!t.cancelBubble;)i=this._invokeListener(t,e,n),n=n.next;return i},pt.prototype._invokeListener=function(t,e,n){var i;if(n.callback.__isTomb)return i;try{i=function(t,e){return t.apply(null,e)}(n.callback,e),void 0!==i&&(t.returnValue=i,t.stopPropagation()),!1===i&&t.preventDefault()}catch(r){if(!this.handleError(r))throw r}return i},pt.prototype._addListener=function(t,e){var n,i=this._getListeners(t);if(i){for(;i;){if(i.priority<e.priority)return e.next=i,void(n?n.next=e:this._setListeners(t,e));n=i,i=i.next}n.next=e}else this._setListeners(t,e)},pt.prototype._getListeners=function(t){return this._listeners[t]},pt.prototype._setListeners=function(t,e){this._listeners[t]=e},pt.prototype._removeListener=function(t,e){var n,i,r,o=this._getListeners(t);if(e)for(;o;)n=o.next,(r=o.callback)!==e&&r[ht]!==e||(i?i.next=n:this._setListeners(t,n)),i=o,o=n;else this._setListeners(t,null)},ut.prototype.stopPropagation=function(){this.cancelBubble=!0},ut.prototype.preventDefault=function(){this.defaultPrevented=!0},ut.prototype.init=function(t){n(this,t||{})},lt.$inject=["eventBus","elementRegistry"],lt.prototype._getChildrenContainer=function(t){var e,n=this._elementRegistry.getGraphics(t);return t.parent?(e=function(t){return t.parentNode.childNodes[1]}(n),e||(e=d("g"),_(e).add("djs-children"),y(n.parentNode,e))):e=n,e},lt.prototype._clear=function(t){var e=function(t){return t.childNodes[0]}(t);return b(e),e},lt.prototype._createContainer=function(t,e,n,i){var r=d("g");_(r).add("djs-group"),void 0!==n?dt(r,e,e.childNodes[n]):y(e,r);var o=d("g");_(o).add("djs-element"),_(o).add("djs-"+t),i&&_(o).add("djs-frame"),y(r,o);var s=d("g");return _(s).add("djs-visual"),y(o,s),o},lt.prototype.create=function(t,e,n){var i=this._getChildrenContainer(e.parent);return this._createContainer(t,i,n,I(e))},lt.prototype.updateContainments=function(t){var n,r=this,o=this._elementRegistry;n=i(t,(function(t,e){return e.parent&&(t[e.parent.id]=e.parent),t}),{}),e(n,(function(t){var n=t.children;if(n){var i=r._getChildrenContainer(t);e(n.slice().reverse(),(function(t){dt(o.getGraphics(t).parentNode,i)}))}}))},lt.prototype.drawShape=function(t,e){return this._eventBus.fire("render.shape",{gfx:t,element:e})},lt.prototype.getShapePath=function(t){return this._eventBus.fire("render.getShapePath",t)},lt.prototype.drawConnection=function(t,e){return this._eventBus.fire("render.connection",{gfx:t,element:e})},lt.prototype.getConnectionPath=function(t){return this._eventBus.fire("render.getConnectionPath",t)},lt.prototype.update=function(t,e,n){if(e.parent){var i=this._clear(n);if("shape"===t)this.drawShape(i,e),function(t,e,n){var i=w();i.setTranslate(e,n),g(t,i)}(n,e.x,e.y);else{if("connection"!==t)throw new Error("unknown type: "+t);this.drawConnection(i,e)}e.hidden?f(n,"display","none"):f(n,"display","block")}},lt.prototype.remove=function(t){var e=this._elementRegistry.getGraphics(t);m(e.parentNode)};const ft={__depends__:[O],__init__:["canvas"],canvas:["type",W],elementRegistry:["type",q],elementFactory:["type",at],eventBus:["type",pt],graphicsFactory:["type",lt]};function yt(t){return function(t){var e=new u(t);return e.init(),e}([{config:["value",t=t||{}]},ft].concat(t.modules||[]))}function mt(t,e){this.injector=e=e||yt(t),this.get=e.get,this.invoke=e.invoke,this.get("eventBus").fire("diagram.init")}mt.prototype.destroy=function(){this.get("eventBus").fire("diagram.destroy")},mt.prototype.clear=function(){this.get("eventBus").fire("diagram.clear")};export{mt as D,P as a,S as b,G as e,j as i};
